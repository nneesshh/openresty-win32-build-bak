syntax = "proto2";
option cc_enable_arenas = true;

package db;

////////////////////////////////////////////////////////////////	
// Mailbox 配置
message ConfigMailbox {
	required int32 level = 1;
	required int32 capacity = 2;
}

message ConfigMailboxList {
	repeated ConfigMailbox list = 1;
}

message proc_load_config_mailbox {
	message Parameter {

	}

	message ReturnRecord {
		required ConfigMailbox	cfg = 1;
	}

	//
	optional Parameter					param	= 1;							//
	repeated ReturnRecord				return_record_list = 2;
}

////////////////////////////////////////////////////////////////	
// user stats mail
message UserStatsMail {
	required bytes		userid = 1;
	required int64		topid = 2; // 用于二分法快速查找
	required int32 		receive_num = 3; // 接收总量
	required sfixed64	month_card_award_time = 4; // 月卡送达时间
}

////////////////////////////////////////////////////////////////	
// user mail
message UserMail {
	required bytes userid = 1;
	required int64 mailid = 2;
	required int32 mailtype = 3;
	required int32 mailstate = 4;
		
	required bytes subject = 11;
	required bytes content = 12;
	required bytes attachment = 13;
	
	required sfixed64 createtime = 21; // 创建时间
	required sfixed64 burntime = 22; // 截止时间
}

message UserMailList {
	repeated UserMail list = 1;
}

////////////////////////////////////////////////////////////////
message proc_i_load_user_stats_mail {
	message Parameter {

	}

	message ReturnRecord {
		required UserStatsMail		item = 1;
	}

	//
	optional Parameter					param	= 1;							//
	repeated ReturnRecord				return_record_list = 2;

}

////////////////////////////////////////////////////////////////
message proc_i_load_user_mails {
	message Parameter {
		required bytes						p_userid = 1;
	}

	message ReturnRecord {
		required UserMail					item = 1;
	}

	//
	optional Parameter					param	= 1;							//
	repeated ReturnRecord				return_record_list = 2;

}

////////////////////////////////////////////////////////////////
message proc_i_save_user_stats_mail {
	message Parameter {
		required UserStatsMail		p_stats_mail = 1;
	}

	//
	optional Parameter					param	= 1;							//
}

////////////////////////////////////////////////////////////////
message proc_i_save_user_mail {
	message Parameter {
		required UserMail					p_mail = 1;
	}

	//
	optional Parameter					param	= 1;							//
}

////////////////////////////////////////////////////////////////
// game mail

enum GAME_MAIL_FROM_TYPE {
	GAME_MAIL_FROM_TYPE_SYSTEM = 0; // 系统邮件
	GAME_MAIL_FROM_TYPE_PRIVATE = 1; // 私人邮件
}

enum GAME_MAIL_TO_TYPE {
	GAME_MAIL_TO_TYPE_ALL = 0; // 全体
	GAME_MAIL_TO_TYPE_SINGLE = 1; // 单体
}

//
message GameMail {
	required uint64 id = 1; // 邮件id，64位自增长
	required int32 mailtype = 2; // 邮件类型，0 = 未知类型，1 = 系统补偿，2 = 首充，3 = 月卡
	required int32 sender_type = 3; // 邮寄类型，0 = 系统，1 = 私人
	required bytes sender_userid = 4; // 寄件人地址
	required bytes sender_role_nick = 5; // 单体角色昵称
	required int32 mailto_type = 6; // 邮寄类型，0 = 全体，1 = 单体
	required bytes mailto_userid = 7; // 单体地址
	required int32 mailto_level = 8; // 收件人等级限制， 0 = 不限制
	required int32 ignore_rule = 9; // 用户忽略规则， 0 = 不忽略， 1 = 忽略新注册用户
	
	required bytes subject = 11; // 邮件主题
	required bytes content = 12; // 邮件正文
	required bytes attachment = 13; // 附件物品
	
	required sfixed64	createtime = 21;
	required sfixed64	burntime = 22;
}

message GameMailList {
	repeated GameMail list = 1;
}

////////////////////////////////////////////////////////////////
message proc_i_load_game_mailbox {
	message Parameter {
		required uint64						p_last_topid = 1;
	}

	message ReturnRecord {
		required GameMail					item = 1;
	}

	//
	optional Parameter					param	= 1;							//
	repeated ReturnRecord				return_record_list = 2;
}

////////////////////////////////////////////////////////////////
message proc_i_create_game_mail {
	message Parameter {
		required int32						p_subid = 1;
		required int32						p_mailtype = 2;
		required bytes						p_subject = 3;
		required bytes						p_attachment = 4;
	}

	//
	optional Parameter					param	= 1;							//
}

message proc_i_create_game_mail_private {
	message Parameter {
		required int32						p_subid = 1;
		required int32						p_mailtype = 2;
		required bytes						p_userid = 3;
		required bytes						p_subject = 4;
		required bytes						p_content = 5;
		required bytes						p_attachment = 6;
	}

	//
	optional Parameter					param	= 1;							//
}