webpackJsonp([6],{11:function(e,t,i){"use strict";(function(n){var a,s;a=[i(2),i(15),i(0)],void 0!==(s=function(e,t,i){t.defaults.transition="zoom",t.defaults.theme.ok="btn btn-primary",t.defaults.theme.cancel="btn btn-danger",t.defaults.theme.input="form-control",t.defaults.closable=!1,t.pgIframeDialog||t.dialog("pgIframeDialog",function(){var e;return{main:function(e){return this.set({pg_msg:e})},setup:function(){return{options:{padding:!1,overflow:!1}}},build:function(){e=document.createElement("iframe"),e.src="",e.frameBorder="no",e.width="100%",e.height="100%",this.elements.content.appendChild(e),this.elements.body.style.minHeight=.5*screen.height+"px"},settings:{pg_msg:void 0},settingUpdated:function(t,i,n){switch(t){case"pg_msg":var a=e.contentWindow||e.contentDocument;a.document&&(a=a.document),a.open(),a.write(n),a.close()}},hooks:{onupdate:function(t,i,n){switch(t){case"resizable":n?(this.elements.content.removeAttribute("style"),e&&e.removeAttribute("style")):(this.elements.content.style.minHeight="inherit",e&&(e.style.minHeight="inherit"))}}}}}),t.pgNotifier=function(a,s,l,o){var r=s.responseText,d=s.getResponseHeader("Content-Type");if(0==s.status)r=e("Connection to the server has been lost."),l=e("Connection Lost");else if(d)try{if(0==d.indexOf("application/json")){var c=i.parseJSON(r);if(null!=c.result&&(!c.errormsg||""==c.errormsg)&&o&&"function"==typeof o)return o(c.result);r=n.escape(c.result)||n.escape(c.errormsg)||"Unknown error"}if(0==d.indexOf("text/html")){var u=l;return"error"===a&&(u='                  <div class="media font-red-3 text-14">                    <div class="media-body media-middle">                      <div class="alert-text">'+l+'</div><br/>                      <div class="alert-text">'+e("Click for details.")+"</div>                    </div>                  </div>"),void t.notify(u,a,0,function(){t.pgIframeDialog().show().set({frameless:!1}).set("pg_msg",r)})}}catch(e){t.alert().show().set("message",e.message).set("title","Error")}t.alert().show().set("message",r.replace(new RegExp(/\r?\n/,"g"),"<br />")).set("title",l)};var a=function(e){var t=this;e&&(t.pgResizeRecursion=!1),t.pgResizeTimeout||(t.pgResizeTimeout=setTimeout(function(){var e=i(this.elements.dialog),t=e.width();this.pgResizeTimeout=null,t=t<=480?"xs":t<600?"sm":t<768?"md":"lg",e.attr("el",t)}.bind(t),100))},s=function e(t){var i=this;t&&(i.pgResizeRecursion=!0),setTimeout(function(){a.apply(i),i.pgResizeRecursion&&e.apply(i,[!1])},100)};t.pgDialogBuild=function(){this.set("onshow",function(){this.elements.dialog.classList.add("pg-el-container"),i(this.elements.commands.close).attr("title",e("Close")),i(this.elements.commands.maximize).attr("title",e("Maximize")),a.apply(this,arguments)}),this.set("onresize",s.bind(this,!0)),this.set("onresized",a.bind(this,!0)),this.set("onmaximized",a),this.set("onrestored",a)},t.pgHandleItemError=function(t,n,a,s){var l=window.pgAdmin.Browser;if(t&&l){var o=t.getResponseHeader("Content-Type"),r=o&&0==o.indexOf("application/json")&&i.parseJSON(t.responseText);if(r&&(503==t.status?"CONNECTION_LOST"==r.info&&"server"in s.info&&r.data.sid>=0&&r.data.sid==s.info.server._id:428==t.status&&r.errormsg&&r.errormsg==e("Connection to the server has been lost."))){s.preHandleConnectionLost&&"function"==typeof s.preHandleConnectionLost&&s.preHandleConnectionLost.apply(this,arguments);var d=l.Nodes.server,c={resp:r,xhr:t,args:s},u=function(){var e=this,t=function(e,n,a){this.args.info.server._id==e&&(l.Events.off("pgadmin:server:connected",t),l.Events.off("pgadmin:server:connect:cancelled",i),this.resp.data.database&&this.resp.data.database!=a.db&&l.Events.trigger("pgadmin:database:connection:lost",this.args.item,this.resp,!0))}.bind(e),i=function(e,n,a){e==this.args.info.server.id&&(l.Events.off("pgadmin:server:connected",t),l.Events.off("pgadmin:server:connect:cancelled",i),l.Events.trigger("pgadmin:database:connect:cancelled",e,this.resp.data.database||a.db,n,a))}.bind(e);l.Events.on("pgadmin:server:connected",t),l.Events.on("pgadmin:server:connect:cancelled",i),l.Events.trigger("pgadmin:server:connection:lost",this.args.item,this.resp)}.bind(c);return i.ajax({url:d.generate_url(null,"connect",s.info.server,!0,s.info),dataType:"json",success:function(e){if(e.success&&"connected"in e.data&&e.data.connected)return void l.Events.trigger("pgadmin:database:connection:lost",s.item,r);u()},error:function(){u()}}),!0}return!1}};var l=t.success,o=t.error;return n.extend(t,{orig_success:l,orig_error:o}),n.extend(t,{success:function(e,i,n){var a='      <div class="media font-green-3 text-14">        <div class="media-body media-middle">          <div class="alert-icon success-icon">            <i class="fa fa-check" aria-hidden="true"></i>          </div>            <div class="alert-text">'+e+"</div>        </div>      </div>";return t.orig_success(a,i,n)},error:function(e,i,n){var a='      <div class="media font-red-3 text-14">        <div class="media-body media-middle">          <div class="alert-icon error-icon">            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>          </div>            <div class="alert-text">'+e+"</div>        </div>      </div>";return t.orig_error(a,i,n)},info:function(e,i){var n='      <div class="media alert-info font-blue text-14">        <div class="media-body media-middle">          <div class="alert-icon info-icon">            <i class="fa fa-info" aria-hidden="true"></i>          </div>            <div class="alert-text">'+e+"</div>        </div>      </div>";return t.notify(n,i)}}),t.confirm().set({onshow:function(){i(this.elements.commands.close).attr("title",e("Close")),i(this.elements.commands.maximize).attr("title",e("Maximize"))}}),t}.apply(t,a))&&(e.exports=s)}).call(t,i(1))},12:function(e,t,i){"use strict";(function(n){var a,s;a=[i(2),i(1),i(0),i(10),i(19),i(17),i(15),i(30),i(246),i(247),i(248)],void 0!==(s=function(e,t,i,a,s,l,o,r,d){t.extend(l.Column.prototype.defaults,{cellFunction:void 0}),t.extend(l.Cell.prototype.events,{mouseover:function(){var e=i(this.el);e.text().length>0&&!e.attr("title")&&e.innerWidth()+1<e[0].scrollWidth&&e.attr("title",i.trim(e.text()))}}),t.extend(l.Body.prototype,{sort:function(e,i){if(!t.contains(["ascending","descending",null],i))throw new RangeError('direction must be one of "ascending", "descending" or `null`');t.isString(e)&&(e=this.columns.findWhere({name:e}));var n,s=this.collection;n="ascending"===i?-1:"descending"===i?1:null;var l=e.get("cell").prototype.className||"string-cell",o=this.makeComparator(e.get("name"),n,n?e.sortValue():function(e){return 1*e.cid.replace("c","")},l);return a.PageableCollection&&s instanceof a.PageableCollection?(s.setSorting(n&&e.get("name"),n,{sortValue:e.sortValue()}),s.fullCollection?(null==s.fullCollection.comparator&&(s.fullCollection.comparator=o),s.fullCollection.sort(),s.trigger("backgrid:sorted",e,i,s)):s.fetch({reset:!0,success:function(){s.trigger("backgrid:sorted",e,i,s)}})):(s.comparator=o,s.sort(),s.trigger("backgrid:sorted",e,i,s)),e.set("direction",i),this},makeComparator:function(e,i,n,a){return function(s,l){var o,r=n(s,e),c=n(l,e);if(!t.isUndefined(r)&&!t.isUndefined(c)){var u=["number-cell","integer-cell"];if(t.include(u,a)){var p,h;try{p=new d(r)}catch(e){p=NaN}try{h=new d(c)}catch(e){h=NaN}return 1===i&&(o=p,p=h,h=o),p.eq(h)?0:p.lt(h)?-1:1}return 1===i&&(o=r,r=c,c=o),r===c?0:r<c?-1:1}}}}),t.extend(l.Row.prototype,{makeCell:function(e){return new(this.getCell(e))({column:e,model:this.model})},getCell:function(e){var i=e.get("cellFunction");if(!t.isFunction(i))return e.get("cell");var n=i.apply(e,[this.model]);try{return l.resolveNameToClass(n,"Cell")}catch(t){if(t instanceof ReferenceError)return e.get("cell");throw t}}});var c=l.Extension.ObjectCellEditor=l.CellEditor.extend({modalTemplate:t.template(['<div class="subnode-dialog" tabindex="1">','    <div class="subnode-body"></div>',"</div>"].join("\n")),stringTemplate:t.template(['<div class="form-group">','  <label class="control-label col-sm-4"><%=label%></label>','  <div class="col-sm-8">','    <input type="text" class="form-control" name="<%=name%>" value="<%=value%>" placeholder="<%=placeholder%>" />',"  </div>","</div>"].join("\n")),extendWithOptions:function(e){t.extend(this,e)},render:function(){return this},postRender:function(e,n){var a=this.columns_length,l=this.schema.length?this.schema:this.column.get("schema");if(null!=n&&n.get("name")!=this.column.get("name"))return!1;if(!t.isArray(l))throw new TypeError("schema must be an array");var o=this.createDialog(a),r=i('<form class="form-dialog"></form>');o.find("div.subnode-body").append(r);var d=o.find("form.form-dialog");return this.objectView=new s.Dialog({el:d,model:this.model,schema:l,tabPanelClassName:function(){return"sub-node-form col-sm-12"}}),this.objectView.render(),this},createDialog:function(e){e=e||1;var t=this.$dialog=i(this.modalTemplate({title:""})),n=i("<tr>"),a=i("<td>",{class:"editable sortable renderable",style:"height: auto",colspan:e+2}).appendTo(n);return this.tr=n,a.append(t.css("display","block")),this.el.parent("tr").after(n),t},save:function(){return this.model.trigger("backgrid:edited",this.model,this.column,new l.Command({keyCode:13})),this.tr&&this.tr.remove(),this},remove:function(){return this.objectView.remove(),l.CellEditor.prototype.remove.apply(this,arguments),this.tr&&this.tr.remove(),this}});l.Extension.PGSelectCell=l.SelectCell.extend({optionValues:function(){var e=[],i=t.result(this.column.attributes,"options");return t.each(i,function(t){e.push([t.label,t.value])}),e}}),l.Extension.ObjectCell=l.Cell.extend({editorOptionDefaults:{schema:[]},className:"edit-cell",editor:c,initialize:function(e){l.Cell.prototype.initialize.apply(this,arguments);var n=this,a={};t.each(this.editorOptionDefaults,function(t,i){n[i]||(n[i]=t),e&&e[i]&&(n[i]=e[i]),a[i]=n[i]}),a.el=i(this.el),a.columns_length=this.column.collection.length,a.el.attr("tabindex",1),this.listenTo(this.model,"backgrid:edit",function(e,t,i,n){t.get("name")==this.column.get("name")&&n.extendWithOptions(a)})},enterEditMode:function(){!t.isUndefined(this.column.get("canEditRow"))&&t.isFunction(this.column.get("canEditRow"))&&!l.callByNeed(this.column.get("canEditRow"),this.column,this.model)?o.alert(e("This object is not user editable."),function(){return!0}):(this.model.trigger("enteringEditMode",[this]),l.Cell.prototype.enterEditMode.apply(this,arguments),this.delegateEvents(),l.callByNeed(this.column.editable(),this.column,this.model)&&(this.$el.html("<i class='fa fa-pencil-square subnode-edit-in-process' title='"+t("Edit row")+"'></i>"),this.model.trigger("pg-sub-node:opened",this.model,this)))},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-pencil-square-o' title='"+t("Edit row")+"'></i>"),this.delegateEvents(),this.grabFocus&&this.$el.focus(),this},exitEditMode:function(){var e=i(this.currentEditor.objectView.el).find('.nav-tabs > .active > a[data-toggle="tab"]').first().data("tabIndex");l.Cell.prototype.exitEditMode.apply(this,arguments),this.model.trigger("pg-sub-node:closed",this,e),this.grabFocus=!0},events:{click:function(e){this.$el.find("i").first().hasClass("subnode-edit-in-process")?(this.undelegateEvents(),this.currentEditor.save()):this.enterEditMode.call(this,[]),e.preventDefault()}}}),l.Extension.DeleteCell=l.Cell.extend({defaults:t.defaults({defaultDeleteMsg:e("Are you sure you wish to delete this row?"),defaultDeleteTitle:e("Delete Row")},l.Cell.prototype.defaults),className:"delete-cell",events:{click:"deleteRow"},deleteRow:function(i){i.preventDefault();var n=this;if(!t.isUndefined(this.column.get("canDeleteRow"))&&t.isFunction(this.column.get("canDeleteRow"))&&!l.callByNeed(this.column.get("canDeleteRow"),this.column,this.model))o.alert(e("This object cannot be deleted."),function(){return!0});else{var a=t.isUndefined(this.column.get("customDeleteMsg"))?n.defaults.defaultDeleteMsg:this.column.get("customDeleteMsg"),s=t.isUndefined(this.column.get("customDeleteTitle"))?n.defaults.defaultDeleteTitle:this.column.get("customDeleteTitle");o.confirm(s,a,function(){n.model.collection.remove(n.model)},function(){return!0})}},initialize:function(){l.Cell.prototype.initialize.apply(this,arguments)},render:function(){return this.$el.empty(),this.$el.html("<i class='fa fa-trash' title='"+t("Delete row")+"'></i>"),this.delegateEvents(),this}}),l.Extension.CustomHeaderCell=l.HeaderCell.extend({initialize:function(){l.HeaderCell.prototype.initialize.apply(this,arguments);var e=this.column.get("cellHeaderClasses");e&&this.$el.addClass(e)}}),n&&n.fn.bootstrapSwitch&&(i.fn.bootstrapSwitch=n.fn.bootstrapSwitch),l.Extension.SwitchCell=l.BooleanCell.extend({defaults:{options:t.defaults({onText:e("True"),offText:e("False"),onColor:"success",offColor:"default",size:"mini"},i.fn.bootstrapSwitch.defaults)},className:"switch-cell",initialize:function(){l.BooleanCell.prototype.initialize.apply(this,arguments),this.onChange=this.onChange.bind(this)},enterEditMode:function(){this.$el.addClass("editor"),i(this.$el.find("input")).focus()},exitEditMode:function(){this.$el.removeClass("editor")},events:{"switchChange.bootstrapSwitch":"onChange"},onChange:function(){var e=this.model,t=this.column,i=this.formatter.toRaw(this.$input.prop("checked"),e);this.enterEditMode(),e.set(t.get("name"),i)},render:function(){var e=this,n=t.defaults(this.column.toJSON(),this.defaults),a=this.model,s=this.column,o=this.formatter.fromRaw(a.get(s.get("name")),a),r=l.callByNeed(n.editable,s,a);return this.undelegateEvents(),this.$el.empty(),this.$el.append(i("<input>",{tabIndex:-1,type:"checkbox"}).prop("checked",o).prop("disabled",!r)),this.$input=this.$el.find("input[type=checkbox]").first(),this.$input.bootstrapSwitch(t.defaults({state:o,disabled:!r},n.options,this.defaults.options)),this.$el.on("keydown",function(t){var i;9==t.keyCode&&(i=t.shiftKey?e.$el.prev():e.$el.next()),i&&setTimeout(function(){if(i.hasClass("editable")){t.preventDefault(),t.stopPropagation();var n=new l.Command({key:"Tab",keyCode:9,which:9,shiftKey:t.shiftKey});e.model.trigger("backgrid:edited",e.model,e.column,n),i.focus()}},20)}),this.delegateEvents(),this}}),l.Extension.Select2Cell=l.SelectCell.extend({className:"select2-cell",editor:null,defaults:t.defaults({select2:{},opt:{label:null,value:null,selected:!1}},l.SelectCell.prototype.defaults),enterEditMode:function(){this.$el.hasClass("editor")||this.$el.addClass("editor"),this.$select.select2("focus"),this.$select.select2("open"),this.$select.on("blur",this.exitEditMode)},exitEditMode:function(){this.$select.off("blur",this.exitEditMode),this.$select.select2("close"),this.$el.removeClass("editor")},events:{"select2:open":"enterEditMode","select2:close":"exitEditMode",change:"onSave","select2:unselect":"onSave"},template:t.template(['<option value="<%- value %>" ','<%= selected ? \'selected="selected"\' : "" %>>',"<%- label %></option>"].join(""),null,{variable:null}),initialize:function(){l.SelectCell.prototype.initialize.apply(this,arguments),this.onSave=this.onSave.bind(this),this.enterEditMode=this.enterEditMode.bind(this),this.exitEditMode=this.exitEditMode.bind(this)},render:function(){var e=t.defaults(this.column.toJSON(),this.defaults),n=this.model,a=this.column,s=l.callByNeed(e.editable,a,n),o=t.clone(this.optionValues||(t.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));if(this.undelegateEvents(),this.$select&&(this.$select.data("select2")&&this.$select.select2("destroy"),delete this.$select,this.$select=null),this.$el.empty(),!t.isArray(o))throw new TypeError("optionValues must be an array");o.unshift(this.defaults.opt);for(var r=null,d=null,c=this,u=n.get(this.column.get("name")),p=t.extend({openOnEnter:!1,multiple:!1},c.defaults.select2,e.select2||{}),h=t.template('<select <%=multiple ? "multiple" : "" %>></select>'),f=c.$select=i(h({multiple:p.multiple})).appendTo(c.$el),m=0;m<o.length;m++){var g=o[m];t.isArray(g)?(r=g[0],d=g[1],f.append(c.template({label:r,value:d,selected:u==d||p.multiple&&t.indexOf(u,d)>-1}))):(g=t.defaults({},g,{selected:u==g.value||p.multiple&&t.indexOf(u,g.value)>-1},c.defaults.opt),f.append(c.template(g)))}if(e&&t.has(e.disabled)){t.extend(p,{disabled:function(){var e=[];Array.prototype.push.apply(e,arguments);var t=e.shift();return"function"==typeof t?t.apply(c,e):t}(e.disabled,e,n)})}else t.extend(p,{disabled:!s});return this.delegateEvents(),s&&"properties"!==e.mode||(p.placeholder=""),this.$sel=this.$select.select2(p),this.$sel&&this.$sel.data("select2").on("keypress",function(e){var t=this;9===e.which&&t.isOpen()&&(t.trigger("results:select",{}),e.preventDefault())}),this},onSave:function(){var e=this.model,t=this.column;e.set(t.get("name"),this.$select.val())},remove:function(){this.$select.off("change",this.onSave),this.$select.data("select2")&&this.$select.select2("destroy"),this.$el.empty(),l.SelectCell.prototype.remove.apply(this,arguments)}});var u=l.TextareaCellEditor=l.InputCellEditor.extend({tagName:"textarea",events:{blur:"saveOrCancel",keydown:""}});l.Extension.TextareaCell=l.Cell.extend({className:"textarea-cell",editor:u}),l.Extension.CustomHeaderIconCell=l.HeaderCell.extend({className:"header-icon-cell",events:{click:"addHeaderIcon"},addHeaderIcon:function(e){this.collection.add(new this.collection.model),e.preventDefault()},render:function(){return this.$el.empty(),this.$el.html("<label><a><span style='font-weight:normal;'>Array Values</a></span></label> <button class='btn-sm btn-default add'>Add</button>"),this.delegateEvents(),this}});var p=a.Model.extend({defaults:{value:void 0}}),h=l.Extension.InputArrayCellEditor=l.CellEditor.extend({tagName:"div",events:{blur:"lostFocus"},render:function(){var t=this,n=this.model.get(this.column.get("name")),a=[{name:"value",label:e("Array Values"),type:"text",cell:"string",headerCell:l.Extension.CustomHeaderIconCell,cellHeaderClasses:"width_percent_100"}],s=i("<div class='pgadmin-control-group backgrid form-group col-xs-12 object subnode'></div>");this.$el.attr("tabindex","1"),a.unshift({name:"pg-backform-delete",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1}),this.$el.empty();var o=t.grid=new l.Grid({columns:a,collection:n});return o.render(),s.append(o.$el),this.$el.html(s),i(t.$el).pgMakeVisible("backform-tab"),t.delegateEvents(),this},lostFocus:function(e){var t=this,i=function(e,t){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1};setTimeout(function(){if(t.$el[0]!=document.activeElement&&!i(t.$el[0],document.activeElement)){var n=t.model,a=t.column;n.trigger("backgrid:edited",n,a,new l.Command(e)),setTimeout(function(){t.grid&&(t.grid.remove(),t.grid=null)},10)}},10)}}),f=l.Extension.InputStringArrayCellFormatter=function(){};t.extend(f.prototype,{fromRaw:function(e){var i=[];return e.each(function(e){var n=e.get("value");t.isUndefined(n)?i.push("null"):i.push(e.get("value"))}),i.toString()},toRaw:function(e){return e}});var m=l.Extension.InputIntegerArrayCellFormatter=function(){};t.extend(m.prototype,{fromRaw:function(e){var i=[];return e.each(function(e){var n=e.get("value");t.isUndefined(n)?i.push("null"):i.push(e.get("value"))}),i.toString()},toRaw:function(e){return e.each(function(e){e.set("value",parseInt(e.get("value")),{silent:!0})}),e}}),l.Extension.InputStringArrayCell=l.Cell.extend({className:"width_percent_25",formatter:f,editor:h,initialize:function(){l.Cell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.isUndefined(this.collection)&&(this.collection=new(a.Collection.extend({model:p}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}}),l.Extension.InputIntegerArrayCell=l.Cell.extend({className:"width_percent_25",formatter:m,editor:h,initialize:function(){l.Cell.prototype.initialize.apply(this,arguments);var e=arguments[0].model;t.isUndefined(this.collection)&&(this.collection=new(a.Collection.extend({model:p}))(e.get("value"))),this.model.set(this.column.get("name"),this.collection),this.listenTo(this.collection,"remove",this.render)}});var g=l.Extension.DependentCell=function(){};t.extend(g.prototype,{initialize:function(){var e=this.column.get("deps"),i=this;e&&t.isArray(e)&&t.each(e,function(e){var t=e.split("."),n=t.shift();i.listenTo(i.model,"change:"+n,i.dependentChanged)})},remove:function(){var e=this,i=e.column.get("deps");i&&t.isArray(i)&&t.each(i,function(t){var i=t.split("."),n=i.shift();e.stopListening(e.model,"change:"+n,e.dependentChanged)})}});var v=l.PasswordFormatter=function(){};v.prototype=new l.CellFormatter,t.extend(v.prototype,{fromRaw:function(e){if(t.isUndefined(e)||t.isNull(e))return"";for(var i="",n=0;n<e.length;n++)i+="*";return i}}),l.Extension.PasswordCell=l.StringCell.extend({formatter:v,editor:l.InputCellEditor.extend({attributes:{type:"password"},render:function(){var e=this.model;return this.$el.val(e.get(this.column.get("name"))),this}})}),t.extend(l.NumberFormatter.prototype,{fromRaw:function(e){if(t.isNull(e)||t.isUndefined(e))return"";e=parseFloat(e).toFixed(~~this.decimals);var i=e.split("."),n=i[0],a=i[1]?(this.decimalSeparator||".")+i[1]:"";return n.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+a}});var b=l.Extension.JSONBCellFormatter=function(){};t.extend(b.prototype,{fromRaw:function(e){if(t.isArray(e)){var i="";return i=t.map(e,function(e){return JSON.stringify(JSON.stringify(e))}),"{"+i.join()+"}"}return t.isObject(e)?JSON.stringify(e):e},toRaw:function(e){return e}}),l.Extension.JSONBCell=l.StringCell.extend({className:"jsonb-cell",formatter:b}),l.Extension.DatepickerCell=l.Cell.extend({editor:y});var y=l.InputCellEditor.extend({events:{},initialize:function(){l.InputCellEditor.prototype.initialize.apply(this,arguments);var e=this;i(this.el).prop("readonly",!0),i(this.el).datepicker({onClose:function(t){var i=new l.Command({});e.model.set(e.column.get("name"),t),e.model.trigger("backgrid:edited",e.model,e.column,i),i=e=null}})}}),_=l.Extension.MomentFormatter=function(e){t.extend(this,this.defaults,e)};_.prototype=new l.CellFormatter,t.extend(_.prototype,{defaults:{modelInUnixOffset:!1,modelInUnixTimestamp:!1,modelInUTC:!0,modelLang:r.locale(),modelFormat:r.defaultFormat,displayInUnixOffset:!1,displayInUnixTimestamp:!1,displayInUTC:!0,displayLang:r.locale(),displayFormat:r.defaultFormat,allowEmpty:!1},fromRaw:function(e){if(null==e)return"";var t=this.modelInUnixOffset?r(e):this.modelInUnixTimestamp?r.unix(e):this.modelInUTC?r.utc(e,this.modelFormat,this.modelLang):r(e,this.modelFormat,this.modelLang);return this.displayInUnixOffset?+t:this.displayInUnixTimestamp?t.unix():(this.displayLang&&t.locale(this.displayLang),this.displayInUTC?t.utc():t.local(),this.displayFormat!=r.defaultFormat?t.format(this.displayFormat):t.format())},toRaw:function(e){var t=this.displayInUnixOffset?r(+e):this.displayInUnixTimestamp?r.unix(+e):this.displayInUTC?r.utc(e,this.displayFormat,this.displayLang):r(e,this.displayFormat,this.displayLang);return t&&t.isValid()?this.modelInUnixOffset?+t:this.modelInUnixTimestamp?t.unix():(this.modelLang&&t.locale(this.modelLang),this.modelInUTC?t.utc():t.local(),this.modelFormat!=r.defaultFormat?t.format(this.modelFormat):t.format()):this.allowEmpty&&""===e?null:void 0}});var C=l.Extension.MomentCell=l.Cell.extend({editor:l.InputCellEditor,className:"datetime-cell",formatter:_,initialize:function(e){C.__super__.initialize.apply(this,arguments);var i=_.prototype.defaults,n=t.keys(i),a=t.pick(this,n),s=t.pick(e,n),l=t.pick(this.column.toJSON(),n);t.extend(this.formatter,i,a,s,l),this.editor=this.editor.extend({attributes:t.extend({},this.editor.prototype.attributes||this.editor.attributes||{},{placeholder:this.formatter.displayFormat}),options:this.column.get("options")})}});return l.Extension.DatetimePickerEditor=l.InputCellEditor.extend({postRender:function(){var e=this,i=t.extend({format:"YYYY-MM-DD HH:mm:ss Z",showClear:!0,showTodayButton:!0,toolbarPlacement:"top"},function(){var t=[];Array.prototype.push.apply(t,arguments);var i=t.shift();return"function"==typeof i?i.apply(e,t):i}(this.column.get("options")),{keyBinds:{"shift tab":function(t){t&&setTimeout(function(){e.closeIt({keyCode:9,shiftKey:!0})},10)},tab:function(t){t&&setTimeout(function(){e.closeIt({keyCode:9})},10)}}});this.$el.datetimepicker(i),this.$el.datetimepicker("show"),this.picker=this.$el.data("DateTimePicker")},events:{"dp.hide":"closeIt"},closeIt:function(e){var i=this.formatter,n=this.model,a=this.column,s=this.$el.val(),o=i.toRaw(s,n);if(!this.is_closing){this.is_closing=!0,this.$el.datetimepicker("destroy"),this.is_closing=!1;var r=new l.Command(e);t.isUndefined(o)?n.trigger("backgrid:error",n,a,s):(n.set(a.get("name"),o),n.trigger("backgrid:edited",n,a,r))}}}),t.extend(C.prototype,_.prototype.defaults),l.Extension.StringDepCell=l.StringCell.extend({initialize:function(){l.StringCell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this,i=this.model,n=this.column,a=this.column.get("editable");this.render();var s=t.isFunction(a)?!!a.apply(n,[i]):!!a;return setTimeout(function(){e.$el.removeClass("editor"),s?e.$el.addClass("editable"):e.$el.removeClass("editable")},10),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),l.Extension.Select2DepCell=l.Extension.Select2Cell.extend({initialize:function(){l.Extension.Select2Cell.prototype.initialize.apply(this,arguments),l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,i=this.column,n=this.column.get("editable");return this.render(),(t.isFunction(n)?n.apply(i,[e]):n)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},remove:l.Extension.DependentCell.prototype.remove}),l}.apply(t,a))&&(e.exports=s)}).call(t,i(0))},13:function(e,t,i){"use strict";var n,a;n=[i(2),i(1),i(0),i(10),i(19),i(17),i(15),i(25),i(32)],void 0!==(a=function(e,t,i,n,a,s,l,o){var r=o.Model.extend({idAttribute:"privilege_type",defaults:{privilege_type:void 0,privilege:!1,with_grant:!1},validate:function(){return null}}),d=o.PrivilegeRoleModel=o.Model.extend({idAttribute:"grantee",defaults:{grantee:void 0,grantor:void 0,privileges:void 0},keys:["grantee","grantor"],privileges:[],schema:[{id:"grantee",label:e("Grantee"),type:"text",group:null,editable:!0,cellHeaderClasses:"width_percent_40",node:"role",options_cached:!1,disabled:function(e){return e instanceof n.Model&&!(e.top&&e.top.node_info&&e.top.node_info.server.user.name==e.get("grantor"))},transform:function(){var e=s.Extension.NodeListByNameCell.prototype.defaults.transform.apply(this,arguments);return e.unshift({label:"PUBLIC",value:"PUBLIC"}),e},cell:s.Extension.NodeListByNameCell.extend({initialize:function(e){var t=this,i=!0;e&&e.column&&e.column instanceof n.Model&&e.column.get("options_cached")&&(i=!1),s.Extension.NodeListByNameCell.prototype.initialize.apply(t,arguments),i&&(e=t.column.get("options"),t.column.set("options",t.omit_selected_roles.bind(t,e)));var a=function(e){var t=this;"grantee"in e.changed&&this.model.cid!=e.cid&&setTimeout(function(){t.render()},50)}.bind(this);this.listenTo(t.model.collection,"change",a,this),this.listenTo(t.model.collection,"remove",a,this)},omit_selected_roles:function(e,i){var n=e(i),a={},s=i.model,l=s.cid,o=t.has(s.top,"node_info")&&!t.isUndefined(s.top.node_info)?s.top.node_info:s.handler.top.node_info,r=o.server.user.name;return s.collection.each(function(e){var i=e.get("grantee");e.cid==l||t.isUndefined(i)||r!=e.get("grantor")||(a[i]=e.cid)}),n=t.filter(n,function(e){return!(e.value in a)})}})},{id:"privileges",label:e("Privileges"),type:"collection",model:r,group:null,cell:"privilege",control:"text",cellHeaderClasses:"width_percent_40",disabled:function(e){return!(e instanceof n.Collection)&&!(this.node_info&&this.node_info.server.user.name==e.get("grantor")||this.attributes.node_info.server.user.name==e.get("grantor"))}},{id:"grantor",label:e("Grantor"),type:"text",disabled:!0,cell:"node-list-by-name",node:"role"}],initialize:function(e,i){o.Model.prototype.initialize.apply(this,arguments),t.isNull(e)&&this.set("grantor",i&&i.top&&i.top.node_info&&i.top.node_info.server.user.name,{silent:!0});var n=this,a=n.get("privileges"),s=this.get("privileges")||{};t.isArray(s)&&(s=new o.Collection(a,{model:r,top:this.top||this,handler:this,silent:!0,parse:!1}),this.set("privileges",s,{silent:!0}));var l={};return t.each(n.privileges,function(e){l[e]={privilege_type:e,privilege:!1,with_grant:!1}}),s.each(function(e){delete l[e.get("privilege_type")]}),t.each(l,function(e){s.add(e,{silent:!0})}),n.on("change:grantee",n.granteeChanged),s.on("change",function(){n.trigger("change:privileges",n)}),n},granteeChanged:function(){var e=this.get("privileges");"PUBLIC"==this.get("grantee")&&e.each(function(e){e.set("with_grant",!1,{silent:!0})})},toJSON:function(){var e=[];return this.attributes&&!this.attributes.privileges?null:(this.attributes.privileges.each(function(t){t.get("privilege")&&e.push(t.toJSON())}),{grantee:this.get("grantee"),grantor:this.get("grantor"),privileges:e})},validate:function(){var i,n=null;if(t.isUndefined(this.get("grantee"))?(i=e("A grantee must be selected."),this.errorModel.set("grantee",i),n=i):this.errorModel.unset("grantee"),this.attributes&&this.attributes.privileges){var a=!1;this.attributes.privileges.each(function(e){e.get("privilege")&&(a=!0)}),a?this.errorModel.unset("privileges"):(i=e("At least one privilege should be selected."),this.errorModel.set("privileges",i),n=n||i)}return n}}),c=s.Extension.PrivilegeCellEditor=s.CellEditor.extend({tagName:"div",Labels:{C:"CREATE",T:"TEMPORARY",c:"CONNECT",a:"INSERT",r:"SELECT",w:"UPDATE",d:"DELETE",D:"TRUNCATE",x:"REFERENCES",t:"TRIGGER",U:"USAGE",X:"EXECUTE"},template:t.template(['<tr class="<%= header ? "header" : "" %>">',' <td class="renderable">','  <label class="privilege_label">','   <input type="checkbox" name="privilege" privilege="<%- privilege_type %>" target="<%- target %>" <%= privilege ? \'checked\' : "" %>></input>',"   <%- privilege_label %>","  </label>"," </td>",' <td class="renderable">','  <label class="privilege_label">','   <input type="checkbox" name="with_grant" privilege="<%- privilege_type %>" target="<%- target %>" <%= with_grant ? \'checked\' : "" %> <%= enable_with_grant ? "" : \'disabled\'%>></input>',"   WITH GRANT OPTION","  </label>"," </td>","</tr>"].join(" "),null,{variable:null}),events:{change:"privilegeChanged",blur:"lostFocus"},render:function(){this.$el.empty(),this.$el.attr("tabindex","1"),this.$el.attr("target",this.elId);var e=this.model.get(this.column.get("name")),n=i("<table></table>").appendTo(this.$el),a=this,s=!0,l=!0;return e.each(function(e){var i=e.toJSON();s=s&&i.privilege,l=l&&s&&i.with_grant,t.extend(i,{target:a.cid,header:!1,privilege_label:a.Labels[i.privilege_type],with_grant:"PUBLIC"!=a.model.get("grantee")&&i.with_grant,enable_with_grant:"PUBLIC"!=a.model.get("grantee")&&i.privilege}),s=s&&i.privilege,l=l&&s&&i.with_grant,n.append(a.template(i))}),e.length>1&&n.prepend(a.template({target:a.cid,privilege_label:"ALL",privilege_type:"ALL",privilege:s,with_grant:"PUBLIC"!=a.model.get("grantee")&&l,enable_with_grant:"PUBLIC"!=a.model.get("grantee")&&s,header:!0})),a.$el.find("input[type=checkbox]").first().focus(),i(a.$el.find("input[type=checkbox]")).on("blur",function(){a.$el.blur()}),i(a.$el).pgMakeVisible("backform-tab"),a.delegateEvents(),this},privilegeChanged:function(t){if(t&&t.target){var n,a,s,l=i(t.target),o=l.attr("privilege"),r=l.attr("name"),d=l.prop("checked"),c=l.closest("tr"),u=c.closest("table"),p=this.model.get("privileges"),h=this.model.get("grantee");if(this.undelegateEvents(),"ALL"==o){var f,m;s=c.find("input[name=with_grant]"),a=u.find("input[name=privilege][privilege!='ALL']"),n=u.find("input[name=with_grant][privilege!='ALL']"),"privilege"==r?(f=d,m=!1,d?(a.prop("checked",!0),"PUBLIC"==h?(n.prop("disabled",!0),s.prop("disabled",!0)):(n.prop("disabled",!1),s.prop("disabled",!1))):(a.prop("checked",!1),s.prop("checked",!1),n.prop("checked",!1),s.prop("disabled",!0),n.prop("disabled",!0))):(f=!0,m=d,n.prop("checked",d)),p.each(function(e){e.set({privilege:f,with_grant:m},{silent:!0})})}else{var g={};u=c.closest("table"),a=u.find("input[name=privilege][privilege='ALL']"),n=u.find("input[name=with_grant][privilege='ALL']"),g[r]=d,"privilege"==r?(s=l.closest("tr").find("input[name=with_grant]"),d?"PUBLIC"!=h&&s.prop("disabled",!1):(g.with_grant=!1,s.prop("checked",!1).prop("disabled",!0),a.prop("checked",!1),n.prop("disabled",!0),n.prop("checked",!1))):d||n.prop("checked",!1),p.get(o).set(g,{silent:!0}),d&&(a=u.find("input[name=privilege][privilege!='ALL']:checked"),a.length>1&&a.length==p.models.length&&(a.prop("checked",!0),"with_grant"==r?(n=u.find("input[name=with_grant][privilege!='ALL']:checked"),n.length==p.models.length&&(n.prop("disabled",!1),n.prop("checked",!0))):"PUBLIC"!=h&&n.prop("disabled",!1)))}this.model.trigger("change",this.model);var v=!1,b=null;p.each(function(e){v=v||e.get("privilege")}),v?(this.model.errorModel.unset("privileges"),this.model.errorModel.has("grantee")&&(b=this.model.errorModel.get("grantee"))):(this.model.errorModel.set("privileges",e("At least one privilege should be selected.")),b=e("At least one privilege should be selected.")),b?this.model.collection.trigger("pgadmin-session:model:invalid",b,this.model):this.model.collection.trigger("pgadmin-session:model:valid",this.model)}this.delegateEvents()},lostFocus:function(e){var t=this,i=function(e,t){for(var i=t.parentNode;null!=i;){if(i==e)return!0;i=i.parentNode}return!1};setTimeout(function(){if(("DIV"==document.activeElement.tagName||"BUTTON"==document.activeElement.tagName)&&t.$el[0]!=document.activeElement&&!i(t.$el[0],document.activeElement)){var n=t.model;n.trigger("backgrid:edited",n,t.column,new s.Command(e))}},10)}}),u=s.Extension.PrivilegeCellFormatter=function(){};return t.extend(u.prototype,{notation:{CREATE:"C",TEMPORARY:"T",CONNECT:"c",INSERT:"a",SELECT:"r",UPDATE:"w",DELETE:"d",TRUNCATE:"D",REFERENCES:"x",TRIGGER:"t",USAGE:"U",EXECUTE:"X"},fromRaw:function(e){var t="";return e instanceof n.Collection&&e.each(function(e){e.get("privilege")&&(t+=e.get("privilege_type"),e.get("with_grant")&&(t+="*"))}),t}}),s.Extension.PrivilegeCell=s.Cell.extend({className:"edit-cell",formatter:u,editor:c,initialize:function(){var e=this;s.Cell.prototype.initialize.apply(this,arguments),e.model.on("change:grantee",function(){e.$el.hasClass("editor")||setTimeout(function(){e.render()},10)})}}),d}.apply(t,n))&&(e.exports=a)},214:function(e,t,i){"use strict";var n,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=[i(1),i(8),i(3),i(0)],void 0!==(a=function(e,t,i,n){function a(e,t){return this.each(function(){var i=n(this),a=i.data("pg.menu"),l="object"==(void 0===e?"undefined":s(e))&&e;a||i.data("pg.menu",a=new o(this,l)),a.toggle(t)})}i.Browser=i.Browser||{};var l=i.Browser.MenuItem=function(t){var i=["name","label","priority","module","callback","data","enable","category","target","url","node"],n={url:"#",target:"_self",enable:!0};e.extend(this,n,e.pick(t,i))};e.extend(i.Browser.MenuItem.prototype,{$el:null,generate:function(e,t){return this.create_el(e,t),this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,t)},this.$el},create_el:function(e,t){var a=n("<a></a>",{id:this.name,href:this.url,target:this.target,"data-toggle":"pg-menu"}).data("pgMenu",{module:this.module||i.Browser,cb:this.callback,data:this.data}).addClass("menu-link");this.is_disabled=this.disabled(e,t),this.icon&&a.append(n("<i></i>",{class:this.icon}));var s=n('<span data-test="menu-item-text"></span>').text("  "+this.label);a.append(s),this.$el=n("<li/>").addClass("menu-item"+(this.is_disabled?" disabled":"")).append(a),this.applyStyle()},applyDisabledStyle:function(){var e=this.$el.find("span"),t=this.$el.find("i");e.addClass("font-gray-4"),e.removeClass("font-white"),t.addClass("font-gray-4"),t.removeClass("font-white")},applyEnabledStyle:function(){var e=this.$el,t=this.$el.find("span");t.addClass("font-white"),t.removeClass("font-gray-4"),e.find("i").addClass("font-white"),e.find("i").removeClass("font-gray-4"),t.mouseover(function(){e.addClass("bg-gray-5")}),t.mouseout(function(){e.removeClass("bg-gray-5")})},applyStyle:function(){this.is_disabled?this.applyDisabledStyle():this.applyEnabledStyle()},update:function(e,t){this.$el&&!this.$el.hasClass("disabled")&&this.$el.addClass("disabled"),this.is_disabled=this.disabled(e,t),this.$el&&!this.is_disabled&&this.$el.removeClass("disabled"),this.$el&&this.applyStyle(),this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,t)}},context_menu_callback:function(e){var n,a=this;a.module.callbacks&&a.callback in a.module.callbacks?n=a.module.callbacks[a.callback]:a.callback in a.module&&(n=a.module[a.callback]),n?n.apply(a.module,[a.data,e]):i.Browser.report_error(t('Developer Warning: Callback - "%s" not found!').sprintf(a.cb).value())},disabled:function(t,i){if(void 0==this.enable)return!1;if(this.node){if(!t)return!0;if(e.isArray(this.node)?-1==e.indexOf(this.node,t):this.node!=t._type)return!0}return e.isBoolean(this.enable)?!this.enable:e.isFunction(this.enable)?!this.enable.apply(this.module,[t,i,this.data]):this.module&&e.isBoolean(this.module[this.enable])?!this.module[this.enable]:!(!this.module||!e.isFunction(this.module[this.enable]))&&!this.module[this.enable].apply(this.module,[t,i,this.data])}}),i.Browser.MenuGroup=function(t,i,a,s){var l,o=e.template(["<% if (above) { %><hr><% } %>",'<li class="menu-item dropdown dropdown-submenu">',' <a href="#" class="dropdown-toggle" data-toggle="dropdown">','  <% if (icon) { %><i class="<%= icon %>"></i><% } %>',"  <span><%= label %></span>"," </a>",' <ul class="dropdown-menu navbar-inverse">'," </ul>","</li>","<% if (below) { %><hr><% } %>"].join("\n")),r={label:t.label,icon:t.icon,above:t.above&&!a,below:t.below},d=n(o(r)),c=d.find(".dropdown-menu"),u={},p=1;s=e.uniqueId(s+"_sub_"),i.sort(function(e,t){return e.label.localeCompare(t.label)}),i.sort(function(e,t){return e.priority-t.priority});for(var h in i)l=i[h],c.append(l.$el),l.is_disabled||(u[s+p]=l.context),p++;var f=0==e.size(u);return{$el:d,priority:t.priority||10,label:t.label,above:r.above,below:t.below,is_disabled:f,context:{name:t.label,icon:t.icon,items:u,disabled:f}}},i.Browser.MenuCreator=function(t,n,a,s,o,r){var d,c={common:[]},u=0,p=e.uniqueId("ctx_"),h=1;for(u in n)!function e(t){if(t instanceof l){t.$el&&(t.$el.remove(),delete t.$el),t.generate(s,o);(c[t.category||"common"]=c[t.category||"common"]||[]).push(t)}else for(var i in t)e(t[i])}(n[u]);r=r||{},d=c.common,delete c.common;var f=!0;for(var m in c){var g=c[m],v=a[m]||{label:m,single:!1},b=i.Browser.MenuGroup(v,g,f,p);if(g.length<=1&&!v.single){f=!1;for(u in g)d.push(g[u])}else f=g.below,d.push(b)}d.sort(function(e,t){return e.label.localeCompare(t.label)}),d.sort(function(e,t){return e.priority-t.priority});var y=e.size(d);for(u in d){o=d[u],o.priority=o.priority||10,t.append(o.$el);var _=p+"_"+o.priority+"_"+h;1!=h&&o.above&&!o.is_disabled&&(r[_+"_ma"]="----"),o.is_disabled||(r[_+"_ms"]=o.context),p!=y&&o.below&&!o.is_disabled&&(r[_+"_mz"]="----"),h++}return y>0};var o=function e(t,i){this.$element=n(t),this.options=n.extend({},e.DEFAULTS,i),this.isLoading=!1};o.DEFAULTS={},o.prototype.toggle=function(e){if(this.$element.closest(".menu-item").hasClass("disabled"))return e.preventDefault(),!1;var t=this.$element.data("pgMenu");if(t.cb){var n=t.module&&t.module.callbacks&&t.module.callbacks[t.cb]||t.module&&t.module[t.cb];n?(n.apply(t.module,[t.data,i.Browser.tree.selected()]),e.preventDefault()):i.Browser.report_error('Developer Warning: Callback - "'+t.cb+'" not found!')}};var r=n.fn.button;return n.fn.pgmenu=a,n.fn.pgmenu.Constructor=o,n.fn.pgmenu.noConflict=function(){return n.fn.pgmenu=r,this},n(document).on("click.pg.menu.data-api",'[data-toggle^="pg-menu"]',function(e){var t=n(e.target);t.hasClass("menu-link")||(t=t.closest(".menu-link")),a.call(t,"toggle",e)}).on("focus.pg.menu.data-api blur.pg.menu.data-api",'[data-toggle^="pg-menu"]',function(e){n(e.target).closest(".menu").toggleClass("focus",/^focus(in)?$/.test(e.type))}),i.Browser.MenuItem}.apply(t,n))&&(e.exports=a)},215:function(e,t,i){"use strict";var n,a;n=[i(1),i(3),i(0),i(21)],void 0!==(a=function(e,t,i){var n=t.Browser=t.Browser||{},a=window.wcDocker,s=window.wcIFrame;return t.Browser.Frame=function(t){var i=["name","title","width","height","showTitle","isCloseable","isPrivate","url","icon","onCreate"];e.extend(this,e.pick(t,i))},e.extend(t.Browser.Frame.prototype,{name:"",title:"",width:300,height:600,showTitle:!0,isClosable:!0,isPrivate:!1,url:"",icon:"",panel:null,frame:null,onCreate:null,load:function(t){var l=this;l.panel||t.registerPanelType(this.name,{title:l.title,isPrivate:l.isPrivate,onCreate:function(t){i(t).data("pgAdminName",l.name),t.initSize(l.width,l.height),0==t.showTitle&&t.title(!1),t.icon(l.icon),t.closeable(!!l.isCloseable);var o=i('<div style="position:absolute;top:0 !important;width:100%;height:100%;display:table">');t.layout().addItem(o),l.panel=t;var r=new s(o,t);i(t).data("frameInitialized",!1),i(t).data("embeddedFrame",r),""!=l.url&&"about:blank"!=l.url?setTimeout(function(){r.openURL(l.url),i(t).data("frameInitialized",!0),n.Events.trigger("pgadmin-browser:frame:urlloaded:"+l.name,r,l.url,self)},50):(r.openURL("about:blank"),i(t).data("frameInitialized",!0),n.Events.trigger("pgadmin-browser:frame:urlloaded:"+l.name,r,l.url,self)),l.events&&e.isObject(l.events)&&e.each(l.events,function(i,n){i&&e.isFunction(i)&&t.on(n,i)}),e.each([a.EVENT.UPDATED,a.EVENT.VISIBILITY_CHANGED,a.EVENT.BEGIN_DOCK,a.EVENT.END_DOCK,a.EVENT.GAIN_FOCUS,a.EVENT.LOST_FOCUS,a.EVENT.CLOSED,a.EVENT.BUTTON,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.MOVE_STARTED,a.EVENT.MOVE_ENDED,a.EVENT.MOVED,a.EVENT.RESIZE_STARTED,a.EVENT.RESIZE_ENDED,a.EVENT.RESIZED,a.EVENT.SCROLLED],function(e){t.on(e,l.eventFunc.bind(t,e))}),l.onCreate&&e.isFunction(l.onCreate)&&l.onCreate.apply(l,[t,r])}})},eventFunc:function(e){var t=i(this).data("pgAdminName");try{n.Events.trigger("pgadmin-browser:frame",e,this,arguments),n.Events.trigger("pgadmin-browser:frame:"+e,this,arguments),t&&(n.Events.trigger("pgadmin-browser:frame-"+t,e,this,arguments),n.Events.trigger("pgadmin-browser:frame-"+t+":"+e,this,arguments))}catch(e){}}}),t.Browser.Frame}.apply(t,n))&&(e.exports=a)},216:function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(3),i(11)],void 0!==(a=function(e,t,i,n,a,s){return a=a||window.pgAdmin||{},a.FileManager?a.FileManager:(a.FileManager={init:function(){if(!this.initialized){this.initialized=!0;var l=function(e){return i.ajax({data:e,type:"POST",async:!1,url:t("file_manager.get_trans_id"),dataType:"json",contentType:"application/json; charset=utf-8"})},o=function(e){return i.ajax({type:"GET",async:!1,url:t("file_manager.delete_trans_id",{trans_id:e}),dataType:"json",contentType:"application/json; charset=utf-8"})},r=function(e,n){return i.ajax({url:t("file_manager.save_last_dir",{trans_id:n}),type:"POST",data:JSON.stringify(e),contentType:"application/json"})};s.dialog("storageManagerDlg",function(){var s,d=i("<div class='storage_dialog'></div>"),c=function(e){var n=d.find(".storage_content");n.empty(),i.get(t("file_manager.index"),function(e){n.append(e)});var a,o=l(e);4==o.readyState&&(a=JSON.parse(o.responseText)),s=a.data.fileTransId};return{main:function(e){var t=this;n.isUndefined(e.dialog_title)&&(e.dialog_title="Storage manager"),this.set("title",e.dialog_title),n.isUndefined(e.btn_primary)&&(e.btn_primary="Select"),this.set("label",e.btn_primary),e=JSON.stringify(e),d.find(".storage_content").remove(),d.append("<div class='storage_content'></div>"),c(e),this.elements.dialog.style.minWidth="630px",this.show(),setTimeout(function(){i(d.find(".file_manager")).on("enter-key",function(){i(i(t.elements.footer).find(".file_manager_ok")).trigger("click")})},200)},settings:{label:void 0},settingUpdated:function(e,t,i){switch(e){case"message":this.setMessage(i);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=i)}},prepare:function(){this.__internal.buttons[0].element.disabled=!0},setup:function(){return{buttons:[{text:e("Select"),className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"},{text:e("Cancel"),className:"btn btn-danger fa fa-times pg-alertify-button"}],focus:{element:0},options:{closableByDimmer:!1}}},callback:function(t){var n;if(t.button.text==e("Select")){var l=i(".storage_dialog #uploader .input-path").val(),d={path:i(".currentpath").val()};a.Browser.Events.trigger("pgadmin-storage:finish_btn:storage_dialog",l),r(d,s),n=i(this.elements.body).find(".storage_content"),i(n).find("*").off(),n.remove(),o(s)}else t.button.text==e("Cancel")&&(n=i(this.elements.body).find(".storage_content"),i(n).find("*").off(),n.remove(),o(s),a.Browser.Events.trigger("pgadmin-storage:cancel_btn:storage_dialog"))},build:function(){this.elements.content.appendChild(d.get(0))},hooks:{onshow:function(){i(this.elements.body).addClass("pgadmin-storage-body")}}}}),s.dialog("fileSelectionDlg",function(){var s,d=i("<div class='storage_dialog file_selection_dlg'></div>"),c=function(e){var n=d.find(".storage_content");n.empty(),i.get(t("file_manager.index"),function(e){n.append(e)});var a,o=l(e);4==o.readyState&&(a=JSON.parse(o.responseText)),s=a.data.fileTransId};return{main:function(e){var t=this;n.isUndefined(e.dialog_title)&&(e.dialog_title="Select file"),this.set("title",e.dialog_title),n.isUndefined(e.btn_primary)&&(e.btn_primary="Select"),this.set("label",e.btn_primary),e=JSON.stringify(e),d.find(".storage_content").remove(),d.append("<div class='storage_content'></div>"),c(e),this.elements.dialog.style.minWidth="630px",this.show(),setTimeout(function(){i(d.find(".file_manager")).on("enter-key",function(){i(i(t.elements.footer).find(".file_manager_ok")).trigger("click")})},200)},settings:{label:void 0},settingUpdated:function(e,t,i){switch(e){case"message":this.setMessage(i);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=i)}},prepare:function(){this.__internal.buttons[0].element.disabled=!0},setup:function(){return{buttons:[{text:e("Select"),key:13,className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-times pg-alertify-button"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0}}},callback:function(t){var n;if(t.button.text==e("Select")){var l=i(".storage_dialog #uploader .input-path").val(),d={path:i(".currentpath").val()};a.Browser.Events.trigger("pgadmin-storage:finish_btn:select_file",l),n=i(this.elements.body).find(".storage_content"),i(n).find("*").off(),n.remove(),o(s),r(d,s)}else t.button.text==e("Cancel")&&(n=i(this.elements.body).find(".storage_content"),i(n).find("*").off(),n.remove(),o(s),a.Browser.Events.trigger("pgadmin-storage:cancel_btn:select_file"))},build:function(){this.elements.content.appendChild(d.get(0))},hooks:{onshow:function(){i(this.elements.body).addClass("pgadmin-storage-body")}}}}),s.dialog("folderSelectionDlg",function(){var s,d=i("<div class='storage_dialog folder_selection_dlg'></div>"),c=function(e){var n=d.find(".storage_content");n.empty(),i.get(t("file_manager.index"),function(e){n.append(e)});var a,o=l(e);4==o.readyState&&(a=JSON.parse(o.responseText)),s=a.data.fileTransId};return{main:function(e){var t=this;n.isUndefined(e.dialog_title)&&(e.dialog_title="Select folder"),this.set("title",e.dialog_title),n.isUndefined(e.btn_primary)&&(e.btn_primary="Select"),this.set("label",e.btn_primary),e=JSON.stringify(e),d.find(".storage_content").remove(),d.append("<div class='storage_content'></div>"),c(e),this.elements.dialog.style.minWidth="630px",this.show(),setTimeout(function(){i(d.find(".file_manager")).on("enter-key",function(){i(i(t.elements.footer).find(".file_manager_ok")).trigger("click")})},200)},settings:{label:void 0},settingUpdated:function(e,t,i){switch(e){case"message":this.setMessage(i);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=i)}},prepare:function(){this.__internal.buttons[0].element.disabled=!0},setup:function(){return{buttons:[{text:e("Select"),key:13,className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-times pg-alertify-button"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0}}},callback:function(t){var n;if(t.button.text==e("Select")){var l=i(".storage_dialog #uploader .input-path").val(),d={path:i(".currentpath").val()};a.Browser.Events.trigger("pgadmin-storage:finish_btn:select_folder",l),n=i(this.elements.body).find(".storage_content"),i(n).find("*").off(),n.remove(),o(s),r(d,s)}else t.button.text==e("Cancel")&&(n=i(this.elements.body).find(".storage_content"),i(n).find("*").off(),n.remove(),o(s),a.Browser.Events.trigger("pgadmin-storage:cancel_btn:select_folder"))},build:function(){this.elements.content.appendChild(d.get(0))},hooks:{onshow:function(){i(this.elements.body).addClass("pgadmin-storage-body")}}}}),s.dialog("createModeDlg",function(){var d,c=i("<div class='storage_dialog create_mode_dlg'></div>"),u=function(e){var n=c.find(".storage_content");n.empty(),i.get(t("file_manager.index"),function(e){n.append(e)});var a,s=l(e);4==s.readyState&&(a=JSON.parse(s.responseText)),d=a.data.fileTransId};return{main:function(e){var t=this;n.isUndefined(e.dialog_title)&&(e.dialog_title="Create file"),this.set("title",e.dialog_title),n.isUndefined(e.btn_primary)&&(e.btn_primary="Create"),this.set("label",e.btn_primary),e=JSON.stringify(e),c.find(".storage_content").remove(),c.append("<div class='storage_content'></div>"),u(e),this.elements.dialog.style.minWidth="630px",this.show(),setTimeout(function(){i(c.find(".file_manager")).on("enter-key",function(){i(i(t.elements.footer).find(".file_manager_ok")).trigger("click")})},200)},settings:{label:void 0},settingUpdated:function(e,t,i){switch(e){case"message":this.setMessage(i);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=i)}},prepare:function(){this.__internal.buttons[0].element.disabled=!0},setup:function(){return{buttons:[{text:e("Create"),key:13,className:"btn btn-primary fa fa-file file_manager_create file_manager_ok pg-alertify-button disabled"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-times file_manager_create_cancel pg-alertify-button"}],focus:{element:0},options:{closableByDimmer:!1,maximizable:!1,closable:!1,movable:!0}}},replace_file:function(){var e=i(".replace_file .btn_yes"),t=i(".replace_file .btn_no");i(".storage_dialog #uploader .input-path").attr("disabled",!0),i(".file_manager_ok").addClass("disabled"),i(".replace_file, .fm_dimmer").show(),e.click(function(){i(".replace_file, .fm_dimmer").hide(),e.off(),t.off();var n=i(".storage_dialog #uploader .input-path").val();a.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",n),i(".file_manager_create_cancel").trigger("click"),i(".storage_dialog #uploader .input-path").attr("disabled",!1),i(".file_manager_ok").removeClass("disabled")}),t.click(function(){i(".replace_file, .fm_dimmer").hide(),e.off(),t.off(),i(".storage_dialog #uploader .input-path").attr("disabled",!1),i(".file_manager_ok").removeClass("disabled")})},is_file_exist:function(){var e=i(".storage_dialog #uploader .input-path").val(),n=e.substr(0,e.lastIndexOf("/")+1),a=e.substr(e.lastIndexOf("/")+1),s=!1,l={path:n,name:a,mode:"is_file_exist"};return i.ajax({type:"POST",data:JSON.stringify(l),url:t("file_manager.filemanager",{trans_id:d}),dataType:"json",contentType:"application/x-download; charset=utf-8",async:!1,success:function(e){var t=e.data.result;s=1===t.Code}}),s},check_permission:function(n){var a=!1,l={path:n,mode:"permission"};return i.ajax({type:"POST",data:JSON.stringify(l),url:t("file_manager.filemanager",{trans_id:d}),dataType:"json",contentType:"application/json; charset=utf-8",async:!1,success:function(e){var t=e.data.result;1===t.Code?a=!0:(i(".file_manager_ok").addClass("disabled"),s.error(t.Error))},error:function(){i(".file_manager_ok").addClass("disabled"),s.error(e("Error occurred while checking access permission."))}}),a},callback:function(t){if(t.button.text==e("Create")){var s,l=i(".storage_dialog #uploader .input-path").val(),c={path:i(".currentpath").val()};if(!this.check_permission(l))return void(t.cancel=!0);!n.isUndefined(l)&&""!==l&&this.is_file_exist()?(this.replace_file(),t.cancel=!0):(a.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",l),s=i(this.elements.body).find(".storage_content"),i(s).find("*").off(),s.remove(),o(d)),r(c,d)}else t.button.text==e("Cancel")&&(s=i(this.elements.body).find(".storage_content"),i(s).find("*").off(),s.remove(),o(d),a.Browser.Events.trigger("pgadmin-storage:cancel_btn:create_file"))},build:function(){this.elements.content.appendChild(c.get(0))},hooks:{onshow:function(){i(this.elements.body).addClass("pgadmin-storage-body")}}}})}},show_storage_dlg:function(e){s.storageManagerDlg(e).resizeTo("60%","80%")},show_file_selection:function(e){s.fileSelectionDlg(e).resizeTo("60%","80%")},show_folder_selection:function(e){s.folderSelectionDlg(e).resizeTo("60%","80%")},show_create_dlg:function(e){s.createModeDlg(e).resizeTo("60%","80%")},show_dialog:function(e){"select_file"==e.dialog_type?this.show_file_selection(e):"select_folder"==e.dialog_type?this.show_folder_selection(e):"create_file"==e.dialog_type?this.show_create_dlg(e):this.show_storage_dlg(e)}},a.FileManager)}.apply(t,n))&&(e.exports=a)},244:function(e,t,i){"use strict";var n,a;n=[i(2),i(5),i(0),i(1),i(10),i(11),i(3),i(7),i(4),i(62)],void 0!==(a=function(e,t,i,n,a,s,l,o,r,d){return l.Preferences?l.Preferences:(l.Preferences={init:function(){this.initialized||(this.initialized=!0,s.dialog("preferencesDlg",function(){var l,c=[],u=i("<div class='preferences_dialog'></div>"),p=a.Model.extend({idAttribute:"id",defaults:{id:void 0,value:void 0}}),h={},f=this.preferences=new(a.Collection.extend({model:p,url:t("preferences.index"),updateAll:function(){for(var e in h)this.get(e).save();return!0}}))(null);f.on("reset",function(){h={}}),f.on("change",function(e){var t=e.get("id");t in h?n.isEqual(e.get("value"),h[t])&&delete h[t]:h[t]=e._previousAttributes.value});var m=function(e){var t=u.find(".preferences_content");c&&n.each(c,function(e){"$sel"in e&&e.$sel.data("select2").isOpen()&&e.$sel.data("select2").close(),e.remove()}),t.empty(),c=[],n.each(e,function(e){var i=f.get(e.id);i.errorModel=new a.Model;var s=new o.Field(n.extend({},e,{id:"value",name:"value"})),l=new(s.get("control"))({field:s,model:i});t.append(l.render().$el),c.push(l)})},g=function(){if(l){try{l.aciTree("destroy")}catch(e){}l.off("acitree",y),f.reset(),c&&n.each(c,function(e){e.remove()}),c=[],u.empty()}},v=function e(t,i){var n=i?t.itemData(i):null;if(n&&n.preferences)return void t.select(i);i=t.first(i),e(t,i)},b=function(t){switch(t.type){case"text":return"input";case"boolean":return t.options={onText:e("True"),offText:e("False"),onColor:"success",offColor:"default",size:"mini"},"switch";case"node":return t.options={onText:e("Show"),offText:e("Hide"),onColor:"success",offColor:"default",size:"mini"},"switch";case"integer":case"numeric":return"numeric";case"date":return"datepicker";case"datetime":return"datetimepicker";case"options":var i=[],a=!1;return n.each(t.options,function(e){"label"in e&&"value"in e?(i.push({label:e.label,value:e.value}),e.value==t.value&&(a=!0)):(i.push({label:e,value:e}),e==t.value&&(a=!0))}),t.select2&&1==t.select2.tags&&t.value&&0==a&&i.push({label:t.value,value:t.value}),t.options=i,"select2";case"multiline":return"textarea";case"switch":return"switch";case"keyboardshortcut":return"keyboardShortcut";default:return console&&console.warn,"input"}},y=function(e,t,i,a){i=i||t.selected();var s=i?t.itemData(i):null;switch(a){case"selected":if(!s)return!0;if(s.preferences)return m(s.preferences),!0;v(t,i);break;case"added":if(!s)return!0;s.preferences&&n.isArray(s.preferences)&&n.each(s.preferences,function(e){f.add({id:e.id,value:e.value,category_id:s.id,mid:s.mid,name:e.name}),e.control||(e.control=b(e)),e.help_str&&(e.helpMessage=e.help_str)}),s.sortable=!1;break;case"loaded":setTimeout(function(){v(t,null)},300)}return!0};return{main:function(){g(),u.append("<div class='pg-el-xs-3 preferences_tree aciTree'></div>").append("<div class='pg-el-xs-9 preferences_content'>"+e("Category is not selected.")+"</div>"),l=u.find(".preferences_tree"),l.on("acitree",y),l.aciTree({selectable:!0,expand:!0,ajax:{url:t("preferences.index")},animateRoot:!0,unanimated:!1,show:{duration:75},hide:{duration:75},view:{duration:75}}),d.modifyAcitreeAnimation(r,l.aciTree("api")),this.show()},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-default pull-left fa fa-lg fa-question",attrs:{name:"dialog_help",type:"button",label:e("Preferences"),url:t("help.static",{filename:"preferences.html"})}},{text:e("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"},{text:e("Cancel"),key:27,className:"btn btn-danger fa fa-lg fa-times pg-alertify-button"}],focus:{element:0},options:{padding:!1,overflow:!1,title:e("Preferences"),closableByDimmer:!1,modal:!1,pinnable:!1}}},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void r.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null,t.button.element.getAttribute("label"));t.button.text==e("OK")&&(f.updateAll(),setTimeout(r.cache_preferences(),2e3))},build:function(){this.elements.content.appendChild(u.get(0)),s.pgDialogBuild.apply(this)},hooks:{onshow:function(){i(this.elements.body).addClass("pgadmin-preference-body")}}}}))},show:function(){s.preferencesDlg(!0).resizeTo("60%","60%")}},l.Preferences)}.apply(t,n))&&(e.exports=a)},25:function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(8),i(3),i(214),i(10),i(11),i(265),i(19),i(87),i(20),i(44),i(7)],void 0!==(a=function(e,t,i,n,a,s,l,o,r,d,c,u){var p=window.wcDocker,h={ENTER:13,ESCAPE:27,F1:112};return r.Node?r.Node:(r.Nodes=r.Nodes||{},r.Node=function(){},r.Node.extend=function(e){var t,n=this;t=function(){return n.apply(this,arguments)},i.extend(t,n,i.omit(e,"callbacks")),t.callbacks=i.extend({},n.callbacks,e.callbacks);for(var a=i.keys(t.callbacks),s=0;s<a.length;s++)!function(e){"function"==typeof t.callbacks[e]&&(t.callbacks[e]=t.callbacks[e].bind(t))}(a[s]);return t.Init.apply(t),this.Init.apply(t),t},i.extend(a.Browser.Node,l.Events,{type:void 0,label:"",sqlAlterHelp:"",sqlCreateHelp:"",dialogHelp:"",title:function(e,t){return e.label+(t?" - "+t.label:"")},hasId:!0,Init:function(){var t=this;t.node_initialized||(t.node_initialized=!0,a.Browser.add_menus([{name:"refresh",node:t.type,module:t,applies:["object","context"],callback:"refresh",priority:1,label:e("Refresh..."),icon:"fa fa-refresh"}]),t.canEdit&&a.Browser.add_menus([{name:"show_obj_properties",node:t.type,module:t,applies:["object","context"],callback:"show_obj_properties",priority:999,label:e("Properties..."),data:{action:"edit"},icon:"fa fa-pencil-square-o"}]),t.canDrop&&(a.Browser.add_menus([{name:"delete_object",node:t.type,module:t,applies:["object","context"],callback:"delete_obj",priority:2,label:e("Delete/Drop"),data:{url:"drop"},icon:"fa fa-trash",enable:i.isFunction(t.canDrop)?function(){return!!t.canDrop.apply(t,arguments)}:!!t.canDrop}]),t.canDropCascade&&a.Browser.add_menus([{name:"delete_object_cascade",node:t.type,module:t,applies:["object","context"],callback:"delete_obj",priority:3,label:e("Drop Cascade"),data:{url:"delete"},icon:"fa fa-trash",enable:i.isFunction(t.canDropCascade)?function(){return t.canDropCascade.apply(t,arguments)}:!!t.canDropCascade}])),-1==i.indexOf(a.unsupported_nodes,t.type)&&a.Browser.add_menus([{name:"show_query_tool",node:t.type,module:t,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool..."),icon:"fa fa-bolt",enable:function(e){return!("database"!=e._type||!e.allowConn)||"database"!=e._type}}]),t.hasScriptTypes&&i.isArray(t.hasScriptTypes)&&t.hasScriptTypes.length>0&&i.each(t.hasScriptTypes,function(i){var s=n(e("%s Script")).sprintf(i.toUpperCase()).value();i=i.toLowerCase(),a.Browser.add_menus([{name:"show_script_"+i,node:t.type,module:t,applies:["object","context"],callback:"show_script",priority:4,label:s,category:"Scripts",data:{script:i},icon:"fa fa-pencil",enable:t.check_user_permission}])}))},check_user_permission:function(e,t,n){if("server_group"==e._type||"server"==e._type)return!1;if("database"==e._type&&!e.allowConn)return!1;var a=r.Nodes[e._type],s=a.getTreeNodeHierarchy(t);return-1==i.indexOf(["create","insert","update","delete"],n.script)||(!("role"!=e.type||!s.server.user.can_create_role)||!!(s.server&&(s.server.user.is_superuser||s.server.user.can_create_db)||s.schema&&s.schema.can_create))},getView:function(a,s,l,c,p,h,f,m){var g=this;if(!this.type||""==this.type)return null;if(this.model){var v=this.generate_url(a,s,c,!1);if(!v)return null;var b={};"create"!==s&&(b[this.model.idAttribute||this.model.prototype.idAttribute||"id"]=c._id);var y=this.getTreeNodeHierarchy.apply(this,[a]),_=new(this.model.extend({urlRoot:v}))(b,{node_info:y}),C=d.generateViewSchema(y,_,s,this,c);if("create"==s||"edit"==s){h=h&&f?h.bind(f):function(){};var w=function(e){var t='              <div class="media error-in-footer bg-red-1 border-red-2 font-red-3 text-14">                <div class="media-body media-middle">                  <div class="alert-icon error-icon">                    <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>                  </div>                    <div class="alert-text">'+e+'</div>                    <div class="close-error-bar">                      <a class="close-error">x</a>                    </div>                </div>              </div>';return i.isUndefined(g.statusBar)||(g.statusBar.html(t).css("visibility","visible"),g.statusBar.find("a.close-error").bind("click",function(){this.empty().css("visibility","hidden")}.bind(g.statusBar))),h(!0),!0},x=function(e){i.isUndefined(g.statusBar)||g.statusBar.empty().css("visibility","hidden"),h(!1,e)};h(!1,!1),_.on("pgadmin-session:valid",x),_.on("pgadmin-session:invalid",w)}if(i.size(C)){var k;k="fieldset"==p?new d.Fieldset({el:l,model:_,schema:C}):new d.Dialog({el:l,model:_,schema:C});var N=function(){var e=t(l).find(".tab-content:first > .tab-pane.active:first");u.findAndSetFocus(e)};if(_.isNew())k.render(),N(),_.startNewSession(),r.keyboardNavigation.getDialogTabNavigator(k);else{var E='<div class="alert alert-info pg-panel-message pg-panel-properties-message">'+e("Retrieving data from the server...")+"</div>",T=t(E),S=setTimeout(function(e){i.isUndefined(e)||T.appendTo(e)},1e3,f);_.fetch({success:function(){clearTimeout(S),T.addClass("hidden"),k.render(),N(),_.startNewSession(),r.keyboardNavigation.getDialogTabNavigator(k)},error:function(t,i,s){var l=g&&a?g.getTreeNodeHierarchy(a)[g.type].label:"";r.Events.trigger("pgadmin:node:retrieval:error","properties",t,i,s,a),o.pgHandleItemError(t,i,s,{item:a,info:y})||o.pgNotifier(i,t,n(e("Error retrieving properties - %s")).sprintf(s||l).value(),function(){}),m&&m()}})}}return k}return null},register_node_panel:function(){var t=r.docker,i=t.findPanels("node_props");if(!i||1!=i.length){var n={};n[p.EVENT.RESIZE_ENDED]=function(){var e=this.$container.find(".obj_properties").first(),t=e.data("obj-view");t&&t.model&&t.model&&t.model.trigger("pg-browser-resized",{view:t,panel:this,container:e})},i=new r.Panel({name:"node_props",showTitle:!0,isCloseable:!0,isPrivate:!0,elContainer:!0,content:'<div class="obj_properties"><div class="alert alert-info pg-panel-message">'+e("Please wait while we fetch information about the node from the server...")+"</div></div>",onCreate:function(e,t){t.addClass("pg-no-overflow")},events:n}),i.load(r.docker)}},hasScriptTypes:["create"],canEdit:!0,canDrop:!1,canDropCascade:!1,callbacks:{show_obj_properties:function(t,s){var l=r.tree,d=t&&t.item||s||l.selected(),c=d&&1==d.length?l.itemData(d):void 0,u=this,h=u.title.apply(this,[c]);if(r.Node.register_node_panel(),c){var f=this,m=i.isArray(this.parent_type)?function(e){return-1!=i.indexOf(f.parent_type,e._type)}:function(e){return f.parent_type==e._type},g=function(){var e=window.document,t=e.body,i=e.createElement("div");e.body.insertBefore(i,e.body.firstChild);var n=screen.width<800?"95%":"500px",s=screen.height<600?"95%":"550px",l=a.toPx(i,f.width||n,"width",!0),o=a.toPx(i,f.height||s,"height",!0),d=(t.offsetWidth-l)/2,c=(t.offsetHeight-o)/2,u=r.docker.addPanel("node_props",p.DOCK.FLOAT,void 0,{w:l+"px",h:o+"px",x:d+"px",y:c+"px"});return t.removeChild(i),u};if("create"==t.action){if(f.parent_type&&!m(c))for(;d&&l.hasParent(d);){d=l.parent(d);var v=l.itemData(d);if(m(v)){c=v;break}}if(!c||null!=this.parent_type&&!m(c))return;if(!c)return;h=n(e("Create - %s")).sprintf([this.label]).value(),b=g(),setTimeout(function(){u.showProperties(d,c,b,t.action)},10)}else if(r.Node.panels&&r.Node.panels[c.id]&&r.Node.panels[c.id].$container){var b=r.Node.panels[c.id],y=b.$container.attr("action-mode");if(y){var _=e('Are you sure want to stop editing the properties of %s "%s"?');"edit"==t.action&&(_=e('Are you sure want to reset the current changes and re-open the panel for %s "%s"?')),o.confirm(e("Edit in progress?"),n(_).sprintf(u.label.toLowerCase(),c.label).value(),function(){setTimeout(function(){u.showProperties(d,c,b,t.action)},10)},null).show()}else setTimeout(function(){u.showProperties(d,c,b,t.action)},10)}else r.Node.panels=r.Node.panels||{},b=r.Node.panels[c.id]=g(),setTimeout(function(){u.showProperties(d,c,b,t.action)},10);b.title(h),b.icon("icon-"+this.type),b.focus()}},delete_obj:function(a,s){var l=a||{url:"drop"},d=this,c=r.tree,u=l.item||s||c.selected(),p=u&&1==u.length?c.itemData(u):void 0;if(p){d=r.Nodes[p._type];var h,f,m=p.label;if("delete"==l.url){if(h=n(e('Are you sure you want to drop %s "%s" and all the objects that depend on it?')).sprintf(d.label.toLowerCase(),p.label).value(),f=n(e("DROP CASCADE %s?")).sprintf(d.label).value(),!(i.isFunction(d.canDropCascade)?d.canDropCascade.apply(d,[p,u]):d.canDropCascade))return void o.error(n(e('The %s "%s" cannot be dropped.')).sprintf(d.label,p.label).value(),10)}else if(h=n(e('Are you sure you want to drop %s "%s"?')).sprintf(d.label.toLowerCase(),p.label).value(),f=n(e("DROP %s?")).sprintf(d.label).value(),!(i.isFunction(d.canDrop)?d.canDrop.apply(d,[p,u]):d.canDrop))return void o.error(n(e('The %s "%s" cannot be dropped.')).sprintf(d.label,p.label).value(),10);o.confirm(f,h,function(){t.ajax({url:d.generate_url(u,l.url,p,!0),type:"DELETE",success:function(e){return 0==e.success?r.report_error(e.errormsg,e.info):r.removeTreeNode(u,!0),!0},error:function(i){var a=i.responseText;if(417==i.status||410==i.status||500==i.status)try{a=t.parseJSON(i.responseText).errormsg}catch(e){}r.report_error(n(e('Error dropping %s: "%s"')).sprintf(d.label,m).value(),a)}})},null).show()}},show_script:function(e,t){var i=e.script,n=this,s=r.tree,l=t||s.selected(),o=l&&1==l.length?s.itemData(l):void 0;if(o){n=r.Nodes[o._type];var d;d="insert"==i?"insert_sql":"update"==i?"update_sql":"delete"==i?"delete_sql":"select"==i?"select_sql":"exec"==i?"exec_sql":"sql",a.DataGrid.show_query_tool(n.generate_url(l,d,o,!0),l,i)}},show_query_tool:function(e,t){var i=r.tree,n=t||i.selected();(n&&1==n.length?i.itemData(n):void 0)&&a.DataGrid.show_query_tool("",n)},change_server_background:function(e,i){if(e&&i&&i&&i._type&&"server"==i._type){var n=t(e).find("span.aciTreeItem").first()||null,a=i.icon.split(" ")[1]||null,s=i.icon.split(" ")[2]||"";if(a){var l,o=n.parents()[3]||null,r="pga_server_"+i._id+"_bgcolor";l="<style id="+r+" type='text/css'> \n",l+="."+r+" .aciTreeItem {",l+=" border-radius: 3px; margin-bottom: 2px;",l+=" background: "+a+"} \n",s&&(l+="."+r+" .aciTreeText {",l+=" color: "+s+";} \n"),l+="</style>",t("#"+r).remove(),t(l).appendTo("head"),o&&t(o).addClass(r)}}},added:function(e,t,n){var a=n||r,s=a.tree,l=s.parent(e),o=l&&s.itemData(l),d=o&&r.Nodes[o._type];d&&d.is_collection&&("collection_count"in o||(o.collection_count=0),o.collection_count++,s.setLabel(l,{label:i.escape(o._label)+" <span>("+o.collection_count+")</span>"})),r.Node.callbacks.change_server_background(e,t)},selected:function(e,t,i){var n=i||r,s=n.tree,l=t||s.itemData(e);return a.Browser.enable_disable_menus.apply(n,[e]),l&&n&&("properties"in n.panels&&n.panels.properties&&n.panels.properties.panel&&n.panels.properties.panel.isVisible()&&this.showProperties(e,l,n.panels.properties.panel),"sql"in n.panels&&n.panels.sql&&n.panels.sql.panel&&n.panels.sql.panel.isVisible(),"statistics"in n.panels&&n.panels.statistics&&n.panels.statistics.panel&&n.panels.statistics.panel.isVisible(),"dependencies"in n.panels&&n.panels.dependencies&&n.panels.dependencies.panel&&n.panels.dependencies.panel.isVisible(),"dependents"in n.panels&&n.panels.dependents&&n.panels.dependents.panel&&n.panels.dependents.panel.isVisible()),!0},removed:function(e){var t=this,n=r.tree,a=n.parent(e),s=a&&n.itemData(a),l=s&&r.Nodes[s._type];l&&l.is_collection&&"collection_count"in s&&(s.collection_count--,n.setLabel(a,{label:i.escape(s._label)+" <span>("+s.collection_count+")</span>"})),setTimeout(function(){t.clear_cache.apply(t,e)},0)},unloaded:function(e){var t=this,n=r.tree,a=e&&n.itemData(e);t.is_collection&&"collection_count"in a&&(delete a.collection_count,n.setLabel(e,{label:i.escape(a._label)}))},refresh:function(e,t){r.Events.trigger("pgadmin:browser:tree:refresh",t||r.tree.selected())}},showProperties:function(s,l,d,c){var u=this,f=a.Browser.tree,m=d.$container.find(".obj_properties").first(),g=m.data("obj-view"),v=t('<div tabindex="1"></div>').addClass("pg-prop-content col-xs-12"),b=function(e,i){if(!d||"node_props"===d._type)switch(e.which){case h.ESCAPE:E();break;case h.ENTER:if(e.target!==i)return;if(g&&g.model&&g.model.sessChanged()){var n=t(e.target).closest(".obj_properties").find(".pg-prop-btn-group").find("button.btn-primary");k.call(this,g,n)}break;case h.F1:x()}}.bind(d);setTimeout(function(){d.$container.find(".backform-tab").on("keydown",function(e){b(e,this)})},200);var y=function(e){var i=t("<div></div>").addClass("pg-prop-status-bar").appendTo(m);return i.css("visibility","hidden"),"header"==e?i.appendTo(u.header):i.prependTo(u.footer),u.statusBar=i,i}.bind(d),_=function(e,n,a){if(e&&i.isArray(e)&&e.length>0){var s=t("<div></div>").addClass("pg-prop-btn-group"),l=i.template(['<button type="<%= type %>" ',"class=\"btn <%=extraClasses.join(' ')%>\"",'<% if (disabled) { %> disabled="disabled"<% } %> title="<%-tooltip%>">','<span class="<%= icon %>"></span><% if (label != "") { %>&nbsp;<%-label%><% } %></button>'].join(" "));return"header"==n?s.appendTo(u.header):s.appendTo(u.footer),a&&s.addClass(a),i.each(e,function(e){e.icon||(e.icon="");var i=t(l(e));s.append(i),e.register(i)}),s}return null}.bind(d),C=function(){var n=this,a=f.selected(),o=a&&f.itemData(a),d=a&&o&&r.Nodes[o._type],c=d.getTreeNodeHierarchy(a);if(!i.isEqual(t(n).data("node-prop"),c)){if(t(n).data("node-prop",c),v.hasClass("has-pg-prop-btn-group")||v.addClass("has-pg-prop-btn-group"),g&&(g.remove({data:!0,internal:!0,silent:!0}),g=null,m.data("obj-view",null)),m.empty(),u.header=t("<div></div>").addClass("pg-prop-header").appendTo(m),u.footer=t("<div></div>").addClass("pg-prop-footer").appendTo(m),g=u.getView(s,"properties",v,l,"fieldset",void 0,m)){m.data("obj-view",g);var p=[];p.push({label:"",type:"edit",tooltip:e("Edit"),extraClasses:["btn-default"],icon:"fa fa-lg fa-pencil-square-o",disabled:!u.canEdit,register:function(e){e.click(function(){I()})}}),p.push({label:"",type:"help",tooltip:e("SQL help for this object type."),extraClasses:["btn-default","pull-right"],icon:"fa fa-lg fa-info",disabled:""==u.sqlAlterHelp&&""==u.sqlCreateHelp,register:function(e){e.click(function(){w()})}}),_(p,"header","pg-prop-btn-group-above bg-gray-2 border-gray-3")}m.append(v)}}.bind(d),w=function(){var e=r.docker.findPanels("pnl_sql_help")[0];if(null==e){var i=r.docker.findPanels("properties")[0];r.docker.addPanel("pnl_sql_help",p.DOCK.STACKED,i),e=r.docker.findPanels("pnl_sql_help")[0]}var a=u.getTreeNodeHierarchy(s).server,l=r.utils.pg_help_path;"ppas"==a.server_type&&(l=r.utils.edbas_help_path);var o=Math.floor(a.version/1e4),d=Math.floor(a.version/100)-100*o;l=l.replace("$VERSION$",o+"."+d),n(l).endsWith("/")||(l+="/"),""==u.sqlCreateHelp&&""!=u.sqlAlterHelp?l+=u.sqlAlterHelp:""!=u.sqlCreateHelp&&""==u.sqlAlterHelp?l+=u.sqlCreateHelp:g.model.isNew()?l+=u.sqlCreateHelp:l+=u.sqlAlterHelp;var c=t(e).data("embeddedFrame");e.title("SQL: "+u.label),e.focus(),c.openURL(l)}.bind(d),x=function(){var e=r.docker.findPanels("pnl_online_help")[0];if(null==e){var i=r.docker.findPanels("properties")[0];r.docker.addPanel("pnl_online_help",p.DOCK.STACKED,i),e=r.docker.findPanels("pnl_online_help")[0]}var n=t(e).data("embeddedFrame");e.focus(),n.openURL(u.dialogHelp)}.bind(d),k=function(n,a){var s=n.model,l=s.toJSON(!0),d=setTimeout(function(){t(".obj_properties").addClass("show_progress")},1e3);a&&t(a).prop("disabled",!0),l&&!i.isEmpty(l)&&s.save({},{attrs:l,validate:!1,cache:!1,wait:!0,success:function(){M.call(),t(".obj_properties").removeClass("show_progress"),clearTimeout(d);var e=r.docker.findPanels("properties")[0],i=r.docker.findPanels("sql")[0],n=r.docker.findPanels("statistics")[0],a=r.docker.findPanels("dependencies")[0],s=r.docker.findPanels("dependents")[0];e&&t(e).removeData("node-prop"),i&&t(i).removeData("node-prop"),n&&t(n).removeData("node-prop"),a&&t(a).removeData("node-prop"),s&&t(s).removeData("node-prop")},error:function(i,n){o.pgNotifier("error",n,e("Error saving properties")),t(".obj_properties").removeClass("show_progress"),clearTimeout(d),a&&t(a).prop("disabled",!1)}})}.bind(d),N=function(){var n=this;c&&"properties"==c&&(c="edit"),n.$container.attr("action-mode",c),g&&(g.remove({data:!0,internal:!0,silent:!0}),g=null,m.data("obj-view",null)),m.empty(),u.header=t("<div></div>").addClass("pg-prop-header").appendTo(m),u.footer=t("<div></div>").addClass("pg-prop-footer").appendTo(m);var a=function(e,t){var i=this.find(".pg-prop-btn-group"),n=i.find("button.btn-primary"),a=i.find("button.btn-warning");e||!t?(n.prop("disabled",!0),n.attr("disabled","disabled")):(n.prop("disabled",!1),n.removeAttr("disabled")),t?(a.prop("disabled",!1),a.removeAttr("disabled")):(a.prop("disabled",!0),a.attr("disabled","disabled"))};g=u.getView(s,c,v,l,"dialog",a,m,A),g&&(m.data("obj-view",g),n.icon(i.isFunction(u.node_image)?u.node_image.apply(u,[l,g.model]):u.node_image||"icon-"+u.type),_([{label:"",type:"help",tooltip:e("SQL help for this object type."),extraClasses:["btn-default","pull-left"],icon:"fa fa-lg fa-info",disabled:""==u.sqlAlterHelp&&""==u.sqlCreateHelp,register:function(e){e.click(function(){w()})}},{label:"",type:"help",tooltip:e("Help for this dialog."),extraClasses:["btn-default","pull-left"],icon:"fa fa-lg fa-question",disabled:""==u.dialogHelp,register:function(e){e.click(function(){x()})}},{label:e("Save"),type:"save",tooltip:e("Save this object."),extraClasses:["btn-primary"],icon:"fa fa-lg fa-save",disabled:!0,register:function(e){e.click(function(){k.call(this,g,e)})}},{label:e("Cancel"),type:"cancel",tooltip:e("Cancel changes to this object."),extraClasses:["btn-danger"],icon:"fa fa-lg fa-close",disabled:!1,register:function(e){e.click(function(){n.$container.removeAttr("action-mode"),A.call(arguments)})}},{label:e("Reset"),type:"reset",tooltip:e("Reset the fields on this dialog."),extraClasses:["btn-warning"],icon:"fa fa-lg fa-recycle",disabled:!0,register:function(e){e.click(function(){setTimeout(function(){N.call()},0)})}}],"footer","pg-prop-btn-group-below bg-gray-2 border-gray-3")),y("footer"),v.addClass("pg-prop-has-btn-group-below"),m.prepend(v)}.bind(d),E=function(){this.close()}.bind(d),T=function(e){var t=l,n=i.clone(g.model.tnode),a=i.clone(g.model.node_info);setTimeout(function(){e.clear_cache.apply(e,s)},0),r.Events.trigger("pgadmin:browser:tree:update",t,n,a,{success:function(e,t,i){r.Events.trigger("pgadmin:browser:node:updated",e,t,i),r.Events.trigger("pgadmin:browser:node:"+t._type+":updated",e,t,i)}}),E()},S=function(e){var t=this,n=t.$container.find(".obj_properties").first(),a=n.data("obj-view");setTimeout(function(){e.clear_cache.apply(e,s)},0);try{r.Events.trigger("pgadmin:browser:tree:add",i.clone(a.model.tnode),i.clone(a.model.node_info))}catch(e){}E()}.bind(d,u),D=function(){setTimeout(function(){u.callbacks.show_obj_properties.apply(u,[{action:"edit",item:s}])},0)},A=E,M=T.bind(d,u),I=N.bind(d);if(c?("create"==c&&(A=E,M=S),"properties"!=c?N():C()):(C(),I=D.bind(d)),d.closeable()){var O=function(){var e=this.$container.find(".obj_properties").first(),t=e&&e.data("obj-view");t&&t.remove({data:!0,internal:!0,silent:!0})}.bind(d);d.on(p.EVENT.CLOSED,O)}},_find_parent_node:function(e,t,n){if(this.parent_type)if(n=n||e.itemData(t),i.isString(this.parent_type)){if(this.parent_type==n._type)return t;for(;e.hasParent(t);)if(t=e.parent(t),n=e.itemData(t),this.parent_type==n._type)return t}else{if(i.indexOf(this.parent_type,n._type)>=0)return t;for(;e.hasParent(t);)if(t=e.parent(t),n=e.itemData(t),i.indexOf(this.parent_type,n._type)>=0)return t}return null},generate_url:function(e,t,n,a,s){var l={create:"obj",drop:"obj",edit:"obj",properties:"obj",statistics:"stats"},o=this,d=-1/0,u=i.isUndefined(e)||i.isNull(e)?s||{}:this.getTreeNodeHierarchy(e),p=t in l?l[t]:t,h=a&&n._type==o.type?encodeURIComponent(n._id):"";if(o.parent_type)if(i.isString(o.parent_type)){var f=u[o.parent_type];f&&(d=f.priority)}else i.each(o.parent_type,function(e){var t=u[e];t&&d<t.priority&&(d=t.priority)});var m=function(e){return e.priority<=d};return c.generate_url(r.URL,u,p,o.type,m,h)},Collection:r.DataCollection,Model:r.DataModel,getTreeNodeHierarchy:function(e){var t,n=0,a={},s=r.tree;do{t=s.itemData(e),t._type in r.Nodes&&r.Nodes[t._type].hasId&&(a[t._type]=i.extend({},t,{priority:n}),n-=1),e=s.hasParent(e)?s.parent(e):null}while(e);return a},cache:function(e,t,a,s){var l=this.cached=this.cached||{},o=e,r=t&&t[a]&&t[a].priority||0;if(t&&i.each(i.sortBy(i.values(i.pick(t,function(e){return e.priority<=r})),function(e){return e.priority}),function(e){o=n("%s/%s").sprintf(o,encodeURI(e._id)).value()}),i.isUndefined(s)){var d=l[o];return!i.isUndefined(d)&&d.at-Date.now()>3e5&&(d=void 0),d}return d=l[o]={data:s,at:Date.now(),level:a}},clear_cache:function(e){this.cached={};var t=this;r.Events.trigger("pgadmin:browser:node:"+t.type+":cache_cleared",e,t)},cache_level:function(e,t){if(e){if(t&&this.type in e)return this.type;if(i.isArray(this.parent_type)){for(var n in this.parent_type)if(n in e)return n;return this.type}return this.parent_type}}}),a.Browser.Node)}.apply(t,n))&&(e.exports=a)},263:function(e,t,i){"use strict";var n,a;n=[i(1),i(3),i(0),i(21)],void 0!==(a=function(e,t,i){var n=t.Browser=t.Browser||{},a=window.wcDocker;return t.Browser.Panel=function(t){var i=["name","title","width","height","showTitle","isCloseable","isPrivate","content","icon","events","onCreate","elContainer","canHide","limit"];e.extend(this,e.pick(t,i))},e.extend(t.Browser.Panel.prototype,{name:"",title:"",width:300,height:600,showTitle:!0,isCloseable:!0,isPrivate:!1,content:"",icon:"",panel:null,onCreate:null,elContainer:!1,limit:null,load:function(t,n){var s=this;s.panel||t.registerPanelType(s.name,{title:s.title,isPrivate:s.isPrivate,limit:s.limit,onCreate:function(t){if(i(t).data("pgAdminName",s.name),t.initSize(s.width,s.height),s.showTitle){var l='<a href="#" tabindex="0" class="panel-link-heading">'+(n||s.title)+"</a>";t.title(l),""!=s.icon&&t.icon(s.icon)}else t.title(!1);var o=i("<div>",{class:"pg-panel-content"}).append(i(s.content));t.closeable(!!s.isCloseable),t.layout().addItem(o),s.panel=t,s.events&&e.isObject(s.events)&&e.each(s.events,function(i,n){i&&e.isFunction(i)&&t.on(n,i)}),e.each([a.EVENT.UPDATED,a.EVENT.VISIBILITY_CHANGED,a.EVENT.BEGIN_DOCK,a.EVENT.END_DOCK,a.EVENT.GAIN_FOCUS,a.EVENT.LOST_FOCUS,a.EVENT.CLOSED,a.EVENT.BUTTON,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.MOVE_STARTED,a.EVENT.MOVE_ENDED,a.EVENT.MOVED,a.EVENT.RESIZE_STARTED,a.EVENT.RESIZE_ENDED,a.EVENT.RESIZED,a.EVENT.SCROLLED],function(e){t.on(e,s.eventFunc.bind(t,e))}),s.onCreate&&e.isFunction(s.onCreate)&&s.onCreate.apply(s,[t,o]),s.elContainer&&(t.pgElContainer=o,o.addClass("pg-el-container"),e.each([a.EVENT.RESIZED,a.EVENT.ATTACHED,a.EVENT.DETACHED,a.EVENT.VISIBILITY_CHANGED],function(e){t.on(e,s.resizedContainer.bind(t))}),s.resizedContainer.apply(t)),s.canHide&&e.each([a.EVENT.CLOSED,a.EVENT.VISIBILITY_CHANGED],function(e){t.on(e,s.handleVisibility.bind(t,e))})}})},eventFunc:function(e){var t=i(this).data("pgAdminName");try{n.Events.trigger("pgadmin-browser:panel",e,this,arguments),n.Events.trigger("pgadmin-browser:panel:"+e,this,arguments),t&&(n.Events.trigger("pgadmin-browser:panel-"+t,e,this,arguments),n.Events.trigger("pgadmin-browser:panel-"+t+":"+e,this,arguments))}catch(e){}},resizedContainer:function(){var e=this;if(e.pgElContainer&&!e.pgResizeTimeout){if(!e.isVisible())return clearTimeout(e.pgResizeTimeout),void(e.pgResizeTimeout=null);e.pgResizeTimeout=setTimeout(function(){var t=e.width();e.pgResizeTimeout=null,t=t<=480?"xs":t<600?"sm":t<768?"md":"lg",e.pgElContainer.attr("el",t)},100)}},handleVisibility:function(i){if("dashboard"==this._type&&!e.isUndefined(t.Dashboard))if("panelClosed"==i)n.save_current_layout(n),t.Dashboard.toggleVisibility(!1);else if("panelVisibilityChanged"==i&&n.tree){n.save_current_layout(n);var s=n.tree.selected();this.off(a.EVENT.VISIBILITY_CHANGED),e.isUndefined(t.Dashboard)||t.Dashboard.toggleVisibility(!0),n.Events.trigger("pgadmin-browser:tree:selected",s,n.tree.itemData(s),n.Node)}}}),t.Browser.Panel}.apply(t,n))&&(e.exports=a)},264:function(e,t,i){"use strict";var n,a;n=[i(2),i(1),i(15),i(3)],void 0!==(a=function(e,t,i,n){return n.Browser=n.Browser||{},t.extend(n.Browser,{report_error:function(t,n,a){var s='<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">           <div class="panel panel-default">           <div class="panel-heading" role="tab" id="headingOne">           <h4 class="panel-title">           <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">           '+e("Error message")+'</a>        </h4>        </div>        <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">        <div class="panel-body" style="overflow: auto;">'+unescape(n)+"</div>        </div>        </div>";null!=a&&""!=a&&(s+='<div class="panel panel-default">            <div class="panel-heading" role="tab" id="headingTwo">            <h4 class="panel-title">            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">            '+e("Additional info")+'</a>          </h4>          </div>          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">          <div class="panel-body" style="overflow: auto;">'+unescape(a)+"</div>          </div>          </div>          </div>"),s+="</div>",i.alert(t,s)}}),n.Browser.report_error}.apply(t,n))&&(e.exports=a)},265:function(e,t,i){"use strict";var n,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=[i(1),i(8),i(3),i(0),i(10)],void 0!==(a=function(e,t,i,n,a){var l=i.Browser=i.Browser||{};return l.DataModel=a.Model.extend({on_server:!1,parse:function(t){var i=this;t&&e.isObject(t)&&"node"in t&&t.node&&(i.tnode=e.extend({},t.node),delete t.node);return function n(s){s&&e.isArray(s)&&e.each(s,function(s){var o,r;switch(s.type){case"collection":o=i.get(s.id),r=t[s.id],e.isArray(r)||e.isObject(r)?o&&o instanceof a.Collection?o.reset(r,{silent:!0,parse:!0,on_server:!0}):(o=new l.Node.Collection(r,{model:e.isString(s.model)&&s.model in l.Nodes?l.Nodes[s.model].model:s.model,top:i.top||i,handler:i,parse:!0,silent:!0,attrName:s.id}),i.set(s.id,o,{silent:!0,parse:!0,on_server:!0})):o=null,i.set(s.id,o,{silent:!0}),t[s.id]=o;break;case"model":o=i.get(s.id),r=t[s.id],e.isUndefined(r)||e.isNull(r)?o=null:(o&&o instanceof a.Model||(o=e.isString(s.model)&&s.model in l.Nodes[s.model]?new l.Nodes[s.model].Model(o,{silent:!0,top:i.top||i,handler:i,attrName:s.id}):new s.model(o,{silent:!0,top:i.top||i,handler:i,attrName:s.id})),o.set(r,{parse:!0,silent:!0})),t[s.id]=o;break;case"nested":n(s.schema)}})}(i.schema),t},isNew:function(){return this.has(this.idAttribute)?!this.has(this.idAttribute):!this.on_server},primary_key:function(){if(this.keys&&e.isArray(this.keys)){var t={},i=this;return e.each(i.keys,function(e){t[e]=i.attributes[e]}),JSON.stringify(t)}return this.cid},initialize:function(t,i){var n=this;n._previous_key_values={},!e.isUndefined(i)&&"on_server"in i&&i.on_server&&(n.on_server=!0),a.Model.prototype.initialize.apply(n,arguments),(e.isUndefined(i)||e.isNull(i))&&(i=t||{},t=null),n.sessAttrs={},n.fieldData={},n.origSessAttrs={},n.objects=[],n.arrays=[],n.attrName=i.attrName,n.top=i.top||n.collection&&n.collection.top||n.collection||n,n.handler=i.handler||n.collection&&n.collection.handler,n.trackChanges=!1,n.errorModel=new a.Model,n.node_info=i.node_info;var s;return function t(i){i&&e.isArray(i)&&e.each(i,function(i){switch(i.type){case"int":case"numeric":n.fieldData[i.id]={id:i.id,label:i.label,type:i.type,min:i.min||void 0,max:i.max||void 0};break;default:n.fieldData[i.id]={id:i.id,label:i.label,type:i.type}}switch(i.type){case"array":n.arrays.push(i.id);break;case"collection":if(!((s=n.get(i.id))&&s instanceof l.Node.Collection))if(e.isString(i.model)&&i.model in l.Nodes){var o=l.Nodes[i.model];s=new o.Collection(s,{model:o.model,top:n.top||n,handler:n,attrName:i.id})}else s=new l.Node.Collection(s,{model:i.model,top:n.top||n,handler:n,attrName:i.id});s.name=i.id,n.objects.push(i.id),n.set(i.id,s,{silent:!0});break;case"model":s=n.get(i.id),s&&s instanceof a.Model||(s=e.isString(i.model)&&i.model in l.Nodes[i.model]?new l.Nodes[i.model].Model(s,{top:n.top||n,handler:n,attrName:i.id}):new i.model(s,{top:n.top||n,handler:n,attrName:i.id})),s.name=i.id,n.objects.push(i.id),n.set(i.id,s,{silent:!0});break;case"nested":t(i.schema);break;default:return}})}(n.schema),n.handler&&n.handler.trackChanges&&n.startNewSession(),"keys"in n&&e.isArray(n.keys)&&e.each(n.keys,function(e){n.on("change:"+e,function(t){n._previous_key_values[e]=t.previous(e)})}),n},reset:function(e){var t;e&&e.stop&&this.stopSession();for(var i in this.objects)(t=this.get(i))&&(t instanceof l.DataModel?t.reset(e):t instanceof a.Model?t.clear(e):t instanceof l.DataCollection?t.reset(e):t instanceof a.Collection&&(t.each(function(i){i instanceof a.DataModel&&(t.reset(),t.clear(e))}),e instanceof Array||(e=[e]),a.Collection.prototype.reset.apply(t,e)));this.clear(e)},sessChanged:function(){var t=this;return e.size(t.sessAttrs)>0||e.some(t.objects,function(i){var n=t.get(i);return!e.isNull(n)&&!e.isUndefined(n)&&n.sessChanged()})},sessValid:function(){var t=this;return!("default_validate"in t&&"function"==typeof t.default_validate&&e.isString(t.default_validate()))&&!("validate"in t&&e.isFunction(t.validate)&&e.isString(t.validate.apply(t)))},set:function(t,i,n){var l=e.isObject(t)?i:n;this._changing=!0,this._previousAttributes=e.clone(this.attributes),this.changed={};var o=a.Model.prototype.set.call(this,t,i,n);if(this._changing=!1,l&&l.internal||!this.trackChanges)return!0;if(null!=t&&o){var r,d={},c=this,u=function(t,i){i in c.objects||(d[i]=t,e.isEqual(c.origSessAttrs[i],t)?delete c.sessAttrs[i]:c.sessAttrs[i]=t)};return"object"===(void 0===t?"undefined":s(t))?e.each(t,u):u(i,t),c.trigger("pgadmin-session:set",c,d),n&&n.silent||c.trigger("change",c,n),"default_validate"in c&&"function"==typeof c.default_validate&&(r=c.default_validate()),"validate"in c&&"function"==typeof c.validate&&(r||(r=c.validate(e.keys(d)))),0==e.size(c.errorModel.attributes)?c.collection||c.handler?(c.collection||c.handler).trigger("pgadmin-session:model:valid",c,c.collection||c.handler):c.trigger("pgadmin-session:valid",c.sessChanged(),c):(r=r||e.values(c.errorModel.attributes)[0],c.collection||c.handler?(c.collection||c.handler).trigger("pgadmin-session:model:invalid",r,c,c.collection||c.handler):c.trigger("pgadmin-session:invalid",r,c)),o}return o},toJSON:function(t,i){var n,s=this,l=s.isNew();return t=void 0!==t&&1==t,!t||l?n=a.Model.prototype.toJSON.call(this,arguments):(n={},n[s.idAttribute||"_id"]=s.get(s.idAttribute||"_id"),n=e.extend(n,s.sessAttrs)),e.each(s.objects,function(e){var a=s.get(e);t?n[e]instanceof Array?n[e]=JSON.stringify(n[e]):a&&a.sessChanged&&a.sessChanged()||l?(n[e]=a&&a.toJSON(!l),a&&i&&"GET"==i&&(n[e]=JSON.stringify(n[e]))):delete n[e]:n[e]instanceof Array||(n[e]=a&&a.toJSON())}),t&&e.each(s.arrays,function(e){n[e]&&n[e]instanceof Array&&(n[e]=JSON.stringify(n[e]))}),n},startNewSession:function(){var t=this;t.trackChanges&&(t.trigger("pgadmin-session:stop",t),t.off("pgadmin-session:model:invalid",t.onChildInvalid),t.off("pgadmin-session:model:valid",t.onChildValid),t.off("pgadmin-session:changed",t.onChildChanged),t.off("pgadmin-session:added",t.onChildChanged),t.off("pgadmin-session:removed",t.onChildChanged)),t.trackChanges=!0,t.sessAttrs={},t.origSessAttrs=e.clone(t.attributes),e.each(t.objects,function(i){var n=t.get(i);e.isUndefined(n)||e.isNull(n)||(delete t.origSessAttrs[i],n&&"startNewSession"in n&&e.isFunction(n.startNewSession)&&n.startNewSession())}),t.trigger("pgadmin-session:start",t),t.on("pgadmin-session:model:invalid",t.onChildInvalid),t.on("pgadmin-session:model:valid",t.onChildValid),t.on("pgadmin-session:changed",t.onChildChanged),t.on("pgadmin-session:added",t.onChildChanged),t.on("pgadmin-session:removed",t.onChildChanged)},onChildInvalid:function(t,i){var n=this;if(n.trackChanges&&i){var a=i.attrName;if(!a){var s=i.primary_key&&"function"==typeof i.primary_key,l=s?i.primary_key():i.cid,o=s?function(e){var t=n.get("k");return!(!t||t.primary_key()!==l)&&(a=e,!0)}:function(e){return n.get(e).cid===l&&(a=e,!0)};e.findIndex(n.objects,o)}a&&(n.errorModel.set(a,t),n.handler?n.handler.trigger("pgadmin-session:model:invalid",t,n,n.handler):n.trigger("pgadmin-session:invalid",t,n))}return this},onChildValid:function(t){var i=this;if(i.trackChanges&&t){var n=t.attrName;if(!n){var s=t.primary_key&&"function"==typeof t.primary_key,l=s?t.primary_key():t.cid,o=s?function(e){var t=i.get("k");return!(!t||t.primary_key()!==l)&&(n=e,!0)}:function(e){var t=i.get("k");return!(!t||t.cid!==l)&&(n=e,!0)};e.findIndex(i.objects,o)}var r=null,d=function(t,i){return"default_validate"in t&&"function"==typeof t.default_validate&&(r=t.default_validate(),e.isString(r))?r:"validate"in t&&"function"==typeof t.validate?r=t.validate(i):null};if(t instanceof a.Collection){for(var c in t.models)if(d(t.models[c]))break}else t instanceof a.Model&&d(t);n&&i.errorModel.has(n)&&(r?i.errorModel.set(n,r):i.errorModel.unset(n)),0!=e.size(i.errorModel.attributes)||d(i,n&&[n])?(r=r||e.values(i.errorModel.attributes)[0],i.handler?i.handler.trigger("pgadmin-session:model:invalid",r,i,i.handler):i.trigger("pgadmin-session:invalid",r,i)):i.handler?i.handler.trigger("pgadmin-session:model:valid",i,i.handler):i.trigger("pgadmin-session:valid",i.sessChanged(),i)}},onChildChanged:function(){var e=this;e.trackChanges&&e.collection&&e.collection.trigger("change",e)},stopSession:function(){var t=this;t.trackChanges&&(t.off("pgadmin-session:model:invalid",t.onChildInvalid),t.off("pgadmin-session:model:valid",t.onChildValid),t.off("pgadmin-session:changed",t.onChildChanged),t.off("pgadmin-session:added",t.onChildChanged),t.off("pgadmin-session:removed",t.onChildChanged)),t.trackChanges=!1,t.sessAttrs={},t.origSessAttrs={},e.each(t.objects,function(i){var n=t.get(i);e.isUndefined(n)||e.isNull(n)||(t.origSessAttrs[i]=null,delete t.origSessAttrs[i],n&&"stopSession"in n&&e.isFunction(n.stopSession)&&n.stopSession())}),t.trigger("pgadmin-session:stop")},default_validate:function(){for(var t,i,n,a,s=0,l=e.keys(this.attributes),o=l.length;s<o;s++)if(n=this.attributes[l[s]],i=this.fieldData[l[s]],t=null,e.isUndefined(n)||e.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,""))i&&this.errorModel.unset(i.id);else{if(!i)continue;if(!(a=i.type||void 0))continue;switch(a){case"int":t=this.integer_validate(n,i);break;case"numeric":t=this.number_validate(n,i)}if(t)return this.errorModel.set(i.id,t),t;this.errorModel.unset(i.id)}return null},check_min_max:function(e,n){var a=n.label,s=n.min,l=n.max;return s&&e<s?t(i.Browser.messages.MUST_GR_EQ).sprintf(a,s).value():l&&e>l?t(i.Browser.messages.MUST_LESS_EQ).sprintf(a,l).value():null},number_validate:function(e,n){return new RegExp("^-?[0-9]+(.?[0-9]*)?$").test(e)?this.check_min_max(e,n):t(i.Browser.messages.MUST_BE_NUM).sprintf(n.label).value()},integer_validate:function(e,n){return new RegExp("^-?[0-9]*$").test(e)?this.check_min_max(e,n):t(i.Browser.messages.MUST_BE_INT).sprintf(n.label).value()}}),l.DataCollection=a.Collection.extend({initialize:function(e,t){var i=this;return t=t||{},i.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},i.top=t.top||i,i.attrName=t.attrName,i.handler=t.handler,i.trackChanges=!1,i.on("add",i.onModelAdd),i.on("remove",i.onModelRemove),i.on("change",i.onModelChange),i.handler&&i.handler.trackChanges&&i.startNewSession(),i},startNewSession:function(){var t,i=this;i.trackChanges&&(i.trigger("pgadmin-session:stop",i),i.off("pgadmin-session:model:invalid",i.onModelInvalid),i.off("pgadmin-session:model:valid",i.onModelValid)),i.trackChanges=!0,i.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},e.each(i.models,function(n){"startNewSession"in n&&e.isFunction(n.startNewSession)&&n.startNewSession(),"default_validate"in n&&"function"==typeof n.default_validate&&(t=n.default_validate()),e.isString(t)?i.sessAttrs.invalid[n.cid]=t:"validate"in n&&"function"==typeof n.validate&&(t=n.validate())&&(i.sessAttrs.invalid[n.cid]=t)}),i.trigger("pgadmin-session:start",i),i.on("pgadmin-session:model:invalid",i.onModelInvalid),i.on("pgadmin-session:model:valid",i.onModelValid)},onModelInvalid:function(e,t){var i=this,n=i.sessAttrs.invalid;return i.trackChanges&&(n[t.cid]=e,i.handler?i.handler.trigger("pgadmin-session:model:invalid",e,i,i.handler):i.trigger("pgadmin-session:invalid",e,i)),!0},onModelValid:function(e){var t=this,i=t.sessAttrs.invalid;if(t.trackChanges){var n=t.checkDuplicateWithModel(e);n&&e.cid in i&&delete i[e.cid],n&&this.triggerValidationEvent.apply(this)}return!0},stopSession:function(){var t=this;t.trackChanges=!1,t.sessAttrs={changed:[],added:[],deleted:[],invalid:[]},e.each(t.models,function(t){"stopSession"in t&&e.isFunction(t.stopSession)&&t.stopSession()})},sessChanged:function(){return this.sessAttrs.changed.length>0||this.sessAttrs.added.length>0||this.sessAttrs.deleted.length>0},toJSON:function(t){var i=this;if(t=void 0!==t&&1==t){var n={};return n.added=[],e.each(this.sessAttrs.added,function(e){n.added.push(e.toJSON())}),0==n.added.length&&delete n.added,n.changed=[],e.each(i.sessAttrs.changed,function(e){n.changed.push(e.toJSON(!0))}),0==n.changed.length&&delete n.changed,n.deleted=[],e.each(i.sessAttrs.deleted,function(e){n.deleted.push(e.toJSON())}),0==n.deleted.length&&delete n.deleted,0==e.size(n)?null:n}return a.Collection.prototype.toJSON.call(i)},reset:function(e){e&&e.stop&&this.stopSession(),this.each(function(t){t&&(t instanceof l.DataModel?t.reset(e):t.clear(e))}),a.Collection.prototype.reset.apply(this,arguments)},objFindInSession:function(t,i){var n=t.primary_key&&"function"==typeof t.primary_key,a=n?t.primary_key():t.cid,s=n?function(e){return e.primary_key()===a}:function(e){return e.cid===a};return e.findIndex(this.sessAttrs[i],s)},onModelAdd:function(t){if(!this.trackChanges)return!0;var i,n=this,a=n.objFindInSession(t,"deleted");if(a>=0){var s=n.sessAttrs.deleted[a];t.origSessAttrs=e.clone(s.origSessAttrs),t.attributes=e.extend(t.attributes,s.attributes),t.sessAttrs=e.clone(s.sessAttrs),n.sessAttrs.deleted.splice(a,1),"sessChanged"in t&&!t.sessChanged()||n.sessAttrs.changed.push(t),(n.handler||n).trigger("pgadmin-session:added",n,t),"default_validate"in t&&"function"==typeof t.default_validate&&(i=t.default_validate()),e.isString(i)?n.sessAttrs.invalid[t.cid]=i:"validate"in t&&"function"==typeof t.validate&&(i=t.validate())&&(n.sessAttrs.invalid[t.cid]=i)}else"default_validate"in t&&"function"==typeof t.default_validate&&(i=t.default_validate()),e.isString(i)?n.sessAttrs.invalid[t.cid]=i:"validate"in t&&"function"==typeof t.validate&&(i=t.validate())&&(n.sessAttrs.invalid[t.cid]=i),n.sessAttrs.added.push(t),(n.handler||n).trigger("pgadmin-session:added",n,t);return this.triggerValidationEvent.apply(this),!0},onModelRemove:function(t){if(!this.trackChanges)return!0;t.errorModel.clear();var i=this,n=i.sessAttrs.invalid,a=e.clone(t),s=i.objFindInSession(t,"added");return t.cid in n&&delete n[t.cid],s>=0?(i.sessAttrs.added.splice(s,1),(i.handler||i).trigger("pgadmin-session:removed",i,a),i.checkDuplicateWithModel(a),this.triggerValidationEvent.apply(this),!0):(s=i.objFindInSession(t,"changed"),s>=0?(i.sessAttrs.changed.splice(s,1),(i.handler||i).trigger("pgadmin-session:removed",i,a)):(i.handler||i).trigger("pgadmin-session:removed",i,a),i.sessAttrs.deleted.push(t),i.checkDuplicateWithModel(t),this.triggerValidationEvent.apply(this),!0)},triggerValidationEvent:function(){var e=this,t=null,i=e.sessAttrs.invalid,n=[];for(var a in i){if(t=i[a])break;n.push(a)}for(a in n)delete i[n[a]];t?e.handler?e.handler.trigger("pgadmin-session:model:invalid",t,e,e.handler):e.trigger("pgadmin-session:invalid",t,e):e.handler?e.handler.trigger("pgadmin-session:model:valid",e,e.handler):e.trigger("pgadmin-session:valid",e.sessChanged(),e)},onModelChange:function(e){var t=this;if(!(this.trackChanges&&e instanceof l.Node.Model))return!0;var i=t.objFindInSession(e,"added");return i>=0?((t.handler||t).trigger("pgadmin-session:changed",t,e),!0):(i=t.objFindInSession(e,"changed"),"sessChanged"in e?i>=0?e.sessChanged()?((t.handler||t).trigger("pgadmin-session:changed",t,e),!0):(t.sessAttrs.changed.splice(i,1),(t.handler||t).trigger("pgadmin-session:changed",t,e),!0):(e.sessChanged()&&(t.sessAttrs.changed.push(e),(t.handler||t).trigger("pgadmin-session:changed",t,e)),!0):((t.handler||t).trigger("pgadmin-session:changed",t,e),i>=0||(t.sessAttrs.changed.push(e),!0)))},checkDuplicateWithModel:function(t){if(!("keys"in t)||e.isEmpty(t.keys))return!0;var i=this,n={},a={};e.each(t.keys,function(e){n[e]=t.get(e),e in t._previous_key_values?a[e]=t._previous_key_values[e]:a[e]=t.previous(e)}),t._previous_key_values={};var s=i.where(a);if(1==s.length){var l=s[0];i.clearInvalidSessionIfModelValid(l)}var o=i.where(n);if(0==o.length)i.clearInvalidSessionIfModelValid(t);else{if(1!=o.length){var r="Duplicate rows.";return setTimeout(function(){e.each(o,function(e){i.trigger("pgadmin-session:model:invalid",r,e,i.handler),e.trigger("pgadmin-session:model:duplicate",e,r)})},10),!1}i.clearInvalidSessionIfModelValid(t),i.clearInvalidSessionIfModelValid(o[0])}return!0},clearInvalidSessionIfModelValid:function(t){var i=t.errorModel.attributes,n=this.sessAttrs.invalid;t.trigger("pgadmin-session:model:unique",t),0==e.size(i)?delete n[t.cid]:n[t.cid]=i[Object.keys(i)[0]]}}),l.Events=e.extend({},a.Events),l}.apply(t,n))&&(e.exports=a)},267:function(e,t,i){"use strict";var n,a;n=[i(0),i(11),i(3),i(2),i(5),i(7)],void 0!==(a=function(e,t,i,n,a){return i=i||window.pgAdmin||{},i.Settings?i.Settings:(i.Settings={init:function(){this.initialized||(this.initialized=!0)},show:function(){t.confirm(n("Reset layout"),n("Are you sure you want to reset the current layout? This will cause the application to reload and any un-saved data will be lost."),function(){var t=e('<div id="reloading-indicator"></div>');e("body").append(t),e.ajax({url:a("settings.reset_layout"),type:"DELETE",async:!1,success:function(){e(window).unbind("unload"),window.onbeforeunload=null,location.reload(!0)},error:function(){}})},function(){})}},i.Settings)}.apply(t,n))&&(e.exports=a)},271:function(e,t,i){"use strict";var n,a;n=[i(1),i(0),i(10),i(3),i(4),i(2),i(20)],void 0!==(a=function(e,t,i,n,a,s,l){var o=window.wcDocker;return a.WizardPage=i.Model.extend({defaults:{id:void 0,page_title:void 0,view:void 0,html:void 0,image:void 0,disable_prev:!1,disable_next:!1,disable_cancel:!1,show_progress_bar:"",onLoad:function(){return!0},beforeNext:function(){return!0},onNext:function(){},onBefore:function(){},beforePrev:function(){return!0}}}),a.Wizard=i.View.extend({options:{title:"Wizard",image:"left_panel.png",curr_page:0,disable_next:!1,disable_prev:!1,disable_finish:!1,disable_cancel:!1,show_header_cancel_btn:!1,show_header_maximize_btn:!1,dialog_api:null,height:400,width:650,show_left_panel:!0,wizard_help:""},tmpl:e.template('    <div class="pgadmin-wizard" style="height: <%= this.options.height %>px;    width: <%= this.options.width %>px">      <div class="wizard-header wizard-badge">        <div class="row">          <div class="col-sm-10">              <h3><span id="main-title"><%= this.options.title %></span> -              <span id="step-title"><%= page_title %></span></h3>          </div>          <% if (this.options.show_header_cancel_btn) { %>            <div class="col-sm-2">              <button class="ajs-close wizard-cancel-event pull-right"                title="'+s("Close")+'></button>              <% if (this.options.show_header_maximize_btn) { %>                <button class="ajs-maximize wizard-maximize-event pull-right                  title="'+s("Maximize")+'"></button>              <% } %>            </div>          <% } %>        </div>      </div>      <div class="wizard-content col-sm-12">        <% if (this.options.show_left_panel) { %>          <div class="col-sm-3 wizard-left-panel">              <img src="<%= this.options.image %>"                alt="'+s("Left panel logo")+'"></div>        <% } %>        <div class="col-sm-<% if (this.options.show_left_panel) { %>9<% }          else { %>12<% } %> wizard-right-panel">          <% if ( typeof show_description !=  "undefined"){ %>            <div class="wizard-description">              <%= show_description %>            </div>          <% } %>          <div class="wizard-progress-bar"><% if (show_progress_bar) { %>            <p class="alert alert-info col-sm-12"><%= show_progress_bar %></p><% } %>          </div>          <div class="wizard-right-panel_content col-xs-12">          </div>        </div>      </div>      <div class="col-sm-12 pg-prop-status-bar" style="visibility:hidden">        <div class="media error-in-footer bg-red-1 border-red-2 font-red-3 text-14">          <div class="media-body media-middle">            <div class="alert-icon error-icon">              <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>            </div>            <div class="alert-text">            </div>            <div class="close-error-bar">              <a class="close-error">x</a>            </div>          </div>        </div>      </div>      <div class="footer col-sm-12">        <div class="row">          <div class="col-sm-4 wizard-buttons pull-left">            <button title = "'+s("Help for this dialog.")+'"              class="btn btn-default pull-left wizard-help" <%=this.options.wizard_help ? "" : "disabled" %>>              <span class="fa fa-lg fa-question"></span></button>          </div>          <div class="col-sm-8">            <div class="wizard-buttons">              <button class="btn btn-primary wizard-back" <%=this.options.disable_prev ? "disabled" : ""%>>                <i class="fa fa-backward"></i>'+s("Back")+'</button>              <button class="btn btn-primary wizard-next" <%=this.options.disable_next ? "disabled" : ""%>>                '+s("Next")+'                <i class="fa fa-forward"></i></button>              <button class="btn btn-danger wizard-cancel" <%=this.options.disable_cancel ? "disabled" : ""%>>                <i class="fa fa-lg fa-close"></i>'+s("Cancel")+'</button>              <button class="btn btn-primary wizard-finish" <%=this.options.disable_finish ? "disabled" : ""%>>                '+s("Finish")+"</button>            </div>          </div>        </div>      </div>    </div>"),events:{"click button.wizard-next":"nextPage","click button.wizard-back":"prevPage","click button.wizard-cancel":"onCancel","click button.wizard-cancel-event":"onCancel","click button.wizard-maximize-event":"onMaximize","click button.wizard-finish":"finishWizard","click button.wizard-help":"onDialogHelp","click a.close-error":"closeErrorMsg"},initialize:function(t){this.options=e.extend({},this.options,t.options),this.currPage=this.collection.at(this.options.curr_page).toJSON()},render:function(){var e=this,i=this.currPage;return this.options.disable_next=!!this.options.disable_next||this.evalASFunc(this.currPage.disable_next),this.options.disable_prev=!!this.options.disable_prev||this.evalASFunc(this.currPage.disable_prev),this.options.disable_cancel=!!this.currPage.canCancel||this.evalASFunc(this.currPage.disable_cancel),i.html?i.content=i.html:i.view&&(i.content=i.view.render().el),t(this.el).html(this.tmpl(i)),t(this.el).find(".wizard-right-panel_content").html(i.content),this.onLoad(),setTimeout(function(){var i=t(e.el);l.findAndSetFocus(i)},100),this},nextPage:function(){if(!this.beforeNext())return!1;var e=this.onNext();return e?(this.currPage=this.collection.get(e).toJSON(),this.options.curr_page=this.collection.indexOf(this.collection.get(e))):this.options.curr_page<this.collection.length-1&&(this.options.curr_page=this.options.curr_page+1,this.currPage=this.collection.at(this.options.curr_page).toJSON()),this.enableDisableNext(),this.enableDisablePrev(),this.render()},prevPage:function(){if(!this.beforePrev())return!1;var e=this.onPrev();return e?(this.currPage=this.collection.get(e).toJSON(),this.options.curr_page=this.collection.indexOf(this.collection.get(e))):this.options.curr_page>0&&(this.options.curr_page=this.options.curr_page-1,this.currPage=this.collection.at(this.options.curr_page).toJSON()),this.enableDisableNext(),this.enableDisablePrev(),this.render()},finishWizard:function(){return this.onFinish(),this.remove(),this.unbind(),delete this.$el,delete this.el,!0},enableDisableNext:function(e){void 0!==e?this.options.disable_next=e:this.options.curr_page>=this.collection.length-1?this.options.disable_next=!0:this.options.disable_next=!1},enableDisablePrev:function(e){void 0!==e?this.options.disable_prev=e:this.options.curr_page<=0?this.options.disable_prev=!0:this.options.disable_prev=!1},closeErrorMsg:function(){t(this.el).find(".pg-prop-status-bar .alert-text").empty(),t(this.el).find(".pg-prop-status-bar").css("visibility","hidden")},beforeNext:function(){return this.evalASFunc(this.currPage.beforeNext)},beforePrev:function(){return this.evalASFunc(this.currPage.beforePrev)},onPrev:function(){return this.evalASFunc(this.currPage.onPrev)},onNext:function(){return this.evalASFunc(this.currPage.onNext)},onLoad:function(){return this.evalASFunc(this.currPage.onLoad)},onFinish:function(){return!0},onCancel:function(){return this.$el.remove(),!0},onMaximize:function(){var e=this.options.dialog_api,t=this.$el.find(".wizard-maximize-event");e&&(e.isMaximized()?(t.removeClass("ajs-maximized"),e.restore()):(t.addClass("ajs-maximized "+t.attr("class")),e.maximize()))},evalASFunc:function(t,i){var n=this;return i=i||n.currPage,e.isFunction(t)?t.apply(i,[n]):t},onDialogHelp:function(){var e=a.docker.findPanels("pnl_online_help")[0];if(null==e){var i=a.docker.findPanels("properties")[0];a.docker.addPanel("pnl_online_help",o.DOCK.STACKED,i),e=a.docker.findPanels("pnl_online_help")[0]}var n=t(e).data("embeddedFrame");e.focus(),n.openURL(this.options.wizard_help)}}),a}.apply(t,n))&&(e.exports=a)},32:function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(3),i(10),i(19),i(15),i(17),i(75),i(25)],void 0!==(a=function(e,t,i,n,a,s,l,o){t.fn.select2.amd.define("select2/selectAllAdapter",["select2/utils","select2/dropdown","select2/dropdown/attachBody"],function(i,n,a){function s(){}return s.prototype.render=function(i){var n=this,a=i.call(this),s=t(['<button class="btn btn-xs btn-default" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-check-square-o"></i>','<span style="padding: 0px 5px;">',e("Select All"),"</span></button>"].join("")),l=t(['<button class="btn btn-xs btn-default" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-square-o"></i><span style="padding: 0px 5px;">',e("Unselect All"),"</span></button>"].join("")),o=t('<div style="padding: 3px 0px; background-color: #2C76B4; margin-bottom: 3px;">').append(s).append(l);return this.$element.prop("multiple")?(a.find(".select2-dropdown").prepend(o),s.on("click",function(){a.find(".select2-results__option[aria-selected=false]").each(function(){n.trigger("select",{data:t(this).data("data")})}),n.trigger("close")}),l.on("click",function(){a.find(".select2-results__option[aria-selected=true]").each(function(){n.trigger("unselect",{data:t(this).data("data")})}),n.trigger("close")}),a):a},i.Decorate(i.Decorate(n,a),s)});var r=s.NodeAjaxOptionsControl=s.Select2Control.extend({defaults:i.extend(s.Select2Control.prototype.defaults,{url:void 0,transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:"Select from the list",width:"style"}}),initialize:function(){s.Select2Control.prototype.initialize.apply(this,arguments);var e=this,a=e.field.get("url")||e.defaults.url,l=e.model.top||e.model;if(a){var o,r=this.field.get("schema_node"),d=this.field.get("node_info"),c=this.field.get("url_with_id")||!1,u=r.generate_url.apply(r,[null,a,this.field.get("node_data"),c,d]),p=this.field.get("cache_node");p=p&&n.Browser.Nodes[p]||r,o=this.field.has("cache_level")?this.field.get("cache_level"):p.cache_level(d,c);var h=p.cache(r.type+"#"+a,d,o);this.field.get("version_compatible")&&(i.isUndefined(h)||i.isNull(h))&&(l.trigger("pgadmin:view:fetching",l,e.field),t.ajax({async:!1,url:u,success:function(e){h=p.cache(r.type+"#"+a,d,o,e.data)},error:function(){l.trigger("pgadmin:view:fetch:error",l,e.field)}}),l.trigger("pgadmin:view:fetched",l,e.field)),h=h&&h.data||[];var f=this.field.get("transform")||e.defaults.transform;f&&i.isFunction(f)?e.field.set("options",f.bind(e,h)):e.field.set("options",h)}}}),d=function(e){if(!e.id)return e.text;var i=t(e.element).data("image");return i?t("<span></span>").append(t("<span></span>",{class:"wcTabIcon "+i})).append(t("<span></span>").text(e.text)):e.text},c=s.NodeListByIdControl=r.extend({controlClassName:"pgadmin-node-select form-control",defaults:i.extend({},r.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e){var t=this,n=t.field.get("schema_node"),a=[],s=t.field.get("filter")||function(){return!0};return s=s.bind(t),i.each(e,function(e){if(s(e)){var l=i.isFunction(n.node_label)?n.node_label.apply(n,[e,t.model,t]):e.label,o=i.isFunction(n.node_image)?n.node_image.apply(n,[e,t.model,t]):n.node_image||"icon-"+n.type;a.push({value:e._id,image:o,label:l})}}),a},select2:{allowClear:!0,placeholder:"Select from the list",width:"style",templateResult:d,templateSelection:d}})});s.NodeListByNameControl=c.extend({defaults:i.extend({},c.prototype.defaults,{transform:function(e){var t=this,n=t.field.get("schema_node"),a=[],s=t.field.get("filter")||function(){return!0};return s=s.bind(t),i.each(e,function(e){if(s(e)){var l=i.isFunction(n.node_label)?n.node_label.apply(n,[e,t.model,t]):e.label,o=i.isFunction(n.node_image)?n.node_image.apply(n,[e,t.model,t]):n.node_image||"icon-"+n.type;a.push({value:e.label,image:o,label:l})}}),a}})}),t.fn.pgMakeVisible=function(e){return this.each(function(){if(this&&t(this.length))for(var i,n=t(this);n&&n.length>0;)if(i=n.get(0).offsetTop+n.height(),n=n.parent(),function(e){return!!(e&&e.length>0)&&e.get(0).scrollHeight>e.height()}(n)&&n.scrollTop(i),n.hasClass(e))return})};var u=o.Extension.NodeAjaxOptionsCell=o.Extension.Select2Cell.extend({defaults:i.extend({},o.Extension.Select2Cell.prototype.defaults,{url:void 0,transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:"Select from the list",width:"style"},opt:{label:null,value:null,image:null,selected:!1}}),template:i.template('<option <% if (image) { %> data-image=<%= image %> <% } %> value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- label %></option>'),initialize:function(){o.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this.column.get("url")||this.defaults.url,a=i.has(this.column.attributes,"options_cached"),s=a&&this.column.get("options_cached");if(e&&!s){var l,r=this,d=this.model,c=this.column,u=d.top||d,p=c.get("schema_node"),h=c.get("node_info"),f=c.get("url_with_id")||!1,m=p.generate_url.apply(p,[null,e,c.get("node_data"),f,h]),g=c.get("cache_node");g=g&&n.Browser.Nodes[g]||p,l=c.has("cache_level")?c.get("cache_level"):g.cache_level(h,f);var v=g.cache(p.type+"#"+e,h,l);c.get("version_compatible")&&(i.isUndefined(v)||i.isNull(v))&&(u.trigger("pgadmin:view:fetching",d,c),t.ajax({async:!1,url:m,success:function(t){v=g.cache(p.type+"#"+e,h,l,t.data)},error:function(){u.trigger("pgadmin:view:fetch:error",d,c)}}),u.trigger("pgadmin:view:fetched",d,c)),v=v&&v.data||[];var b=c.get("transform")||r.defaults.transform;b&&i.isFunction(b)?c.set("options",b.bind(c,v)):c.set("options",v),a&&c.set("options_cached",!0)}}});return o.Extension.NodeListByIdCell=u.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:i.extend({},u.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e,t){var n=t||this,a=n.column.get("schema_node"),s=[],l=n.column.get("filter")||function(){return!0};return l=l.bind(n),i.each(e,function(e){if(l(e)){var t=i.isFunction(a.node_label)?a.node_label.apply(a,[e,n.model,n]):e.label,o=i.isFunction(a.node_image)?a.node_image.apply(a,[e,n.model,n]):a.node_image||"icon-"+a.type;s.push({value:e._id,image:o,label:t})}}),s},select2:{placeholder:"Select from the list",width:"style",templateResult:d,templateSelection:d}})}),o.Extension.NodeListByNameCell=u.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:i.extend({},u.prototype.defaults,{url:"nodes",filter:void 0,transform:function(e,t){var n=t||this,a=n.column.get("schema_node"),s=[],l=n.column.get("filter")||function(){return!0};return l=l.bind(n),i.each(e,function(e){if(l(e)){var t=i.isFunction(a.node_label)?a.node_label.apply(a,[e,n.model,n]):e.label,o=i.isFunction(a.node_image)?a.node_image.apply(a,[e,n.model,n]):a.node_image||"icon-"+a.type;s.push({value:e.label,image:o,label:t})}}),s},select2:{placeholder:"Select from the list",width:"style",templateResult:d,templateSelection:d}})}),o.Extension.MultiSelectAjaxCell=o.Extension.NodeAjaxOptionsCell.extend({defaults:i.extend({},u.prototype.defaults,{transform:void 0,url_with_id:!1,select2:{allowClear:!0,placeholder:"Select from the list",width:"style",multiple:!0},opt:{label:null,value:null,image:null,selected:!1}}),getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each(function(){e.push(t(this).attr("value"))}),e}}),s.MultiSelectAjaxControl=r.extend({defaults:i.extend({},r.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style"}})}),s}.apply(t,n))&&(e.exports=a)},397:function(e,t,i){"use strict";(function(e,t){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function n(e,i,n,a){return t.isUndefined(n)&&a.has_default_val?"<span class='pull-left disabled_cell'>[default]</span>":t.isUndefined(n)&&a.not_null||t.isUndefined(n)||null===n?"<span class='pull-left disabled_cell'>[null]</span>":null}function a(e,i,n,a){return t.isUndefined(n)&&a.has_default_val?"<span class='pull-right disabled_cell'>[default]</span>":t.isUndefined(n)&&a.not_null||t.isUndefined(n)||null===n?"<span class='pull-right disabled_cell'>[null]</span>":null}function s(a,s,l,o,r){var d=n(a,s,l,o,r);if(d)return d;if("object"!==(void 0===l?"undefined":i(l))||Array.isArray(l)){if(Array.isArray(l)){var c=[];return e.each(l,function(e,t){"object"===(void 0===t?"undefined":i(t))?c.push(JSON.stringify(t)):c.push(t)}),t.escape("["+c.join()+"]")}return t.escape(l)}return t.escape(JSON.stringify(l))}function l(e,i,n,s,l){var o=a(e,i,n,s,l);return o||"<span style='float:right'>"+t.escape(n)+"</span>"}function o(e,t,i,a,s){var l=n(e,t,i,a,s);return l||(i?"true":"false")}function r(e,i,a,s,l){var o=n(e,i,a,s,l);return o||t.escape(a)}function d(e,i,a,s,l){var o=n(e,i,a,s,l);return o||"<span class='pull-left disabled_cell'>["+t.escape(a)+"]</span>"}e.extend(!0,window,{Slick:{Formatters:{JsonString:s,Numbers:l,Checkmark:o,Text:r,Binary:d}}})}(e)}).call(t,i(0),i(1))},398:function(e,t,i){"use strict";(function(e,t){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function n(){return e("<div class='pg_text_editor' />")}function a(){return e("<textarea class='pg_textarea text-12' hidefocus rows=5'>")}function s(t){var i=e("<div class='pg_buttons' />"),n=t?"Cancel":"OK",a=t?"btn-danger":"btn-primary";return t&&e("<button class='btn btn-primary fa fa-lg fa-save long_text_editor pg-alertify-button'>Save</button>").appendTo(i),e("<button class='btn "+a+" fa fa-lg fa-times long_text_editor pg-alertify-button'>"+n+"</button>").appendTo(i),i}function l(t){return!(""!=(t=e.trim(t))&&("{"!=t.charAt(0)||"}"!=t.charAt(t.length-1)))}function o(e,i,n,a){var s=e.grid;if(i.is_row_copied){s.copied_rows||(s.copied_rows=[[]]);var l=s.getActiveCell(),o=l.row,r=l.cell,d=i[e.column.pos];d="number"===a?t.isEmpty(d)||d:d,i[e.column.field]=n,d&&t.isNull(n)&&(t.isUndefined(s.copied_rows[o])||t.isUndefined(s.copied_rows[o][r]))&&(i[e.column.field]=void 0,void 0==s.copied_rows[o]&&(s.copied_rows[o]=[]),s.copied_rows[o][r]=1)}else i[e.column.field]=n}function r(e,t){var i,n,a=t.parent().find("#datagrid"),s=a.height();e.top>s&&(i=e.bottom-s),n=i?e.top-i:e.top-7,e.top=n;var l=a.width(),o=t.width()+32;return o+=e.left,o>l&&(e.left-=o-l),e}function d(i){var d,c,u,p,h=this;this.init=function(){var t=e("body");c=n().appendTo(t),d=a().appendTo(c),u=s(!0).appendTo(c),u.find("button:first").on("click",this.save),u.find("button:last").on("click",this.cancel),d.bind("keydown",this.handleKeyDown),h.position(i.position),d.focus().select()},this.handleKeyDown=function(t){t.which==e.ui.keyCode.ENTER&&t.ctrlKey?h.save():t.which==e.ui.keyCode.ESCAPE?(t.preventDefault(),h.cancel()):t.which==e.ui.keyCode.TAB&&t.shiftKey?(t.preventDefault(),i.grid.navigatePrev()):t.which==e.ui.keyCode.TAB&&(t.preventDefault(),i.grid.navigateNext())},this.save=function(){i.commitChanges()},this.cancel=function(){d.val(p),i.cancelChanges()},this.hide=function(){c.hide()},this.show=function(){c.show()},this.position=function(e){r(e,c),c.css("top",e.top).css("left",e.left)},this.destroy=function(){c.remove()},this.focus=function(){d.focus()},this.loadValue=function(e){if(t.isUndefined(e[i.column.field])||t.isNull(e[i.column.field]))return void d.val(p="");i.column.is_array?(d.val(p=e[i.column.field]),d.select()):""===e[i.column.field]?d.val(p="''"):"''"===e[i.column.field]?d.val(p="\\'\\'"):'""'===e[i.column.field]?d.val(p='\\"\\"'):(d.val(p=e[i.column.field]),d.select())},this.serializeValue=function(){var t=d.val();return""===t?null:i.column.is_array?e.trim(t):"''"===t||'""'===t?"":"\\'\\'"===t?"''":'\\"\\"'===t?'""':t},this.applyValue=function(e,t){o(i,e,t,"text")},this.isValueChanged=function(){return(""!=d.val()||!t.isUndefined(p))&&(!(""==d.val()&&t.isNull(p))&&d.val()!==p)},this.validate=function(){if(i.column.validator){var e=i.column.validator(d.val());if(!e.valid)return e}return i.column.is_array&&!l(d.val())?{valid:!1,msg:"Array must start with '{' and end with '}'"}:{valid:!0,msg:null}},this.init()}function c(l){var d,c,u,p,h=this;this.init=function(){var t=e("body");c=n().appendTo(t),d=a().appendTo(c),u=s(!0).appendTo(c),u.find("button:first").on("click",this.save),u.find("button:last").on("click",this.cancel),d.bind("keydown",this.handleKeyDown),h.position(l.position),d.focus().select()},this.handleKeyDown=function(t){t.which==e.ui.keyCode.ENTER&&t.ctrlKey?h.save():t.which==e.ui.keyCode.ESCAPE?(t.preventDefault(),h.cancel()):t.which==e.ui.keyCode.TAB&&t.shiftKey?(t.preventDefault(),l.grid.navigatePrev()):t.which==e.ui.keyCode.TAB&&(t.preventDefault(),l.grid.navigateNext())},this.save=function(){l.commitChanges()},this.cancel=function(){d.val(p),l.cancelChanges()},this.hide=function(){c.hide()},this.show=function(){c.show()},this.position=function(e){r(e,c),c.css("top",e.top).css("left",e.left)},this.destroy=function(){c.remove()},this.focus=function(){d.focus()},this.loadValue=function(t){var n=p=t[l.column.field];if(n&&"object"===(void 0===n?"undefined":i(n))&&!Array.isArray(n))n=JSON.stringify(n,null,4);else if(Array.isArray(n)){var a=[];e.each(n,function(e,t){"object"===(void 0===t?"undefined":i(t))?a.push(JSON.stringify(t,null,4)):a.push(t)}),n="["+a.join()+"]"}d.val(n),d.select()},this.serializeValue=function(){return""===d.val()?null:d.val()},this.applyValue=function(e,t){o(l,e,t,"text")},this.isValueChanged=function(){return(""!=d.val()||!t.isUndefined(p))&&(!(""==d.val()&&t.isNull(p))&&d.val()!=p)},this.validate=function(){if(l.column.validator){var e=l.column.validator(d.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}function u(t){var i,l,o,d,c=this;this.init=function(){var r=e("body");l=n().appendTo(r),i=a().appendTo(l),o=s(!1).appendTo(l),o.find("button:first").on("click",this.cancel),i.bind("keydown",this.handleKeyDown),c.position(t.position),i.focus().select()},this.handleKeyDown=function(i){i.which==e.ui.keyCode.ENTER&&i.ctrlKey?c.cancel():i.which==e.ui.keyCode.ESCAPE?(i.preventDefault(),c.cancel()):i.which==e.ui.keyCode.TAB&&i.shiftKey?(c.cancel(),i.preventDefault(),t.grid.navigatePrev()):i.which==e.ui.keyCode.TAB&&(c.cancel(),i.preventDefault(),t.grid.navigateNext())},this.cancel=function(){i.val(d),t.cancelChanges()},this.hide=function(){l.hide()},this.show=function(){l.show()},this.position=function(e){r(e,l),l.css("top",e.top).css("left",e.left)},this.destroy=function(){l.remove()},this.focus=function(){i.focus()},this.loadValue=function(e){i.val(d=e[t.column.field]),i.select()},this.serializeValue=function(){return i.val()},this.applyValue=function(e,i){e[t.column.field]=i},this.isValueChanged=function(){return!(""==i.val()&&null==d)&&i.val()!=d},this.validate=function(){if(t.column.validator){var e=t.column.validator(i.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}function p(t){var l,o,d,c,u=this;this.init=function(){var i=e("body");o=n().appendTo(i),l=a().appendTo(o),d=s(!1).appendTo(o),d.find("button:first").on("click",this.cancel),l.bind("keydown",this.handleKeyDown),u.position(t.position),l.focus().select()},this.handleKeyDown=function(i){i.which==e.ui.keyCode.ENTER&&i.ctrlKey?u.cancel():i.which==e.ui.keyCode.ESCAPE?(i.preventDefault(),u.cancel()):i.which==e.ui.keyCode.TAB&&i.shiftKey?(u.cancel(),i.preventDefault(),t.grid.navigatePrev()):i.which==e.ui.keyCode.TAB&&(u.cancel(),i.preventDefault(),t.grid.navigateNext())},this.cancel=function(){l.val(c),t.cancelChanges()},this.hide=function(){o.hide()},this.show=function(){o.show()},this.position=function(e){r(e,o),o.css("top",e.top).css("left",e.left)},this.destroy=function(){o.remove()},this.focus=function(){l.focus()},this.loadValue=function(n){var a=c=n[t.column.field];if("object"!==(void 0===a?"undefined":i(a))||Array.isArray(a)){if(Array.isArray(a)){var s=[];e.each(a,function(e,t){"object"===(void 0===t?"undefined":i(t))?s.push(JSON.stringify(t,null,4)):s.push(t)}),a="["+s.join()+"]"}}else a=JSON.stringify(a,null,4);l.val(a),l.select()},this.serializeValue=function(){return l.val()},this.applyValue=function(e,i){e[t.column.field]=i},this.isValueChanged=function(){return!(""==l.val()&&null==c)&&l.val()!=c},this.validate=function(){if(t.column.validator){var e=t.column.validator(l.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}function h(t){var i,n;this.init=function(){i=e("<INPUT type=text class='editor-text' readonly/>").appendTo(t.container).bind("keydown.nav",function(t){t.keyCode!==e.ui.keyCode.LEFT&&t.keyCode!==e.ui.keyCode.RIGHT||t.stopImmediatePropagation()}).focus().select()},this.destroy=function(){i.remove()},this.focus=function(){i.focus()},this.getValue=function(){return i.val()},this.loadValue=function(e){var a=e[t.column.field];void 0===a&&void 0===a&&(a=""),n=a,i.val(n),i[0].defaultValue=n,i.select()},this.serializeValue=function(){return i.val()},this.applyValue=function(e,i){e[t.column.field]=i},this.isValueChanged=function(){return!(""==i.val()&&null==n)&&i.val()!=n},this.validate=function(){if(t.column.validator){var e=t.column.validator(i.val());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}function f(i){var n,a;this.init=function(){n=e("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus disabled>"),n.appendTo(i.container),n.focus()},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(e){a=e[i.column.pos],t.isNull(a)||t.isUndefined(a)?(n.prop("indeterminate",!0),n.data("checked",2)):(a=!!e[i.column.pos],a?(n.prop("checked",!0),n.data("checked",0)):(n.prop("checked",!1),n.data("checked",1)))},this.serializeValue=function(){return n.prop("indeterminate")?null:n.prop("checked")},this.applyValue=function(e,t){e[i.column.pos]=t},this.isValueChanged=function(){var e=n.data("checked");return!(2===e&&(null==a||void 0==a))&&e!==a},this.validate=function(){return{valid:!0,msg:null}},this.init()}function m(i){var n,a;this.init=function(){n=e("<INPUT type=text class='editor-text' />"),n.bind("keydown.nav",function(t){t.keyCode!==e.ui.keyCode.LEFT&&t.keyCode!==e.ui.keyCode.RIGHT||t.stopImmediatePropagation()}),n.appendTo(i.container),n.focus().select()},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(e){a=e[i.column.field],!i.column.is_array||t.isNull(a)||t.isUndefined(a)?n.val(a):n.val("{"+a.join()+"}"),n[0].defaultValue=a,n.select()},this.serializeValue=function(){var t=n.val();if(""===t)return null;if(i.column.is_array){var a=e.trim(t.slice(1,-1));if(""==a)return[];a=a.split(",");for(var s in a)""==a[s]&&(a[s]=null);return a}return t},this.applyValue=function(e,t){o(i,e,t,"number")},this.isValueChanged=function(){return(""!=n.val()||!t.isUndefined(a))&&(""==n.val()&&""==a||!(""==n.val()&&t.isNull(a))&&n.val()!=a)},this.validate=function(){var t=n.val();if(!i.column.is_array&&isNaN(t))return{valid:!1,msg:"Please enter a valid number"};if(i.column.validator){var a=i.column.validator(t);if(!a.valid)return a}if(i.column.is_array){if(!l(t))return{valid:!1,msg:"Array must start with '{' and end with '}'"};var s,o=e.trim(t.slice(1,-1));s=""==o?[]:o.split(",");for(var r in s)if(isNaN(s[r]))return{valid:!1,msg:"Please enter a valid numbers"}}return{valid:!0,msg:null}},this.init()}function g(i){var n,a,s,l;this.init=function(){n=e("<div class='multi-checkbox'><span class='check' hideFocus></span></div>"),n.appendTo(i.container),n.focus(),n.bind("click",function(){a=e(this);var t=["unchecked","partial","checked"],i=a.find(".check").data("state");i++,a.find(".check").removeClass("unchecked partial checked").addClass(t[i%t.length]).data("state",i%t.length)})},this.destroy=function(){n.remove()},this.focus=function(){n.focus()},this.loadValue=function(e){s=e[i.column.field],l=1,t.isNull(s)||t.isUndefined(s)?n.find(".check").data("state",1).addClass("partial"):(s=!!e[i.column.field],s?(n.find(".check").data("state",2).addClass("checked"),l=2):(n.find(".check").data("state",0).addClass("unchecked"),l=0))},this.serializeValue=function(){return 1==n.find(".check").data("state")?null:2==n.find(".check").data("state")},this.applyValue=function(e,t){e[i.column.field]=t},this.isValueChanged=function(){return n.find(".check").data("state")!==l},this.validate=function(){if(i.column.validator){var e=i.column.validator(this.serializeValue());if(!e.valid)return e}return{valid:!0,msg:null}},this.init()}e.extend(!0,window,{Slick:{Editors:{pgText:d,JsonText:c,CustomNumber:m,Checkbox:g,ReadOnlyText:h,ReadOnlyCheckbox:f,ReadOnlypgText:u,ReadOnlyJsonText:p}}})}(e)}).call(t,i(0),i(1))},4:function(e,t,i){"use strict";(function(n){var a,s;a=[i(2),i(5),i,i(0),i(1),i(8),i(144),i(3),i(11),i(23),i(145),i(62),i(44),i(21),i(266),i(261),i(262),i(146),i(214),i(263),i(264),i(215),i(25),i(6),i(31),i(147)],void 0!==(s=function(e,t,i,a,s,l,o,r,d,c,u,p){n=window.$=a;var h=window.wcDocker;a=a||n||window.$,o=o||window.Bootstrap;var f=c.default,m=r.Browser=r.Browser||{},g=e("Please select an object in the tree view."),v={};v[h.EVENT.VISIBILITY_CHANGED]=function(){if(this.isVisible()){var e=r.Browser,t=e.tree?e.tree.selected():void 0,i=t&&1==t.length?e.tree.itemData(t):void 0;if(i&&e.Nodes[i._type].callbacks.selected&&s.isFunction(e.Nodes[i._type].callbacks.selected))return e.Nodes[i._type].callbacks.selected.apply(e.Nodes[i._type],[t,i,e])}};var b=function(e){var t=JSON.parse(e).data;return t.length&&"column"!==t[0]._type&&"catalog_object_column"!==t[0]._type&&(t=t.sort(function(e,t){return r.natural_sort(e.label,t.label)})),s.each(t,function(e){e._label=e.label,e.label=s.escape(e.label)}),t},y=r.Browser.initializeBrowserTree=function(e){a("#tree").aciTree({ajax:{url:t("browser.nodes"),converters:{"text json":b}},ajaxHook:function(t,i){if(null!=t){var n=this.itemData(t),a=e.Nodes[n._type];a&&(i.url=a.generate_url(t,"children",n,!0))}},loaderDelay:100,show:{duration:75},hide:{duration:75},view:{duration:75},animateRoot:!0,unanimated:!1}),e.tree=a("#tree").aciTree("api")};return s.extend(r.Browser,{URL:t("browser.index"),docker:null,editor:null,tree:null,scripts:{},panels:{browser:new r.Browser.Panel({name:"browser",title:e("Browser"),showTitle:!0,isCloseable:!1,isPrivate:!0,icon:"fa fa-binoculars",content:'<div id="tree" class="aciTree"></div>'}),properties:new r.Browser.Panel({name:"properties",title:e("Properties"),icon:"fa fa-cogs",width:500,isCloseable:!1,isPrivate:!0,elContainer:!0,content:'<div class="obj_properties"><div class="alert alert-info pg-panel-message">'+g+"</div></div>",events:v,onCreate:function(e,t){t.addClass("pg-no-overflow")}}),statistics:new r.Browser.Panel({name:"statistics",title:e("Statistics"),icon:"fa fa-line-chart",width:500,isCloseable:!1,isPrivate:!0,content:'<div><div class="alert alert-info pg-panel-message pg-panel-statistics-message">'+g+'</div><div class="pg-panel-statistics-container hidden"></div></div>',events:v}),sql:new r.Browser.Panel({name:"sql",title:e("SQL"),icon:"fa fa-file-text-o",width:500,isCloseable:!1,isPrivate:!0,content:'<div class="sql_textarea"><textarea id="sql-textarea" name="sql-textarea"></textarea></div>'}),dependencies:new r.Browser.Panel({name:"dependencies",title:e("Dependencies"),icon:"fa fa-hand-o-up",width:500,isCloseable:!1,isPrivate:!0,content:'<div><div class="alert alert-info pg-panel-message pg-panel-depends-message">'+g+'</div><div class="pg-panel-depends-container hidden"></div></div>',events:v}),dependents:new r.Browser.Panel({name:"dependents",title:e("Dependents"),icon:"fa fa-hand-o-down",width:500,isCloseable:!1,isPrivate:!0,content:'<div><div class="alert alert-info pg-panel-message pg-panel-depends-message">'+g+'</div><div class="pg-panel-depends-container hidden"></div></div>',events:v})},frames:{},menus:{context:{},file:{},edit:{},object:{},management:{},tools:{},help:{}},add_panels:function(){var e=JSON.parse(m.panels_items);s.each(e,function(e){e.isIframe?m.frames[e.name]=new m.Frame({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,url:e.content}):m.panels[e.name]=new m.Panel({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,content:e.content?e.content:"",events:e.events?e.events:"",canHide:e.canHide?e.canHide:""})})},menu_categories:{create:{label:e("Create"),priority:1,above:!1,below:!0,single:!0}},register_script:function(e,t,i){var n=this.scripts;n[e]=s.isArray(n[e])?n[e]:[],n[e].push({name:t,path:i,loaded:!1})},buildDefaultLayout:function(){var e=this.docker.addPanel("browser",h.DOCK.LEFT),t=this.docker.addPanel("dashboard",h.DOCK.RIGHT,e);this.docker.addPanel("properties",h.DOCK.STACKED,t,{tabOrientation:h.TAB.TOP}),this.docker.addPanel("sql",h.DOCK.STACKED,t),this.docker.addPanel("statistics",h.DOCK.STACKED,t),this.docker.addPanel("dependencies",h.DOCK.STACKED,t),this.docker.addPanel("dependents",h.DOCK.STACKED,t)},enable_disable_menus:function(t){var i=this,n=a("#navbar-menu > ul").first(),l=n.find("li#mnu_obj > ul.dropdown-menu").first(),o=i.tree.itemData(t),d=function e(i){if(i instanceof r.Browser.MenuItem)i.update(o,t);else for(var n in i)e(i[n])};if(l.empty(),s.each([{m:"file",id:"#mnu_file"},{m:"edit",id:"#mnu_edit"},{m:"management",id:"#mnu_management"},{m:"tools",id:"#mnu_tools"},{m:"help",id:"#mnu_help"}],function(e){s.each(i.menus[e.m],function(e){d(e)})}),t&&i.menus.object&&i.menus.object[o._type])r.Browser.MenuCreator(l,i.menus.object[o._type],i.menu_categories,o,t);else{var c=r.Browser.MenuGroup(i.menu_categories.create,[{$el:a('<li class="menu-item disabled"><a href="#">'+e("No object selected")+"</a></li>"),priority:1,category:"create",update:function(){}}],!1);l.append(c.$el)}},save_current_layout:function(e){if(e.docker){var i=e.docker.save(),n={setting:"Browser/Layout",value:i};a.ajax({type:"POST",url:t("settings.store_bulk"),data:n})}},init:function(){var e=this;if(!e.initialized){if(e.initialized=!0,e.cache_preferences(),this.add_panels(),e.docker=new h("#dockerContainer",{allowContextMenu:!0,allowCollapse:!1,themePath:"../static/css/",theme:"webcabin.overrides.css"}),e.docker){s.each(e.panels,function(t,i){e.panels[i].load(e.docker)}),s.each(e.frames,function(t,i){e.frames[i].load(e.docker)});var i=m.utils.layout;if(""!=i)try{e.docker.restore(i)}catch(t){e.docker.clear(),e.buildDefaultLayout()}else e.buildDefaultLayout();s.each(e.panels,function(t){t.panel&&(t.panel.on(h.EVENT.ATTACHED,function(){e.save_current_layout(e)}),t.panel.on(h.EVENT.DETACHED,function(){e.save_current_layout(e)}),t.panel.on(h.EVENT.MOVE_ENDED,function(){e.save_current_layout(e)}))})}e.editor=f.fromTextArea(document.getElementById("sql-textarea"),{lineNumbers:!0,mode:"text/x-pgsql",readOnly:!0,extraKeys:r.Browser.editor_shortcut_keys,tabSize:r.Browser.editor_options.tabSize,lineWrapping:r.Browser.editor_options.wrapCode,autoCloseBrackets:r.Browser.editor_options.insert_pair_brackets,matchBrackets:r.Browser.editor_options.brace_matching}),setTimeout(function(){e.editor.setValue("-- "+g),e.editor.refresh()},10),y(e),a("#tree").contextMenu({selector:".aciTreeLine",autoHide:!1,build:function(t){var i=e.tree.itemFrom(t),n=e.tree.itemData(i),s=e.menus.context[n._type],l=a("<div></div>"),o={};return r.Browser.MenuCreator(l,s,e.menu_categories,n,i,o),{autoHide:!1,items:o}},events:{hide:function(){e.keyboardNavigation.bindLeftTree()}}}),a("#tree").on("acitree",function(t,i,n,a,l){var o,r=n?e.tree.itemData(n):null;if(r&&e.Nodes[r._type]){if(o=e.Nodes[r._type],s.isObject(o.callbacks)&&a in o.callbacks&&"function"==typeof o.callbacks[a]&&!o.callbacks[a].apply(o,[n,r,e,l,a]))return!1;try{o.trigger("browser-node."+a,o,n,r)}catch(e){}}try{e.Events.trigger("pgadmin-browser:tree",a,n,r),e.Events.trigger("pgadmin-browser:tree:"+a,n,r,o)}catch(e){}return!0}),m.utils.registerScripts(this),m.utils.addMenus(e),setInterval(function(){a.ajax({url:t("misc.ping"),type:"POST",success:function(){},error:function(){}})},3e5),e.Events.on("pgadmin:browser:tree:add",e.onAddTreeNode,e),e.Events.on("pgadmin:browser:tree:update",e.onUpdateTreeNode,e),e.Events.on("pgadmin:browser:tree:refresh",e.onRefreshTreeNode,e)}},add_menu_category:function(e,t,i,n,a,s,l){this.menu_categories[e]={label:t,priority:i,icon:n,above:!0===a,below:!0===s,single:l}},preferences_cache:{},add_menus:function(e){var t=this,i=this.menus,n=r.Browser.MenuItem;s.each(e,function(e){s.each(e.applies,function(l){if(a.inArray(l,["context","file","edit","object","management","tools","help"])>=0){var o;if(!u(t,e.node))return;if(s.has(e,"module")&&!s.isUndefined(e.module)&&!u(t,e.module.type))return;i[l]=i[l]||{},o=s.isString(e.node)?i[l][e.node]=i[l][e.node]||{}:s.isString(e.category)?i[l][e.category]=i[l][e.category]||{}:i[l],s.has(o,e.name)||(o[e.name]=new n({name:e.name,label:e.label,module:e.module,category:e.category,callback:e.callback,priority:e.priority,data:e.data,url:e.url||"#",target:e.target,icon:e.icon,enable:""==e.enable||(!s.isString(e.enable)||"false"!=e.enable.toLowerCase())&&e.enable,node:e.node}))}})})},create_menus:function(){var e=a("#navbar-menu > ul").first(),t=this;s.each([{menu:"file",id:"#mnu_file"},{menu:"edit",id:"#mnu_edit"},{menu:"management",id:"#mnu_management"},{menu:"tools",id:"#mnu_tools"},{menu:"help",id:"#mnu_help"}],function(i){var n=e.children(i.id).first(),a=n.children(".dropdown-menu").first();a.empty(),r.Browser.MenuCreator(a,t.menus[i.menu],t.menu_categories)&&n.removeClass("hide")}),e.children("#mnu_obj").removeClass("hide"),t.enable_disable_menus()},showHelp:function(e,t,i,n,s){var o,r;if("object_help"==e){var d=this.docker.findPanels("pnl_sql_help")[0];null==d&&(r=this.docker.findPanels("properties")[0],this.docker.addPanel("pnl_sql_help",h.DOCK.STACKED,r),d=this.docker.findPanels("pnl_sql_help")[0]);var c=i.getTreeNodeHierarchy(n).server,u=m.utils.pg_help_path;"ppas"==c.server_type&&(u=m.utils.edbas_help_path);var p=Math.floor(c.version/1e4),f=Math.floor(c.version/100)-100*p;u=u.replace("$VERSION$",p+"."+f),l(u).endsWith("/")||(u+="/");var g=u+t;o=a(d).data("embeddedFrame"),d.title("Help: "+s),d.focus(),o.openURL(g)}else if("dialog_help"==e)if(this.docker){var v=this.docker.findPanels("pnl_online_help")[0];null==v&&(r=this.docker.findPanels("properties")[0],this.docker.addPanel("pnl_online_help",h.DOCK.STACKED,r),v=this.docker.findPanels("pnl_online_help")[0]),o=a(v).data("embeddedFrame"),v.focus(),o.openURL(t)}else window.open(t,"_blank")},get_preference:function(e,t){var i=this;if(0!=s.size(i.preferences_cache))return s.findWhere(i.preferences_cache,{module:e,name:t});var n=function(){if(s.size(i.preferences_cache)>0)return clearInterval(a),s.findWhere(i.preferences_cache,{module:e,name:t})},a=setInterval(n,1e3)},cache_preferences:function(){var i=this;a.ajax({url:t("preferences.get_all"),success:function(e){i.preferences_cache=e,m.keyboardNavigation.init(),p.modifyAcitreeAnimation(i),p.modifyAlertifyAnimation(i)},error:function(t){try{var i=a.parseJSON(t.responseText);d.alert(e("Preference loading failed."),i.errormsg)}catch(e){}}})},_findTreeChildNode:function(e,t,i){var n=i.t.wasLoad(e),a=function(){for(var n,a,l,o=i.t.children(e),r=0,d=o.length;r<d;r++)if(n=o.eq(r),a=i.t.itemData(n),a._type===t._type){if(!i.hasId||a._id==t._id)return i.i=n,i.d=t,i.pathOfTreeItems.push({coll:!1,item:n,d:t}),void i.success()}else if((l=i.b.Nodes[a._type])&&l.collection_node&&a.nodes&&-1!=s.indexOf(a.nodes,t._type))return i.i=n,i.d=null,i.pathOfTreeItems.push({coll:!0,item:n,d:a}),i.t.isInode(n)||(i.load=!1),void i.b._findTreeChildNode(n,t,i);i.notFound&&"function"==typeof i.notFound&&i.notFound(t)};!n&&i.load?i.t.open(e,{success:a,unanimated:!0,fail:function(){var e=i&&i.o&&i.o.fail;e&&"function"==typeof e&&e.apply(i.t,[])}}):n?a():i.notFound&&"function"==typeof i.notFound&&i.notFound(t)},onAddTreeNode:function(e,t,i){var n={b:this,d:null,hasId:!0,i:null,p:s.toArray(t||{}).sort(function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1}),pathOfTreeItems:[],t:this.tree,o:i},l=function(){var t,i=this;return i.success=l,i.p.length&&(t=i.p.shift(),i.p.length||(t._id=e._pid,i.success=o),i.b._findTreeChildNode(i.i,t,i),e._pid||o.apply(i,arguments)),!0}.bind(n),o=function(){var t=this,i=(t.i||this.t.wasLoad(t.i))&&this.t.first(t.i),n=function(t,i){var n=this;n.success=t,n.notFound=i,n.b._findTreeChildNode(n.i,e,n)}.bind(t),s=function(){this.t.openPath(this.i),this.t.select(this.i),t.o&&t.o.success&&"function"==typeof t.o.success&&t.o.success.apply(t.t,[t.i,e])}.bind(t),l=function(){var t,i=this,n=i.t.children(i.i),s=0,l=n.length-1,o=function(){for(;l>=s;){t=n.eq(s);var a=i.t.itemData(t);if(1==r.natural_sort(a._label,e._label))return!0;s++}return l!=n.length-1?(t=n.eq(l),!0):(t=null,!1)};if(function(){for(var a,d,c;l-s>22;){if(t=n.eq(s),a=i.t.itemData(t),-1!=r.natural_sort(a._label,e._label))return!0;if(t=n.eq(l),a=i.t.itemData(t),1!=r.natural_sort(a._label,e._label))return!0;if(d=s+Math.round((l-s)/2),t=n.eq(d),a=i.t.itemData(t),0==(c=r.natural_sort(a._label,e._label)))return!0;-1==c?(s=d+1,l--):(s++,l=d-1)}return o()}())i.t.before(t,{itemData:e,success:function(){i.o&&i.o.success&&"function"==typeof i.o.success&&i.o.success.apply(i.t,[t,e])},fail:function(){i.o&&i.o.fail&&"function"==typeof i.o.fail&&i.o.fail.apply(i.t,[t,e])}});else{var d=function(){var t=this,i=t.t.wasLoad(t.i),n=t.t.itemData(t.i);t.t.append(t.i,{itemData:e,success:function(s,l){var o=a(l.items[0]);i&&n&&n._type.search(e._type)>-1?(t.t.openPath(o),t.t.select(o)):n&&t.t.unload(t.i,{success:function(e){t.t.open(e)}}),t.o&&t.o.success&&"function"==typeof t.o.success&&t.o.success.apply(t.t,[o,e])},fail:function(){t.o&&t.o.fail&&"function"==typeof t.o.fail&&t.o.fail.apply(t.t,[t.i,e])}})}.bind(i);i.i&&!i.t.isInode(i.i)?i.t.setInode(i.i,{success:d}):d()}}.bind(t);if(!i&&t.t.wasLoad(t.i))return void t.t.unload(t.i,{success:function(){n(s,function(){var t=this&&this.o;t&&t.fail&&"function"==typeof t.fail&&t.fail.apply(this.t,[this.i,e])}.bind(this))}.bind(this),fail:function(){var t=this&&this.o;t&&t.fail&&"function"==typeof t.fail&&t.fail.apply(this.t,[this.i,e])}.bind(this)});n(s,l)}.bind(n);n.t.wasInit()&&e&&(e._label=e.label,e.label=s.escape(e.label),l())},onUpdateTreeNode:function(e,t,i,n){var l={b:this,d:null,i:null,hasId:!0,p:s.toArray(i||{}).sort(function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1}),pathOfTreeItems:[],t:this.tree,o:n,load:!0,old:e,new:t,op:null},o=function(){var i=this.o&&this.o.fail;i&&"function"==typeof i&&i.apply(this.t,[this.i,t,e])}.bind(l),d=function(){var e=this,t=this.pathOfTreeItems,i=function(){if(t.length){t.pop();var e=t.length;this.i=e&&t[e-1].item||null,this.d=e&&t[e-1].d||null,e&&t[e-1].coll&&(t.pop(),e=t.length,this.i=e&&t[e-1].item||null,this.d=e&&t[e-1].d||null)}else this.i=null,this.d=null}.bind(this),n=this.i&&this.t.hasParent(this.i)&&this.t.parent(this.i)||null,r=n?this.t.hasParent(n)&&this.t.parent(n):null;if(this.i&&this.d&&this.old._id==this.d._id&&this.old._type==this.d._type){var d=this.t.parent(this.i)||null;if(0==d.length&&"UPDATE"==l.op)u();else{var c=function(){if(!n||r){var t=this.d;return i(),void(this.i?(this.load=!0,this.success=function(){h()}.bind(this),this.notFound=o,this.b._findTreeChildNode(this.i,{_id:this.new._pid,_type:t._type},this)):h())}var l=null,d=this.t.siblings(this.i)||[];if(d.push(this.i[0]),s.each(d,function(t){var i=e.t.itemData(a(t));i._id==e.new._pid&&(l=t,e.pathOfTreeItems.push({coll:!0,item:l,d:i}))}),l){this.load=!0,this.success=function(){h()}.bind(this),this.notFound=o,l=a(l);var c=this.t.wasLoad(l),u=function(){e.i=l,e.d=e.d,e.pathOfTreeItems.push({coll:!1,item:l,d:e.d}),e.success()};!c&&e.load?e.t.open(l,{success:u,unanimated:!0,fail:function(){var t=e&&e.o&&e.o.fail;t&&"function"==typeof t&&t.apply(e.t,[])}}):u()}}.bind(this);this.t.remove(this.i,{success:function(){return i(),n&&!r&&d&&0==e.t.children(d).length?e.t.setInode(d,{success:function(){e.t.unload(d,{success:function(){setTimeout(c)}})}}):setTimeout(c),!0}})}}o()}.bind(l),c=function(e){var t=function(){var e=this.pathOfTreeItems;if(e.length){e.pop();var t=e.length;this.i=t&&e[t-1].item||null,this.d=t&&e[t-1].d||null,t&&e[t-1].coll&&(e.pop(),t=e.length,this.i=t&&e[t-1].item||null,this.d=t&&e[t-1].d||null)}else this.i=null,this.d=null}.bind(this);this.i?(this.load=!0,this.success=function(){h()}.bind(this),e._type==this.old._type&&(t(),e=this.d,t()),e=this.new._pid,this.notFound=o,this.b._findTreeChildNode(this.i,e,this)):h()}.bind(l),u=function(){if(this.i&&this.d&&this.new._type==this.d._type){var i=this,n=this.d._id;if(this.new._id!=this.d._id){this.t.itemData(l.i)._id=n=this.new._id}this.new._id==n&&(s.extend(this.d,{_id:this.new._id,_label:this.new._label,label:this.new.label}),this.t.setLabel(l.i,{label:this.new.label}),this.t.addIcon(l.i,{icon:this.new.icon}),this.t.setId(l.i,{id:this.new.id}),this.t.openPath(this.i),this.t.deselect(this.i),setTimeout(function(){i.t.select(i.i)},10))}var a=this.o&&this.o.success;a&&"function"==typeof a&&a.apply(this.t,[this.i,e,t])}.bind(l),p=function(){var e,t=this;return t.success=p,t.p.length?(e=t.p.shift(),t.p.length||("RECREATE"==t.op?(t.load=!1,t.success=d,t.notFound=c):(t.success=u,t.notFound=o)),t.b._findTreeChildNode(t.i,e,t)):1==t.p.length&&(t.notFound=c),!0}.bind(l),h=function(){var i=this,n=(i.i||this.t.wasLoad(i.i))&&this.t.first(i.i),s=function(e,i){var n=this;n.success=e,n.notFound=i,n.b._findTreeChildNode(n.i,t,n)}.bind(i),l=function(){this.t.openPath(this.i),this.t.select(this.i),i.o&&i.o.success&&"function"==typeof i.o.success&&i.o.success.apply(i.t,[i.i,t])}.bind(i),o=function(){var i,n=this,s=n.t.children(n.i),l=0,o=s.length-1,d=function(){for(;o>=l;){i=s.eq(l);var e=n.t.itemData(i);if(1==r.natural_sort(e._label,t._label))return!0;l++}return o!=s.length-1?(i=s.eq(o),!0):(i=null,!1)};if(function(){for(;o-l>22;){i=s.eq(l);var e=n.t.itemData(i);if(-1!=r.natural_sort(e._label,t._label))return!0;if(i=s.eq(o),e=n.t.itemData(i),1!=r.natural_sort(e._label,t._label))return!0;var a=l+Math.round((o-l)/2);i=s.eq(a),e=n.t.itemData(i);var c=r.natural_sort(e._label,t._label);if(0==c)return!0;-1==c?(l=a+1,o--):(l++,o=a-1)}return d()}())n.t.before(i,{itemData:t,success:function(){var s=a(arguments[1].items[0]);n.t.openPath(s),n.t.select(s),n.o&&n.o.success&&"function"==typeof n.o.success&&n.o.success.apply(n.t,[i,e,t])},fail:function(){n.o&&n.o.fail&&"function"==typeof n.o.fail&&n.o.fail.apply(n.t,[i,e,t])}});else{var c=function(){n.t.append(n.i,{itemData:t,success:function(){var i=a(arguments[1].items[0]);n.t.openPath(i),n.t.select(i),n.o&&n.o.success&&"function"==typeof n.o.success&&n.o.success.apply(n.t,[n.i,e,t])},fail:function(){n.o&&n.o.fail&&"function"==typeof n.o.fail&&n.o.fail.apply(n.t,[n.i,e,t])}})};n.i&&!n.t.isInode(n.i)?n.t.setInode(n.i,{success:c}):c()}}.bind(i);if(!n&&i.t.wasLoad(i.i))return void i.t.unload(i.i,{success:function(){s(l,function(){var i=this&&this.o;i&&i.fail&&"function"==typeof i.fail&&i.fail.apply(this.t,[this.i,e,t])}.bind(this))}.bind(this),fail:function(){var i=this&&this.o;i&&i.fail&&"function"==typeof i.fail&&i.fail.apply(this.t,[this.i,e,t])}.bind(this)});s(l,o)}.bind(l);l.t.wasInit()&&t&&e&&(l.pathOfTreeItems.push(e),t._label=t.label,t.label=s.escape(t.label),l.b.Nodes[t._type].is_collection&&"collection_count"in e&&e.collection_count>0&&(t.label=s.escape(t._label)+" <span>("+e.collection_count+")</span>"),"server"!=e._type||"server"!=t._type||e._pid==t._pid&&e._label==t._label&&e.icon==t.icon?e._pid!=t._pid||e._label!=t._label?(l.op="RECREATE",p()):(l.op="UPDATE",p()):(l.op="RECREATE",p()))},onRefreshTreeNode:function(t,i){var n,l=t&&this.tree.itemData(t),o=l&&l._type&&this.Nodes[l._type],r={b:this,d:l,i:t,p:null,pathOfTreeItems:[],t:this.tree,o:i},c=-1;if(o?n=this.tree.isInode(t)&&this.tree.isOpen(t):(t=null,r.i=null,r.d=null),r.branch=r.t.serialize(t,{},function(e,t,i){if(!++c||i.inode&&i.open)return{_id:i._id,_type:i._type,branch:i.branch,open:i.open}}),!o)return void r.t.destroy({success:function(){y(r.b),r.t=r.b.tree,r.i=null,r.b._refreshNode(r,r.branch)},error:function(){var e=i.o&&i.o.fail||i.fail;"function"==typeof e&&e()}});var u=function(t,i,n){var l=n.getTreeNodeHierarchy(t),o=n.generate_url(t,"nodes",i,!0);a.ajax({url:o,type:"GET",cache:!1,dataType:"json",success:function(e){var t=e.result||e.data;t._label=t.label,t.label=s.escape(t.label);var a=r.t.itemData(r.i);if(s.extend(a,t),r.t.setLabel(r.i,{label:i.label}),r.t.addIcon(r.i,{icon:i.icon}),r.t.setId(r.i,{id:i.id}),r.t.setInode(r.i,{inode:t.inode}),n.can_expand&&"function"==typeof n.can_expand&&!n.can_expand(a))return void r.t.unload(r.i);r.b._refreshNode(r,r.branch);var l=r.o&&r.o.success||r.success;l&&"function"==typeof l&&l()},error:function(i,n,s){if(!d.pgHandleItemError(i,n,s,{item:t,info:l})){var o=i.getResponseHeader("Content-Type"),c=o&&0==o.indexOf("application/json")&&a.parseJSON(i.responseText)||{};if(410==i.status&&0==c.success){var u=r.t.parent(r.i);r.t.remove(r.i,{success:function(){if(u)try{m.Events.trigger("pgadmin:browser:tree:refresh",u)}catch(e){}}})}d.pgNotifier(n,i,e("Error retrieving details for the node."),function(){})}}})}.bind(this);if(o&&o.collection_node){var p=r.i=this.tree.parent(t),h=function(){this.tree.unload(t,{success:function(){t=p,l=r.d=r.t.itemData(r.i),o=r.b.Nodes[l._type],t=p,u(t,l,o)},fail:function(){}})}.bind(this);this.tree.isInode(t)?h():this.tree.setInode(t,{success:h})}else n?this.tree.unload(t,{success:u.bind(this,t,l,o),fail:function(){}}):!this.tree.isInode(t)&&l.inode?this.tree.setInode(t,{success:u.bind(this,t,l,o),fail:function(){}}):u(t,l,o)},removeChildTreeNodesById:function(e,t,i){var n=m.tree;if(e&&t){var a,s,l=n.children(e),o=0,r=l.length;for(e=null;o<r;o++)if(a=l.eq(o),s=n.itemData(a),s._type==t){e=a;break}}if(e){for(l=n.children(e),o=0,r=l.length;o<r;o++)a=l.eq(o),s=n.itemData(a),-1!=i.indexOf(s._id)&&m.removeTreeNode(a,!1,e);return!0}return!1},removeTreeNode:function(e,t,i){var n=m.tree,a=null;return!!e&&(t&&(a=n.next(e),a&&a.length||(a=n.prev(e))&&a.length||(a=i||n.parent(e)),a&&n.select(a)),n.remove(e),!0)},findSiblingTreeNode:function(e,t){for(var i,n,a=m.tree,s=a.parent(e),l=a.children(s),o=0;o<l.length;o++)if(n=l.eq(o),(i=a.itemData(n))&&i._id==t)return n;return null},findParentTreeNodeByType:function(e,t){var i,n=m.tree,a=e;do{if((i=n.itemData(a))&&i._type==t)return a;a=n.hasParent(a)?n.parent(a):null}while(a);return null},findChildCollectionTreeNode:function(e,t){var i,n=m.tree,a=0,s=e,l=e&&n.children(e);if(!l||!l.length)return null;for(;a<l.length;a++)if(s=l.eq(a),(i=n.itemData(s))&&i._type==t)return s;return null},addChildTreeNodes:function(e,t,i,n,l){var o=i in m.Nodes&&m.Nodes[i],r=n.length&&s.extend({},s.mapObject(e,function(e){return e.priority-=1,e})),c=[];o&&(m.tree.wasLoad(t)||m.tree.isLeaf(t)?function e(t){if(!n.length)return void(t&&t());var s,l={_id:n.pop(),_type:i,priority:0};r[i]=l,s=o.generate_url(null,"nodes",l,!0,r),a.ajax({url:s,dataType:"json",success:function(i){i.success&&c.push(i.data),e(t)},error:function(i){try{var n=a.parseJSON(i.responseText);0==n.success&&d.error(n.errormsg)}catch(e){}e(t)}})}(function(){s.each(c,function(t){m.Events.trigger("pgadmin:browser:tree:add",t,e)}),l&&l()}):l&&l())},_refreshNode:function(e,t){var i=function(e){for(var t,i,n=this,a=0,s=e.branch&&e.branch.length||0;a<s;a++){i=e.branch[a];var l=n.b.Nodes[i._type];t={b:n.b,t:n.t,pathOfTreeItems:[],i:n.i,d:i,select:n.select,hasId:l&&!l.collection_node,o:n.o,load:!0},t.success=function(){this.b._refreshNode.call(this.b,this,this.d)}.bind(t),function(e,t,i){setTimeout(function(){i.b._findTreeChildNode(e,t,i)},0)}(n.i,i,t)}}.bind(e,t);t&&t.open&&(e.t.isOpen(e.i)?i():e.t.open(e.i,{unanimated:!0,success:i,fail:function(){}}))},editor_shortcut_keys:{"Ctrl-Space":"autocomplete","Cmd-Space":"autocomplete","Ctrl-A":"selectAll","Cmd-A":"selectAll","Ctrl-Y":"redo","Cmd-Y":"redo","Ctrl-Z":"undo","Cmd-Z":"undo","Ctrl-D":"deleteLine","Cmd-D":"deleteLine","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Alt-Left":"goGroupLeft","Cmd-Alt-Left":"goGroupLeft","Ctrl-Alt-Right":"goGroupRight","Cmd-Alt-Right":"goGroupRight","Shift-Tab":"indentLess"},editor_options:{tabSize:parseInt(m.utils.tabSize),wrapCode:m.utils.wrapCode,insert_pair_brackets:m.utils.insertPairBrackets,brace_matching:m.utils.braceMatching,indent_with_tabs:m.utils.is_indent_with_tabs}}),delete f.keyMap.emacsy["Ctrl-V"],"True"==m.utils.useSpaces&&(r.Browser.editor_shortcut_keys.Tab="insertSoftTab"),window.onbeforeunload=function(){var t=window.event,i=l(e("Are you sure you wish to close the %s browser?")).sprintf(m.utils.app_name).value();return t&&(t.returnValue=i),i},r.Browser}.apply(t,a))&&(e.exports=s)}).call(t,i(0))},6:function(e,t,i){"use strict";var n,a;n=[i(2),i(0),i(1),i(8),i(3),i(10),i(15),i(19),i(17),i(87),i(7),i(12),i(25)],void 0!==(a=function(e,t,i,n,a,s,l,o,r,d){var c=a.Browser=a.Browser||{};return c.Collection?c.Collection:(c.Collection=function(){},i.extend(c.Collection,i.clone(c.Node),{Init:function(){this.node_initialized||(this.node_initialized=!0,a.Browser.add_menus([{name:"refresh",node:this.type,module:this,applies:["object","context"],callback:"refresh",priority:1,label:e("Refresh..."),icon:"fa fa-refresh"}]),a.DataGrid&&a.unsupported_nodes&&-1==i.indexOf(a.unsupported_nodes,this.type)&&a.Browser.add_menus([{name:"show_query_tool",node:this.type,module:this,applies:["context"],callback:"show_query_tool",priority:998,label:e("Query Tool..."),icon:"fa fa-bolt"}]))},hasId:!1,is_collection:!0,collection_node:!0,hasCollectiveStatistics:!0,showProperties:function(a,s,d){var u=this,p=d.$container.find(".obj_properties").first(),h=p.data("obj-view"),f=t("<div></div>").addClass("pg-prop-content col-xs-12"),m=c.Nodes[u.node],g=this.generate_url(a,"properties",s),v=new(m.Collection.extend({url:g,model:m.model})),b=this.getTreeNodeHierarchy.apply(this,[a]),y=o.generateGridColumnsFromModel(b,m.model,"properties",u.columns),_=new r.Grid({columns:y.columns,collection:v,className:"backgrid table-bordered"}),C={remove:function(){this.grid&&(this.grid.collection&&(this.grid.collection.reset(null,{silent:!0}),delete this.grid.collection),delete this.grid,this.grid=null)},grid:_};if(h){if(i.isEqual(t(d).data("node-prop"),g))return;t(d).data("node-prop",g),p.data("obj-view",null)}p.empty(),p.data("obj-view",C),f.append(_.render().$el),p.append(f),v.fetch({reset:!0,error:function(t,i,s){c.Events.trigger("pgadmin:collection:retrieval:error","properties",t,i,s,a,u),l.pgHandleItemError(t,i,s,{item:a,info:b})||l.pgNotifier(i,t,n(e("Error retrieving properties - %s.")).sprintf(s||u.label).value(),function(){})}})},generate_url:function(e,t){var i={properties:"obj",children:"nodes"},n=this,s=function(e,t){return t!=n.type},l=this.getTreeNodeHierarchy(e),o=t in i?i[t]:t;return d.generate_url(a.Browser.URL,l,o,n.node,s)}}),c.Collection)}.apply(t,n))&&(e.exports=a)},7:function(e,t,i){"use strict";(function(n){var a,s;a=[i(2),i(1),i(8),i(0),i(10),i(19),i(17),i(14),i(245),i(12),i(75)],void 0!==(s=function(e,t,i,n,a,s,l,o){var r=window.pgAdmin=window.pgAdmin||{};r.editableCell=function(){if(this.attributes&&!t.isUndefined(this.attributes.disabled)&&!t.isNull(this.attributes.disabled)){if(t.isFunction(this.attributes.disabled))return!this.attributes.disabled.apply(this,arguments);if(t.isBoolean(this.attributes.disabled))return!this.attributes.disabled}},t.extend(s,{controlLabelClassName:"control-label pg-el-sm-3 pg-el-xs-12",controlsClassName:"pgadmin-controls pg-el-sm-9 pg-el-xs-12",groupClassName:"pgadmin-control-group form-group pg-el-xs-12",setGroupClassName:"set-group pg-el-xs-12",tabClassName:"backform-tab pg-el-xs-12",setGroupContentClassName:"fieldset-content pg-el-xs-12"}),s.controlMapper={int:["uneditable-input","numeric","integer"],text:["uneditable-input","input","string"],numeric:["uneditable-input","numeric","numeric"],date:"datepicker",datetime:"datetimepicker",boolean:"boolean",options:["readonly-option","select",l.Extension.PGSelectCell],multiline:["textarea","textarea","string"],collection:["sub-node-collection","sub-node-collection","string"],uniqueColCollection:["unique-col-collection","unique-col-collection","string"],switch:"switch",select2:"select2",note:"note",color:"color"},s.getMappedControl=function(e,i){if(e in s.controlMapper){var n=s.controlMapper[e];if(!t.isArray(n))return n;var a=1,l=t.size(n);switch(i){case"properties":a=0;break;case"edit":case"create":case"control":a=1;break;case"cell":a=2;break;default:a=0}return n[a>l?0:a]}return e};var d=s.Control.prototype.initialize,c=s.Control.prototype.remove;t.extend(s.Control.prototype,{defaults:t.extend(s.Control.prototype.defaults,{helpMessage:null}),initialize:function(){d.apply(this,arguments);var e=this.field.get("deps"),i=this;e&&t.isArray(e)&&t.each(e,function(e){var t=e.split("."),n=t.shift();i.listenTo(i.model,"change:"+n,i.render)})},remove:function(){var e=this,i=e.field.get("deps");e.stopListening(e.model,"change:"+name,e.render),e.stopListening(e.model.errorModel,"change:"+name,e.updateInvalid),i&&t.isArray(i)&&t.each(i,function(t){var i=t.split("."),n=i.shift();e.stopListening(e.model,"change:"+n,e.render)}),this.cleanup&&this.cleanup.apply(this),c?c.apply(e,arguments):a.View.prototype.remove.apply(e,arguments)},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <span class="<%=Backform.controlClassName%> uneditable-input" <%=disabled ? "disabled" : ""%>>',"    <%-value%>","  </span>","</div>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>"].join("\n")),clearInvalid:function(){return this.$el.removeClass(s.errorClassName),this.$el.find(".pgadmin-control-error-message").remove(),this},updateInvalid:function(){var e=this,i=this.model.errorModel;if(!(i instanceof a.Model))return this;this.clearInvalid(),this.$el.find(":input[name]").not("button").each(function(a,l){var o=e.keyPathAccessor(i.toJSON(),n(l).attr("name"));t.isEmpty(o)||e.$el.addClass(s.errorClassName)})},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),o=this.keyPathAccessor(i[a],l),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model)}),this.$el.removeClass(s.hiddenClassName),r.visible||this.$el.addClass(s.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),this.updateInvalid(),this}}),t.extend(s.InputControl.prototype,{events:{"change input":"onChange","blur input":"onChange","keyup input":"onKeyUp","focus input":"clearInvalid"},onKeyUp:function(e){this.key_timeout&&clearTimeout(this.key_timeout),this.keyup_timeout=setTimeout(function(){this.onChange(e)}.bind(this),400)}}),t.extend(s.TextareaControl.prototype,{defaults:t.extend(s.TextareaControl.prototype.defaults,{rows:5,helpMessage:null,maxlength:null}),events:{"change textarea":"onChange","keyup textarea":"onKeyUp","paste textarea":"onChange","selectionchange textarea":"onChange","focus textarea":"clearInvalid"},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"  <textarea ",'    class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>"',"  <% if (maxlength) { %>",'    maxlength="<%=maxlength%>"',"  <% } %>",'    placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%>','    rows=<%=rows ? rows : ""%>','    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onKeyUp:function(e){this.key_timeout&&clearTimeout(this.key_timeout),this.keyup_timeout=setTimeout(function(){this.onChange(e)}.bind(this),400)}}),s.SelectControl.prototype.render=function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),o=this.keyPathAccessor(i[a],l),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model)}),t.isFunction(r.options))try{r.options=r.options(this)}catch(e){r.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}return this.$el.removeClass(s.hiddenClassName),r.visible||this.$el.addClass(s.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),this.updateInvalid(),this},t.extend(s.SelectControl.prototype.defaults,{helpMessage:null}),s.ReadonlyOptionControl=s.SelectControl.extend({template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"<% for (var i=0; i < options.length; i++) { %>"," <% var option = options[i]; %>"," <% if (option.value === rawValue) { %>",' <span class="<%=Backform.controlClassName%> uneditable-input" disabled><%-option.label%></span>'," <% } %>","<% } %>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>"].join("\n")),events:{},getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("span").text(),this.model)}}),t.extend(s.RadioControl.prototype,{updateInvalid:function(){var e=this,i=this.model.errorModel;if(!(i instanceof a.Model))return this;this.clearInvalid(),this.$el.find(":input[name]").not("button").each(function(a,l){var o=e.keyPathAccessor(i.toJSON(),n(l).attr("name"));t.isEmpty(o)||e.$el.addClass(s.errorClassName).find('[type="radio"]').append(n("<div></div>").addClass("pgadmin-control-error-message pg-el-xs-offset-4 pg-el-xs-8 pg-el-xs-8 help-block").text(o))})}}),s.SwitchControl=s.InputControl.extend({defaults:{label:"",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"primary",size:"small"},extraClasses:[],helpMessage:null},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <div class="checkbox">',"    <label>",'      <input type="checkbox" class="<%=extraClasses.join(\' \')%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    </label>","  </div>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),getValueFromDOM:function(){return this.formatter.toRaw(this.$input.prop("checked"),this.model)},events:{"switchChange.bootstrapSwitch":"onChange"},render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),a=e.name.split("."),l=a.shift(),o=a.join("."),r=this.keyPathAccessor(i[l],o),d=t.defaults({disabled:function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e}(e.disabled,e,this.model)},this.field.get("options"),this.defaults.options,n.fn.bootstrapSwitch.defaults);return s.InputControl.prototype.render.apply(this,arguments),this.$input=this.$el.find("input[type=checkbox]").first(),this.$input.bootstrapSwitch(t.extend(d,{state:r})),this}}),s.Dialog=s.Form.extend({schema:void 0,tagName:"div",legend:!0,className:function(){return"pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-xs-12"},tabPanelClassName:function(){return s.tabClassName},tabIndex:0,initialize:function(e){var i=e.schema;i&&t.isArray(i)&&(this.schema=t.each(i,function(i){!i.fields||i.fields instanceof a.Collection||(i.fields=new s.Fields(i.fields)),i.cId=i.cId||t.uniqueId("pgC_"),i.hId=i.hId||t.uniqueId("pgH_"),i.disabled=i.disabled||!1,i.legend=e.legend}),e.tabPanelClassName&&t.isFunction(e.tabPanelClassName)&&(this.tabPanelClassName=e.tabPanelClassName)),this.model.errorModel=e.errorModel||this.model.errorModel||new a.Model,this.controls=[]},template:{header:t.template(['<li role="presentation" <%=disabled ? "disabled" : ""%>>',' <a data-toggle="tab" tabindex="-1" data-tab-index="<%=tabIndex%>" href="#<%=cId%>"','  id="<%=hId%>" aria-controls="<%=cId%>">',"<%=label%></a></li>"].join(" ")),panel:t.template('<div role="tabpanel" tabindex="-1" class="tab-pane <%=label%> pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-xs-12 fade" id="<%=cId%>" aria-labelledby="<%=hId%>"></div>')},render:function(){this.cleanup();var e=this.$el.children().first().children(".active").first().attr("id"),i=this.model,a=this.controls,s=this.template,l=this,o=100*this.tabIndex,r=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};this.$el.empty().attr("role","tabpanel").attr("class",t.result(this,"tabPanelClassName")),i.panelEl=this.$el;var d=n('<ul class="nav nav-tabs" role="tablist"></ul>').appendTo(this.$el),c=n('<ul class="tab-content pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-xs-12"></ul>').appendTo(this.$el);t.each(this.schema,function(e){if(o++,e.version_compatible&&r(e.visible,e,i)){var u=n(s.panel(t.extend(e,{tabIndex:o}))).appendTo(c).removeClass("collapse").addClass("collapse");n(s.header(e)).appendTo(d),e.fields.each(function(e){var t=new(e.get("control"))({field:e,model:i,dialog:l,tabIndex:o});u.append(t.render().$el),a.push(t)}),d.find('a[data-toggle="tab"]').off("shown.bs.tab").off("hidden.bs.tab").on("hidden.bs.tab",function(){l.hidden_tab=n(this).data("tabIndex")}).on("shown.bs.tab",function(){var e=this;e.shown_tab=n(e).data("tabIndex"),i.trigger("pg-property-tab-changed",{model:i,shown:e.shown_tab,hidden:e.hidden_tab,tab:e})})}});var u=d.find('[id="'+e+'"]').first();return 1==u.length?(u.parent().addClass("active"),c.find("#"+u.attr("aria-controls")).addClass("in active")):(d.find('[role="presentation"]').first().addClass("active"),c.find('[role="tabpanel"]').first().addClass("in active")),this},remove:function(e){e&&e.data&&(this.model&&(this.model.reset&&this.model.reset({validate:!1,silent:!0,stop:!0}),this.model.clear({validate:!1,silent:!0,stop:!0}),delete this.model),this.errorModel&&(this.errorModel.clear({validate:!1,silent:!0,stop:!0}),delete this.errorModel)),this.cleanup(),s.Form.prototype.remove.apply(this,arguments)}}),s.Fieldset=s.Dialog.extend({className:function(){return"set-group pg-el-xs-12"},tabPanelClassName:function(){return s.tabClassName},fieldsetClass:s.setGroupClassName,legendClass:"badge",contentClass:s.setGroupContentClassName+" collapse in",template:{header:t.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</fieldset>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:!0,render:function(){this.cleanup();var e=this.model,i=this.$el,a=this.template,s=this.controls,l={className:t.result(this,"className"),fieldsetClass:t.result(this,"fieldsetClass"),legendClass:t.result(this,"legendClass"),contentClass:t.result(this,"contentClass"),collapse:t.result(this,"collapse")},o=100*this.tabIndex,r=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return this.$el.empty(),t.each(this.schema,function(d){if(o++,d.version_compatible&&r(d.visible,d,e)&&d.fields){var c=t.extend({},l,d),u=n(a.header(c)).appendTo(i),p=n(a.content(c)).appendTo(u);d.fields.each(function(t){var i=new(t.get("control"))({field:t,model:e,tabIndex:o});p.append(i.render().$el),s.push(i)})}}),this},getValueFromDOM:function(){return""},events:{}}),s.generateGridColumnsFromModel=function(e,i,n,a,o){var r,d=s.generateViewSchema(e,i,n,o,!0,!0),c=[],u=[],p=0;if(t.isNull(a)||t.isUndefined(a))r=function(e){e.cell_priority=p,p+=1,!e.headerCell&&e.cellHeaderClasses&&(e.headerCell=l.Extension.CustomHeaderCell)};else if(t.isArray(a))r=function(e){e.cell_priority=t.indexOf(a,e.name),!e.headerCell&&e.cellHeaderClasses&&(e.headerCell=l.Extension.CustomHeaderCell)};else if(t.isObject(a)){var h=Object.keys(a);r=function(e){var i,n=e.name in a&&a[e.name];if(t.isNull(n)||t.isUndefined(n))return void(e.cell_priority=-1);t.isObject(n)&&("index"in n?(e.cell_priority=n.index,p=p>n.index?p+1:n.index):(i=t.indexOf(h,e.name),e.cell_priority=p=i>p?i:p,p+=1),e.headerCell||(e.cellHeaderClasses&&(e.headerCell=l.Extension.CustomHeaderCell),"class"in n&&t.isString(n.class)&&(e.headerCell=l.Extension.CustomHeaderCell,e.cellHeaderClasses=(e.cellHeaderClasses||"")+" "+n.class))),t.isString(n)&&(i=t.indexOf(h,e.name),e.cell_priority=p=i>p?i:p,p+=1,e.headerCell||(e.headerCell=l.Extension.CustomHeaderCell),e.cellHeaderClasses=(e.cellHeaderClasses||"")+" "+n)}}return t.each(d,function(e){t.each(e.fields,function(e){e.cell&&(r(e),-1!=e.cell_priority&&u.push(e))}),c.push(e)}),{columns:t.sortBy(u,function(e){return e.cell_priority}),schema:c}},s.UniqueColCollectionControl=s.Control.extend({initialize:function(){s.Control.prototype.initialize.apply(this,arguments);var e=this.field.get("uniqueCol")||[],i=this.field.get("model"),n=i.prototype.schema||i.__super__.schema,a=[],l=this;if(t.each(n,function(e){a.push(e.id)}),e.length>t.intersection(a,e).length){var o="Developer: Unique columns [ "+t.difference(e,a)+" ] not found in collection model [ "+a+" ].";alert(o)}var d=l.collection=l.model.get(l.field.get("name"));d||(d=l.collection=new r.Browser.Node.Collection(null,{model:l.field.get("model"),silent:!0,handler:l.model,top:l.model.top||l.model,attrName:l.field.get("name")}),l.model.set(l.field.get("name"),d,{silent:!0})),this.field.get("version_compatible")&&(l.listenTo(d,"add",l.collectionChanged),l.listenTo(d,"change",l.collectionChanged))},cleanup:function(){this.stopListening(this.collection,"change",this.collectionChanged),this.field.get("version_compatible")&&(this.stopListening(self.collection,"add",this.collectionChanged),this.stopListening(self.collection,"change",this.collectionChanged)),this.grid&&(this.grid.remove(),delete this.grid),this.$el.empty()},collectionChanged:function(e,i,a){var s=this.field.get("uniqueCol")||[],l=[],o=this;if(e.attributes&&(t.each(s,function(i){t.has(e.attributes,i)&&l.push(i)}),0!=l.length)){var r=this.model.get(this.field.get("name"));this.stopListening(r,"change",this.collectionChanged);var d=void 0,c=void 0;if(r.each(function(i){if(e!=i){var n=[];t.each(s,function(a){var s=e.get(a);t.isUndefined(s)||s!=i.get(a)||n.push(s)}),n.length==s.length&&(d=e,c=i)}}),d&&(a&&a.add?setTimeout(function(){r.remove(d)},0):d.set(l[0],d.previous(l[0])),c)){var u=r.indexOf(c);if(u>-1){var p=o.grid.body.rows[u].$el;p.addClass("new"),n(p).pgMakeVisible("backform-tab"),setTimeout(function(){p.removeClass("new")},3e3)}}this.listenTo(r,"change",this.collectionChanged)}},render:function(){this.undelegateEvents(),this.$el.empty();var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),s=n.join("."),l=this.keyPathAccessor(i[a],s),o=t.extend(e,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),r=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(t.extend(o,{disabled:e.version_compatible&&r.apply(this.field,[o.disabled,o,this.model]),visible:r.apply(this.field,[o.visible,o,this.model]),required:r.apply(this.field,[o.required,o,this.model]),canAdd:e.version_compatible&&r.apply(this.field,[o.canAdd,o,this.model]),canAddRow:o.canAddRow,canDelete:r.apply(this.field,[o.canDelete,o,this.model]),canEdit:r.apply(this.field,[o.canEdit,o,this.model])}),t.extend(o,{add_label:""}),!o.visible)return this;this.control_data=t.clone(o);var d=this.showGridControl(o);return this.$el.html(d).addClass(e.name),this.updateInvalid(),this.delegateEvents(),this},showGridControl:function(e){var i=this,a=t.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn-sm btn-default add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+t("Add new row")+'"><%-add_label%></button>',"</div>"].join("\n")),o=n('<div class="pgadmin-control-group backgrid form-group pg-el-xs-12 object subnode"></div>').append(a(e));if(i.grid&&i.grid.remove(),!e.subnode)return"";var r=e.subnode.schema?e.subnode:e.subnode.prototype,d=s.generateGridColumnsFromModel(e.node_info,r,this.field.get("mode"),e.columns);if("properties"==e.mode&&n(o).find("button.add").remove(),!e.disabled&&e.canDelete&&d.columns.unshift({name:"pg-backform-delete",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1,canDeleteRow:e.canDeleteRow}),0==e.disabled&&e.canEdit){var c=l.Extension.ObjectCell.extend({schema:d.schema});d.columns.unshift({name:"pg-backform-edit",label:"",cell:c,cell_priority:-2,canEditRow:e.canEditRow})}var u=this.model.get(e.name),p=function(e){var t=this,n=e[0];this.each(function(e){if(n.model!=e){var a=t.indexOf(e);if(a>-1){var s=i.grid.body.rows[a],l=s.$el.find(".subnode-edit-in-process").parent();if(l.length>0){var o=new Event("click");l[0].dispatchEvent(o)}}}})};u.on("enteringEditMode",p,u),i.grid=new l.Grid({columns:d.columns,collection:u,className:"backgrid table-bordered"});var h=i.grid.render().$el;e.canDelete&&e.canEdit&&(n(h).find("th.pg-backform-delete").remove(),n(h).find("th.pg-backform-edit").attr("colspan","2"));var f=o.append(h);return e.disabled||0==e.canAdd||f.find("button.add").first().click(function(a){if(a.preventDefault(),!t.isFunction(e.canAddRow)||e.canAddRow.apply(i,[i.model])){if(t.each(i.grid.body.rows,function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}}),!i.field.get("allowMultipleEmptyRows")&&u){var s=!1;if(u.each(function(e){var i=[];t.each(e.attributes,function(e){i.push(e)}),t.some(i,t.identity)||(s=!0)}),s)return!1}n(i.grid.body.$el.find(n("tr.new"))).removeClass("new");var l=new e.model(null,{silent:!0,handler:u,top:i.model.top||i.model,collection:u,node_info:i.model.node_info});u.add(l);var o=u.indexOf(l),r=i.grid.body.rows[o].$el;return r.addClass("new"),n(r).pgMakeVisible("backform-tab"),!1}}),f},clearInvalid:function(){return this.$el.removeClass("subnode-error"),this.$el.find(".pgadmin-control-error-message").remove(),this},updateInvalid:function(){var e=this,i=this.model.errorModel;if(!(i instanceof a.Model))return this;this.clearInvalid(),this.$el.find(".subnode-body").each(function(){var a=e.keyPathAccessor(i.toJSON(),e.field.get("name"));t.isEmpty(a)||e.$el.addClass("subnode-error").append(n("<div></div>").addClass("pgadmin-control-error-message pg-el-xs-offset-4 pg-el-xs-8 help-block").text(a))})}}),s.SubNodeCollectionControl=s.Control.extend({row:l.Row,render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),o=this.keyPathAccessor(i[a],l),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};t.extend(r,{disabled:d(r.disabled,r,this.model),visible:d(r.visible,r,this.model),required:d(r.required,r,this.model),canAdd:d(r.canAdd,r,this.model),canAddRow:r.canAddRow,canEdit:d(r.canEdit,r,this.model),canDelete:d(r.canDelete,r,this.model),showError:r.showError||!0});var c=void 0==r.subnode?"":this.showGridControl(r);return this.$el.removeClass(s.hiddenClassName),r.visible||this.$el.addClass(s.hiddenClassName),this.$el.html(c).addClass(e.name),this.updateInvalid(),this},updateInvalid:function(){var e=this,i=this.model.errorModel;if(!(i instanceof a.Model))return this;this.clearInvalid();var s=e.field.get("name").split("."),l=s.join("."),o=e.keyPathAccessor(i.toJSON(),l);t.isEmpty(o)||e.field.get("showError")&&e.$el.addClass("subnode-error").append(n("<div></div>").addClass("pgadmin-control-error-message pg-el-xs-offset-4 pg-el-xs-8 help-block").text(o))},cleanup:function(){this.grid&&this.grid.remove(),this.collection&&this.collection.off("enteringEditMode")},clearInvalid:function(){return this.field.get("showError")&&(this.$el.removeClass("subnode-error"),this.$el.find(".pgadmin-control-error-message").remove()),this},showGridControl:function(e){var i=this,a=["<div class='subnode-header'>","  <label class='control-label pg-el-sm-10'>"+e.label+"</label>","  <button class='btn-sm btn-default add fa fa-plus' title='"+t("Add new row")+"'></button>","</div>"].join("\n"),o=n("<div class='pgadmin-control-group backgrid form-group pg-el-xs-12 object subnode'></div>").append(a),r=e.subnode.schema?e.subnode:e.subnode.prototype,d=s.generateGridColumnsFromModel(e.node_info,r,this.field.get("mode"),e.columns,e.schema_node),c=window.pgAdmin.Browser;if(i.grid&&i.grid.remove(),(e.disabled||0==e.canAdd)&&n(o).find("button.add").remove(),0==e.disabled&&e.canDelete&&d.columns.unshift({name:"pg-backform-delete",label:"",cell:l.Extension.DeleteCell,editable:!1,cell_priority:-1,canDeleteRow:e.canDeleteRow,customDeleteMsg:e.customDeleteMsg,customDeleteTitle:e.customDeleteTitle}),0==e.disabled&&e.canEdit){var u=l.Extension.ObjectCell.extend({schema:d.schema}),p=i.field.has("canEdit")&&i.field.get("canEdit")||!0;d.columns.unshift({name:"pg-backform-edit",label:"",cell:u,cell_priority:-2,editable:p,canEditRow:e.canEditRow})}var h=i.model.get(e.name);h||(h=new c.Node.Collection(null,{handler:i.model.handler||i.model,model:e.model,top:i.model.top||i.model,silent:!0}),i.model.set(e.name,h,{silent:!0}));var f=function(e){var t=this,i=e[0];this.each(function(e){if(i.model!=e){var n=t.indexOf(e);if(n>-1){var a=m.body.rows[n],s=a.$el.find(".subnode-edit-in-process").parent();if(s.length>0){var l=new Event("click");s[0].dispatchEvent(l)}}}})};h.on("enteringEditMode",f,h);var m=i.grid=new l.Grid({columns:d.columns,collection:h,row:this.row,className:"backgrid table-bordered"}),g=m.render().$el;e.canDelete&&e.canEdit&&(n(g).find("th.pg-backform-delete").remove(),n(g).find("th.pg-backform-edit").attr("colspan","2"));var v=o.append(g);return v.find("button.add").click(function(a){if(a.preventDefault(),!t.isFunction(e.canAddRow)||e.canAddRow.apply(i,[i.model])){t.each(m.body.rows,function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}}),m.insertRow({});var s=n(m.body.rows[h.length-1].$el);return s.attr("class","new").click(function(){n(this).attr("class","editable")}),n(s).pgMakeVisible("backform-tab"),!1}}),v}}),s.SqlTabControl=s.Control.extend({defaults:{label:"",controlsClassName:"pgadmin-controls pg-el-sm-12 SQL",extraClasses:[],helpMessage:null},template:t.template(['<div class="<%=controlsClassName%>">','  <textarea class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function(e){s.Control.prototype.initialize.apply(this,arguments),this.dialog=e.dialog,this.tabIndex=e.tabIndex,t.bindAll(this,"onTabChange","onPanelResized")},getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("textarea").val(),this.model)},render:function(){return this.sqlCtrl&&(this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty(),this.model.off("pg-property-tab-changed",this.onTabChange,this),this.model.off("pg-browser-resized",this.onPanelResized,this)),s.Control.prototype.render.apply(this,arguments),this.sqlCtrl=o.fromTextArea(this.$el.find("textarea")[0],{lineNumbers:!0,mode:"text/x-pgsql",readOnly:!0,extraKeys:r.Browser.editor_shortcut_keys,tabSize:r.Browser.editor_options.tabSize,lineWrapping:r.Browser.editor_options.wrapCode,autoCloseBrackets:r.Browser.editor_options.insert_pair_brackets,matchBrackets:r.Browser.editor_options.brace_matching}),this.model.on("pg-property-tab-changed",this.onTabChange,this),this.model.on("pg-browser-resized",this.onPanelResized,this),this},onTabChange:function(i){if(this.dialog&&i.shown==this.tabIndex){if(this.model.sessChanged())if(0==t.size(this.model.errorModel.attributes)){var a=this,s=a.field.get("schema_node"),l=s.generate_url.apply(s,[null,"msql",this.field.get("node_data"),!a.model.isNew(),this.field.get("node_info")]);a.model.trigger("pgadmin-view:msql:fetching",a.method,s),n.ajax({url:l,type:"GET",cache:!1,data:a.model.toJSON(!0,"GET"),dataType:"json",contentType:"application/json"}).done(function(e){a.sqlCtrl.clearHistory(),a.sqlCtrl.setValue(e.data)}).fail(function(){a.model.trigger("pgadmin-view:msql:error",a.method,s,arguments)}).always(function(){a.model.trigger("pgadmin-view:msql:fetched",a.method,s,arguments)})}else this.sqlCtrl.clearHistory(),this.sqlCtrl.setValue("-- "+e("Definition incomplete."));else this.sqlCtrl.clearHistory(),this.sqlCtrl.setValue("-- "+e("Nothing changed."));this.sqlCtrl.refresh.apply(this.sqlCtrl)}},onPanelResized:function(e){if(e&&e.container){var t=e.container.find(".backform-tab > .tab-content").first(),i=t.find("div[role=tabpanel].tab-pane.SQL");i.hasClass("active")&&i.find(".CodeMirror").css("cssText","height: "+(t.height()+8)+"px !important;")}},remove:function(){this.sqlCtrl&&(this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),this.model.off("pg-property-tab-changed",this.onTabChange,this),this.model.off("pg-browser-resized",this.onPanelResized,this),s.Control.__super__.remove.apply(this,arguments)}}),s.NumericControl=s.InputControl.extend({defaults:{type:"number",label:"",min:void 0,max:void 0,maxlength:255,extraClasses:[],helpMessage:null},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))}),s.generateViewSchema=function(i,n,a,l,o,d,c){var u=n&&n.prototype||n,p=c||u&&u.schema,h=window.pgAdmin.Browser,f=[],m={};if(p&&t.isArray(p)){var g,v=v=function(e){return e&&u[e]&&"function"==typeof u[e]?u[e]:e},b={},y=i&&"server"in i&&h.serverInfo&&h.serverInfo[i.server._id],_=i&&"catalog"in i;if(t.each(p,function(d){if("group"==d.type){var c=!0;return g=!!t.isUndefined(y)||(!!t.isUndefined(d.server_type)||y.type in d.server_type)&&(!!t.isUndefined(d.min_version)||y.version>=d.min_version)&&(!!t.isUndefined(d.max_version)||y.version<=d.max_version),d.mode&&t.isObject(d.mode)&&(c=t.indexOf(d.mode,a)>-1),c&&(c=v(d.visible)),void(m[d.id]={label:d.label||d.id,version_compatible:g,visible:c})}if(!d.mode||d&&d.mode&&t.isObject(d.mode)&&-1!=t.indexOf(d.mode,a)){var u=d.group||e("General"),p=d.control||s.getMappedControl(d.type,a),f=d.cell||s.getMappedControl(d.type,"cell");if(null==p)return;b[u]=b[u]||[],g=!!t.isUndefined(y)||(!!t.isUndefined(d.server_type)||y.type in d.server_type)&&(!!t.isUndefined(d.min_version)||y.version>=d.min_version)&&(!!t.isUndefined(d.max_version)||y.version<=d.max_version);var C="properties"==a||!g||_,w=d.node&&t.isString(d.node)&&d.node in h.Nodes&&h.Nodes[d.node]||l,x=t.extend(t.clone(d),{name:d.id,disabled:!!C||v(d.disabled),editable:t.isUndefined(d.editable)?r.editableCell:v(d.editable),subnode:t.isString(d.model)&&d.model in h.Nodes?h.Nodes[d.model].model:d.model,canAdd:!C&&v(d.canAdd),canAddRow:!C&&v(d.canAddRow),canEdit:!C&&v(d.canEdit),canDelete:!C&&v(d.canDelete),canEditRow:!C&&v(d.canEditRow),canDeleteRow:!C&&v(d.canDeleteRow),transform:v(d.transform),mode:a,control:p,cell:f,node_info:i,schema_node:w,visible:v(d.visible),node:l,node_data:o,version_compatible:g});delete x.id,b[u].push(x),"nested"==d.type&&(delete x.name,delete x.cell,x.schema=s.generateViewSchema(i,n,a,l,o,!0,d.schema),x.control=x.control||"tab")}}),t.isEmpty(b))return null;d||!l||!l.hasSQL||"create"!=a&&"edit"!=a||(b[e("SQL")]=[{name:"sql",visible:!0,disabled:!1,type:"text",control:"sql-tab",node_info:i,schema_node:l,node_data:o}]),t.each(b,function(e,i){f.push(t.extend(t.defaults(m[i]||{label:i},{version_compatible:!0,visible:!0}),{fields:e}))})}return f};var u=function(){};t.extend(u.prototype,{fromRaw:function(e){return encodeURIComponent(e)},toRaw:function(e){return t.isArray(e)?t.map(e,decodeURIComponent):t.isNull(e)||t.isUndefined(e)?null:decodeURIComponent(e)}}),s.Select2Control=s.SelectControl.extend({defaults:t.extend({},s.SelectControl.prototype.defaults,{select2:{first_empty:!0,multiple:!1,emptyOptions:!1}}),formatter:u,template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">'," <select class=\"<%=Backform.controlClassName%> <%=extraClasses.join(' ')%>\"",'  name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%>','  <%=required ? "required" : ""%><%= select2.multiple ? " multiple>" : ">" %>','  <%=select2.first_empty ? " <option></option>" : ""%>',"  <% for (var i=0; i < options.length; i++) {%>","   <% var option = options[i]; %>","   <option ","    <% if (option.image) { %> data-image=<%=option.image%> <%}%>","    value=<%- formatter.fromRaw(option.value) %>",'    <% if (option.selected) {%>selected="selected"<%} else {%>','    <% if (!select2.multiple && option.value === rawValue) {%>selected="selected"<%}%>','    <% if (select2.multiple && rawValue && rawValue.indexOf(option.value) != -1){%>selected="selected" data-index="rawValue.indexOf(option.value)"<%}%>',"    <%}%>",'    <%= disabled ? "disabled" : ""%>><%-option.label%></option>',"  <%}%>"," </select>"," <% if (helpMessage && helpMessage.length) { %>",' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>","</div>"].join("\n")),render:function(){this.$sel&&this.$sel.select2&&this.$sel.select2.hasOwnProperty("destroy")&&this.$sel.select2("destroy");var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),a=e.name.split("."),l=a.shift(),o=a.join("."),r=this.keyPathAccessor(i[l],o),d=t.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:i,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};if(d.select2=d.select2||{},t.defaults(d.select2,this.defaults.select2,{first_empty:!0,multiple:!1,emptyOptions:!1}),t.extend(d,{disabled:c(d.disabled,d,this.model),visible:c(d.visible,d,this.model),required:c(d.required,d,this.model)}),t.isFunction(d.options))try{d.options=d.options(this)}catch(e){d.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}this.$el.removeClass(s.hiddenClassName),d.visible||this.$el.addClass(s.hiddenClassName),this.$el.html(this.template(d)).addClass(e.name);var u=t.extend({disabled:d.disabled},e.select2,{options:this.field.get("options")||this.defaults.options});return(d.disabled||"properties"===d.mode)&&(u.placeholder=""),d.select2.tags&&d.select2.emptyOptions&&(u.data=d.rawValue),this.$sel=this.$el.find("select").select2(u),d.select2.tags&&d.select2.emptyOptions&&(this.$sel.val(d.rawValue),this.$sel.trigger("change.select2"),this.$sel.on("select2:unselect",function(e){n(this).find('option[value="'+e.params.data.text.replace("'","\\'").replace('"','\\"')+'"]').remove(),n(this).trigger("change.select2"),null==n(this).val()&&n(this).empty()})),this.$sel&&this.$sel.data("select2").on("keypress",function(e){var t=this;9===e.which&&t.isOpen()&&(e.preventDefault(),t.trigger("results:select",{}))}),this.updateInvalid(),this},getValueFromDOM:function(){var e=s.SelectControl.prototype.getValueFromDOM.apply(this,arguments);return t.extend({},this.field.get("select2")||this.defaults.select2).multiple&&null==e?[]:e}}),s.FieldsetControl=s.Fieldset.extend({initialize:function(e){s.Control.prototype.initialize.apply(this,arguments),s.Dialog.prototype.initialize.apply(this,[{schema:e.field.get("schema")}]),this.dialog=e.dialog,this.tabIndex=e.tabIndex;var i=this.field.get("deps"),n=this;i&&t.isArray(i)&&t.each(i,function(e){var t=e.split("."),i=t.shift();n.listenTo(n.model,"change:"+i,n.render)})},orig_render:s.Fieldset.prototype.render,render:function(){var e=t.defaults(this.field.toJSON(),this.defaults);return e.version_compatible&&function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e}(e.visible,e,this.model)?this.orig_render.apply(this,arguments):(this.cleanup(),this.$el.empty()),this},formatter:function(){},cleanup:function(){s.Fieldset.prototype.cleanup.apply(this)},remove:function(){s.Control.prototype.remove.apply(this,arguments),s.Dialog.prototype.remove.apply(this,arguments)},className:function(){return"set-group"},tabPanelClassName:function(){return s.tabClassName},fieldsetClass:"inline-fieldset",legendClass:"",contentClass:"",collapse:!1}),s.TabControl=s.FieldsetControl.extend({tagName:"div",className:"inline-tab-panel",tabPanelClassName:"inline-tab-panel",initialize:function(e){s.FieldsetControl.prototype.initialize.apply(this,arguments),this.tabIndex=(e.tabIndex||parseInt(1e3*Math.random()))+1},orig_render:s.Dialog.prototype.render,template:s.Dialog.prototype.template}),s.PlainFieldsetControl=s.FieldsetControl.extend({initialize:function(){s.FieldsetControl.prototype.initialize.apply(this,arguments)},template:{header:t.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %></legend>'," <% } %>","</fieldset>"].join("\n")),content:t.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},fieldsetClass:"inline-fieldset-without-border",legend:!1}),s.SqlFieldControl=s.TextareaControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,maxlength:4096,rows:void 0},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>',"<div class=\"<%=Backform.controlsClassName%> sql_field_layout <%=extraClasses.join(' ')%>\">","  <textarea ",'    class="<%=Backform.controlClassName%> " name="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%>',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function(){s.TextareaControl.prototype.initialize.apply(this,arguments),this.sqlCtrl=null,t.bindAll(this,"onFocus","onBlur","refreshTextArea")},getValueFromDOM:function(){return this.sqlCtrl.getValue()},render:function(){this.sqlCtrl&&(this.model.off("pg-property-tab-changed",this.refreshTextArea,this),this.sqlCtrl.off("focus",this.onFocus),this.sqlCtrl.off("blur",this.onBlur),this.sqlCtrl.toTextArea(),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),s.TextareaControl.prototype.render.apply(this,arguments);var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),d=this.keyPathAccessor(i[a],l),c=t.extend(e,{rawValue:d,value:this.formatter.fromRaw(d,this.model),attributes:i,formatter:this.formatter}),u=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e},p=u(c.disabled,c,this.model),h=u(c.visible,c,this.model),f=this;if(f.sqlCtrl=o.fromTextArea(f.$el.find("textarea")[0],{lineNumbers:!0,mode:"text/x-pgsql",extraKeys:r.Browser.editor_shortcut_keys,indentWithTabs:r.Browser.editor_options.indent_with_tabs,indentUnit:r.Browser.editor_options.tabSize,tabSize:r.Browser.editor_options.tabSize,lineWrapping:r.Browser.editor_options.wrapCode,autoCloseBrackets:r.Browser.editor_options.insert_pair_brackets,matchBrackets:r.Browser.editor_options.brace_matching}),p){f.sqlCtrl.setOption("readOnly",!0);var m=f.sqlCtrl.getWrapperElement();m&&(m.className+=" cm_disabled hide-cursor-workaround")}return h||f.$el.addClass(s.hiddenClassName),f.model.on("pg-property-tab-changed",this.refreshTextArea,this),this.sqlCtrl.on("focus",this.onFocus),this.sqlCtrl.on("blur",this.onBlur),setTimeout(function(){f.refreshTextArea.apply(f)},0),f},onFocus:function(){var e=this.$el.find(".pgadmin-controls").first();e.hasClass("focused")||e.addClass("focused")},onBlur:function(){this.$el.find(".pgadmin-controls").first().removeClass("focused")},refreshTextArea:function(){this.sqlCtrl&&this.sqlCtrl.refresh()},remove:function(){this.sqlCtrl&&(this.sqlCtrl.off("focus",this.onFocus),this.sqlCtrl.off("blur",this.onBlur),delete this.sqlCtrl,this.sqlCtrl=null,this.$el.empty()),this.model.off("pg-property-tab-changed",this.refreshTextArea,this),s.TextareaControl.prototype.remove.apply(this,arguments)}}),s.NoteControl=s.Control.extend({defaults:{label:e("Note"),text:"",extraClasses:[],noteClass:"backform_control_notes"},template:t.template(["<div class=\"<%=noteClass%> pg-el-xs-12 <%=extraClasses.join(' ')%>\">",'<label class="control-label"><%=label%>:</label>',"<span><%=text%></span></div>"].join("\n"))}),s.FileControl=s.InputControl.extend({defaults:{type:"text",label:"",min:void 0,max:void 0,maxlength:255,extraClasses:[],dialog_title:"",btn_primary:"",helpMessage:null,dialog_type:"select_file"},initialize:function(){s.InputControl.prototype.initialize.apply(this,arguments)},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','<div class="file_selection_ctrl form-control">','<input type="<%=type%>" class="browse_file_input form-control <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','<button class="btn fa fa-ellipsis-h select_item pull-right" <%=disabled ? "disabled" : ""%> ></button>',"<% if (helpMessage && helpMessage.length) { %>",'<span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>","</div>"].join("\n")),events:function(){return t.extend({},s.InputControl.prototype.events,{"click .select_item":"onSelect"})},onSelect:function(){var e=this.field.get("dialog_type"),t=this.field.get("supp_types"),i=this.field.get("btn_primary"),n=this.field.get("dialog_title"),a={supported_types:t,dialog_type:e,dialog_title:n,btn_primary:i};r.FileManager.init(),r.FileManager.show_dialog(a),this.listen_file_dlg_events()},storage_dlg_hander:function(e){var t=this.field.get("name").split("."),i=t.shift();this.remove_file_dlg_event_listeners(),this.model.set(i,decodeURI(e))},storage_close_dlg_hander:function(){this.remove_file_dlg_event_listeners()},listen_file_dlg_events:function(){r.Browser.Events.on("pgadmin-storage:finish_btn:"+this.field.get("dialog_type"),this.storage_dlg_hander,this),r.Browser.Events.on("pgadmin-storage:cancel_btn:"+this.field.get("dialog_type"),this.storage_close_dlg_hander,this)},remove_file_dlg_event_listeners:function(){r.Browser.Events.off("pgadmin-storage:finish_btn:"+this.field.get("dialog_type"),this.storage_dlg_hander,this),r.Browser.Events.off("pgadmin-storage:cancel_btn:"+this.field.get("dialog_type"),this.storage_close_dlg_hander,this)},clearInvalid:function(){return s.InputControl.prototype.clearInvalid.apply(this,arguments),this.$el.removeClass("pgadmin-file-has-error"),this},updateInvalid:function(){s.InputControl.prototype.updateInvalid.apply(this,arguments),this.$el.addClass("pgadmin-file-has-error")}}),s.DatetimepickerControl=s.InputControl.extend({defaults:{type:"text",label:"",options:{format:"YYYY-MM-DD HH:mm:ss Z",showClear:!0,showTodayButton:!0,toolbarPlacement:"top",widgetPositioning:{horizontal:"auto",vertical:"bottom"}},placeholder:"YYYY-MM-DD HH:mm:ss Z",extraClasses:[],helpMessage:null},events:{"blur input":"onChange","change input":"onChange","changeDate input":"onChange","focus input":"clearInvalid","db.change":"onChange",click:"openPicker"},openPicker:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("show")},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="input-group  <%=Backform.controlsClassName%>">',' <input type="text" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',' <span class="input-group-addon">','  <span class="fa fa-calendar"></span>'," </span>","</div>","<% if (helpMessage && helpMessage.length) { %>",' <div class="<%=Backform.controlsClassName%>">','   <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," </div>","<% } %>"].join("\n")),render:function(){var e=t.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=e.name.split("."),a=n.shift(),l=n.join("."),o=this.keyPathAccessor(i[a],l),r=t.extend(e,{rawValue:o,value:this.formatter.fromRaw(o,this.model),attributes:i,formatter:this.formatter}),d=function(e,i){return t.isFunction(e)?!!e(i):!!e};if(t.extend(r,{disabled:d(r.disabled,this.model),visible:d(r.visible,this.model),required:d(r.required,this.model)}),r.disabled||(r.placeholder=r.placeholder||this.defaults.placeholder),this.has_datepicker&&this.$el.find("input").datetimepicker("destroy"),this.$el.empty(),this.$el.removeClass(s.hiddenClassName),this.$el.html(this.template(r)).addClass(e.name),r.visible){this.has_datepicker=!0;var c=this;this.$el.find("input").first().datetimepicker(t.extend({keyBinds:{enter:function(e){var t=this;e?setTimeout(function(){t.toggle(),c.$el.find("input").first().blur()},10):setTimeout(function(){t.toggle()},10)},tab:function(e){e||setTimeout(function(){c.$el.find("input").first().blur()},10)},escape:function(e){if(e){var t=this;setTimeout(function(){t.toggle(),c.$el.find("input").first().blur()},10)}}}},this.defaults.options,this.field.get("options"),{date:r.value,minDate:r.value}))}else this.has_datepicker=!1,this.$el.addClass(s.hiddenClassName);return this.updateInvalid(),this},clearInvalid:function(){return s.InputControl.prototype.clearInvalid.apply(this,arguments),this.$el.removeClass("pgadmin-datepicker-has-error"),this},updateInvalid:function(){s.InputControl.prototype.updateInvalid.apply(this,arguments),this.$el.addClass("pgadmin-datepicker-has-error")},cleanup:function(){this.has_datepicker&&this.$el.find("input").datetimepicker("destroy"),this.$el.empty()}}),s.ColorControl=s.InputControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,showButtons:!1,showPalette:!0,allowEmpty:!0,colorFormat:"hex",defaultColor:""},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),render:function(){this.$picker&&this.$picker.hasOwnProperty("destroy")&&this.$picker("destroy");var i=t.defaults(this.field.toJSON(),this.defaults),n=this.model.toJSON(),a=i.name.split("."),l=a.shift(),o=a.join("."),r=this.keyPathAccessor(n[l],o),d=t.extend(i,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:n,formatter:this.formatter}),c=function(e,i,n){return t.isFunction(e)?!!e.apply(i,[n]):!!e};return t.extend(d,{disabled:c(d.disabled,d,this.model),visible:c(d.visible,d,this.model),required:c(d.required,d,this.model)}),this.$el.empty(),d.visible||this.$el.addClass(s.hiddenClassname),this.$el.html(this.template(d)).addClass(i.name),this.$picker=this.$el.find("input").spectrum({allowEmpty:d.allowEmpty,preferredFormat:d.colorFormat,disabled:d.disabled,hideAfterPaletteSelect:!0,clickoutFiresChange:!0,showButtons:d.showButtons,showPaletteOnly:d.showPalette,togglePaletteOnly:d.showPalette,togglePaletteMoreText:e("More"),togglePaletteLessText:e("Less"),color:d.value||d.defaultColor,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]}),this.updateInvalid(),this}});var p=s.KeyCodeControlFormatter=function(){};return t.extend(p.prototype,{fromRaw:function(e){return e.char},toRaw:void 0}),s.KeyCodeControl=s.InputControl.extend({defaults:t.defaults({escapeKeyCodes:[16,17,18,27]},s.InputControl.prototype.defaults),events:{"keydown input":"onkeyDown","keyup input":"preventEvent","focus select":"clearInvalid"},formatter:p,preventEvent:function(e){var i=e.which||e.keyCode;-1==t.defaults(this.field.toJSON(),this.defaults).escapeKeyCodes.indexOf(i)&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())},template:t.template(['<label class="<%=Backform.controlLabelClassName%> keyboard-shortcut-label"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" oncopy="return false; oncut="return false; onpaste="return false;" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onkeyDown:function(i){var n,s=this,l=this.model,o=this.field.get("name").split("."),r=o.shift(),d={},c=i.which||i.keyCode;-1==t.defaults(this.field.toJSON(),this.defaults).escapeKeyCodes.indexOf(c)&&(this.model.errorModel instanceof a.Model&&this.model.errorModel.unset(r),n=e(i.key),32==c&&(n=e("Space")),d={key_code:i.which||i.keyCode,char:n},this.stopListening(this.model,"change:"+r,this.render),l.set(r,d),this.listenTo(this.model,"change:"+r,this.render),setTimeout(function(){s.$el.find("input").val(n)}),i.preventDefault())},keyPathAccessor:function(e,i){var n=e;i=i.split(".");for(var a=0;a<i.length;a++){if(t.isNull(n))return null;t.isEmpty(i[a])||(t.isUndefined(n[i[a]])||(n=n[i[a]]))}return n}}),s.KeyboardShortcutControl=s.Control.extend({initialize:function(){s.Control.prototype.initialize.apply(this,arguments);var e=this.field.get("fields");if(null==e||void 0==e)throw new ReferenceError('"fields" not found in keyboard shortcut');this.innerModel=new a.Model,this.controls=[]},cleanup:function(){this.stopListening(this.innerModel,"change",this.onInnerModelChange),t.each(this.controls,function(e){e.remove()}),this.controls.length=0},template:t.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"</div>"].join("\n")),onInnerModelChange:function(){var e=this.field.get("name"),t=n.extend(!0,{},this.model.get(e));this.stopListening(this.model,"change:"+e,this.render),this.model.set(e,n.extend(!0,t,this.innerModel.toJSON())),this.listenTo(this.model,"change:"+e,this.render)},render:function(){this.cleanup(),this.$el.empty();var e=this,i={},a=t.defaults(this.field.toJSON(),this.defaults),l=e.model.get(a.name),o=a.fields;this.$el.html(e.template(a)).addClass(a.name);var r=n(e.$el.find(".pgadmin-controls"));return t.each(o,function(e){i[e.name]=l[e.name]}),e.innerModel.set(i),e.listenTo(e.innerModel,"change",e.onInnerModelChange),t.each(o,function(i){var a=new s.Field(t.extend({},{id:i.name,name:i.name,control:i.type,label:i.label})),l=new(a.get("control"))({field:a,model:e.innerModel});l.render(),"checkbox"==i.type?"alt_option"==i.name?r.append(n('<div class="pg-el-sm-3 pg-el-xs-12"></div>').append(l.$el)):r.append(n('<div class="pg-el-sm-2 pg-el-xs-12"></div>').append(l.$el)):r.append(n('<div class="pg-el-sm-5 pg-el-xs-12"></div>').append(l.$el)),e.controls.push(l)}),e},remove:function(){this.cleanup(),s.Control.prototype.remove.apply(this,arguments)}}),s}.apply(t,a))&&(e.exports=s)}).call(t,i(3))},91:function(e,t,i){"use strict";var n,a;n=[i(2),i(1),i(0),i(10),i(19),i(17),i(15),i(3),i(25),i(32)],void 0!==(a=function(e,t,i,n,a,s,l,o,r){var d=function(e){var i=this,n=e.get("name"),a={};i.collection.each(function(e){"name"==e.get("name")&&(a=e.get("availVariables"))});var l=n?a[n]:void 0,o=e.get("value");switch(l&&l.vartype){case"bool":return e.set("value",!!e.get("value"),{silent:!0}),s.Extension.SwitchCell;case"enum":e.set({value:o},{silent:!0});var r=[],d=l.enumvals;return t.each(d,function(e){r.push([e,e])}),s.Extension.Select2Cell.extend({optionValues:r});case"integer":return t.isNaN(parseInt(o))?e.set({value:void 0},{silent:!0}):e.set({value:parseInt(o)},{silent:!0}),s.IntegerCell;case"real":return t.isNaN(parseFloat(o))?e.set({value:void 0},{silent:!0}):e.set({value:parseFloat(o)},{silent:!0}),s.NumberCell.extend({decimals:0});case"string":return s.StringCell;default:return e.set({value:void 0},{silent:!0}),s.Cell}},c=s.Row.extend({modelDuplicateColor:"lightYellow",modelUniqueColor:"#fff",initialize:function(){s.Row.prototype.initialize.apply(this,arguments);var e=this;e.model.on("change:name",function(){setTimeout(function(){e.columns.each(function(t){if("value"==t.get("name")){var i=e.columns.indexOf(t),n=t.get("cellFunction"),a=new(n.apply(t,[e.model]))({column:t,model:e.model});e.cells[i].remove(),e.cells[i]=a,e.render()}})},10)}),e.listenTo(e.model,"pgadmin-session:model:duplicate",e.modelDuplicate),e.listenTo(e.model,"pgadmin-session:model:unique",e.modelUnique)},modelDuplicate:function(){i(this.el).removeClass("new"),this.el.style.backgroundColor=this.modelDuplicateColor},modelUnique:function(){this.el.style.backgroundColor=this.modelUniqueColor}}),u=r.VariableModel=r.Model.extend({keys:["name"],defaults:{name:void 0,value:void 0,role:null,database:null},schema:[{id:"name",label:e("Name"),type:"text",cellHeaderClasses:"width_percent_30",editable:function(e){return e instanceof n.Collection||e.isNew()},cell:s.Extension.NodeAjaxOptionsCell.extend({initialize:function(){s.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments);var e=t.clone(this.optionValues||(t.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));this.column.set("options",e)}}),url:"vopts",select2:{allowClear:!1},transform:function(e,i){var n=[],a={};return t.each(e,function(e){n.push({value:e.name,image:void 0,label:e.name}),a[e.name]=e}),i.column.set("availVariables",a),n}},{id:"value",label:e("Value"),type:"text",editable:!0,cellFunction:d,cellHeaderClasses:"width_percent_40"},{id:"database",label:e("Database"),type:"text",editable:!0,node:"database",cell:s.Extension.NodeListByNameCell},{id:"role",label:e("Role"),type:"text",editable:!0,node:"role",cell:s.Extension.NodeListByNameCell}],toJSON:function(){var e=n.Model.prototype.toJSON.apply(this);return(t.isUndefined(e.database)||t.isNull(e.database))&&delete e.database,(t.isUndefined(e.role)||t.isNull(e.role))&&delete e.role,e},validate:function(){var i=null;return t.isUndefined(this.get("name"))||t.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Please select a parameter name."),this.errorModel.set("name",i)):t.isUndefined(this.get("value"))||t.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")?(i="Please enter a value for the parameter.",this.errorModel.set("value",i),this.errorModel.unset("name")):(this.errorModel.unset("name"),this.errorModel.unset("value")),i}});return a.VariableCollectionControl=a.UniqueColCollectionControl.extend({hasDatabase:!1,hasRole:!1,initialize:function(e){var t=this,i=["name"];t.hasDatabase=e.field.get("hasDatabase"),t.hasRole=e.field.get("hasRole"),t.hasDatabase?i.push("database"):t.hasRole&&i.push("role"),e&&e.field&&(e.field instanceof a.Field?e.field.set({model:r.VariableModel.extend({keys:i})},{silent:!0}):e.field.extend({model:r.VariableModel.extend({keys:i})})),a.UniqueColCollectionControl.prototype.initialize.apply(t,arguments),t.availVariables={};var n=["name","value"];t.hasDatabase&&n.push("database"),t.hasRole&&n.push("role"),t.gridSchema=a.generateGridColumnsFromModel(t.field.get("node_info"),u.extend({keys:i}),"edit",n,t.field.get("schema_node")),t.getVariables()},getVariables:function(){var e=this,n=this.field.get("url"),a=e.model;if(this.field.get("version_compatible")&&n&&!a.isNew()){var s,l=e.field.get("node"),o=e.field.get("node_data"),r=e.field.get("node_info"),d=l.generate_url.apply(l,[null,n,o,!0,r]),c=e.collection.trackChanges;c&&e.collection.stopSession(),a.trigger("pgadmin-view:fetching",a,e.field),i.ajax({async:!1,url:d,success:function(e){s=e.data},error:function(){a.trigger("pgadmin-view:fetch:error",a,e.field)}}),a.trigger("pgadmin-view:fetched",a,e.field),s&&t.isArray(s)&&e.collection.reset(s,{silent:!0}),c&&e.collection.startNewSession()}},showGridControl:function(e){var n=this,a=t.template(["<div class='subnode-header'>","<label class='control-label'><%-label%></label>","<button class='btn-sm btn-default add fa fa-plus' title='"+t("Add new row")+"' <%=canAdd ? '' : 'disabled=\"disabled\"'%>></button>","</div>"].join("\n")),l=i("<div class='pgadmin-control-group backgrid form-group col-xs-12 object subnode'></div>").append(a(e));n.grid&&n.grid.remove();var o=t.clone(this.gridSchema);t.each(o.columns,function(e){"value"==e.name&&(e.availVariables=n.availVariables)}),0==e.disabled&&e.canDelete&&o.columns.unshift({name:"pg-backform-delete",label:"",cell:s.Extension.DeleteCell,editable:!1,cell_priority:-1}),n.collection.each(function(e){var t,i=e.get("name");if(i in n.availVariables)switch(n.availVariables[i].vartype){case"real":t=parseFloat(e.get("value")),e.set("value",isNaN(t)?void 0:t,{silent:!0});break;case"integer":t=parseInt(e.get("value")),e.set("value",isNaN(t)?void 0:t,{silent:!0})}});var r=n.grid=new s.Grid({columns:o.columns,collection:n.collection,row:c,className:"backgrid table-bordered"});return n.$grid=r.render().$el,l.append(n.$grid),e.disabled||0==e.canAdd||l.find("button.add").first().click(function(a){if(a.preventDefault(),!t.isFunction(e.canAddRow)||e.canAddRow.apply(n,[n.model])){if(!n.field.get("allowMultipleEmptyRows")&&n.collection){var s=!1;if(n.collection.each(function(e){var i=[];t.each(e.attributes,function(e){i.push(e)}),t.some(i,t.identity)||(s=!0)}),s)return!1}i(r.body.$el.find(i("tr.new"))).removeClass("new");var l=new e.model(null,{silent:!0,handler:n.collection,top:n.model.top||n.model,collection:n.collection,node_info:n.model.node_info});n.collection.add(l);var o=n.collection.indexOf(l),d=r.body.rows[o].$el;return d.addClass("new"),i(d).pgMakeVisible("backform-tab"),!1}}),l},addVariable:function(e){e.preventDefault();var t=this,n=new(t.field.get("model"))(t.headerData.toJSON(),{silent:!0,top:t.collection.top,handler:t.collection}),a=t.model.get(t.field.get("name"));a.add(n);var s=a.indexOf(n);if(s>-1){t.$grid.find(".new").removeClass("new");var l=t.grid.body.rows[s].$el;l.addClass("new"),i(l).pgMakeVisible("backform-tab")}return!1}}),u}.apply(t,n))&&(e.exports=a)}});